[{"title":"ç®—æ³•åˆ·é¢˜éšè®°","url":"/2024/06/28/algorithm-practice-todo/","content":"\n## å‰è¨€\n\nçªç„¶æƒ³è®°å½•è‡ªå·±ç®—æ³•åˆ·é¢˜çš„ä¸€äº›ç¬”è®°ï¼Œæ–¹ä¾¿è‡ªå·±ä»¥åæŸ¥é˜…ã€‚æŒ‰[ä»£ç éšæƒ³å½• (programmercarl.com)](https://programmercarl.com/)é‡Œçš„é¡ºåºè¿›è¡Œå­¦ä¹ å“ˆï¼Œåé¢å¯èƒ½ä¼šæœ‰å˜åŠ¨ã€‚èƒ½åšæŒå¤šä¹…æˆ‘ä¹Ÿä¸çŸ¥é“hhhã€‚\n\n## éšä¾¿è¯´\n\n**2024å¹´6æœˆ28æ—¥ æ™šä¸Šå¿«12ç‚¹**\n\nåˆ›å»ºè¿™ä¸ªæ–‡æ¡£ï¼Œç„¶åå‡†å¤‡å»ç¡è§‰äº† -V-\n\n\n\n\n## ç®—æ³•\n\n1. äºŒåˆ†æŸ¥æ‰¾\n2. åŒæŒ‡é’ˆæ³•\n3. æ»‘åŠ¨çª—å£\n3. æ¨¡æ‹Ÿè¡Œä¸º\n\n\n\n## é¢˜ç›®\n\n### æ•°ç»„\n#### äºŒåˆ†æŸ¥æ‰¾\n\n[704. äºŒåˆ†æŸ¥æ‰¾ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/binary-search/description/)\t\t2024å¹´6æœˆ28æ—¥ 23ç‚¹54åˆ†\n\næ¯”è¾ƒç®€å•ï¼Œæ³¨æ„ä¸€ä¸‹`mid=(left+right)>>1`ä¸­çš„`left+right`å¯èƒ½ä¼šæº¢å‡ºï¼Œå¯ä»¥å†™æˆï¼š\n\n```java\nmid = left + ((right - left) >> 1); \n```\n\n\n\n#### ç§»é™¤å…ƒç´ \n\n[27. ç§»é™¤å…ƒç´  - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/remove-element/description/)\t\t2024å¹´6æœˆ30æ—¥ 19ç‚¹54åˆ†\n\nO(n) O(1)çš„åšæ³•æ˜¯ä½¿ç”¨åŒæŒ‡é’ˆæ³•\n\n\n\n#### é•¿åº¦æœ€å°çš„å­æ•°ç»„\n\n[209. é•¿åº¦æœ€å°çš„å­æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/minimum-size-subarray-sum/description/) 2024å¹´7æœˆ2æ—¥ 23ç‚¹56åˆ† \n\nä½¿ç”¨åŒæŒ‡é’ˆ+æ»‘åŠ¨çª—å£æ€æƒ³ ï¼ˆè‹¥æœ‰è´Ÿæ•°åˆ™ç”¨ä¸äº†ï¼‰\n\n\n\n#### èºæ—‹çŸ©é˜µII\n\n[59. èºæ—‹çŸ©é˜µ II - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/spiral-matrix-ii/description/)\t2024å¹´7æœˆ5æ—¥ 22ç‚¹45åˆ† 22ç‚¹24åˆ†\n\næ¨¡æ‹Ÿ å®ƒçš„è¿‡ç¨‹å°±å¯ä»¥äº†ï¼Œè¦æ³¨æ„è¾¹ç•Œçš„å¤„ç†ã€‚\n\n\n\n### é“¾è¡¨\n\n#### ç§»é™¤é“¾è¡¨å…ƒç´ \n\n[203. ç§»é™¤é“¾è¡¨å…ƒç´  - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/remove-linked-list-elements/description/)\t2024å¹´7æœˆ6æ—¥ æ™šä¸Š\n\nç§»é™¤é“¾è¡¨ï¼Œå¯ä»¥æ·»åŠ è™šæ‹ŸèŠ‚ç‚¹ä½œä¸ºé“¾è¡¨å¤´ï¼Œè¿™æ ·ä¼šç®€å•ä¸€ç‚¹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ“ä½œé“¾è¡¨ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ç”¨é€’å½’çš„æ–¹å¼ï¼Œä½†ç©ºé—´å¤æ‚åº¦ä¼šæ˜¯O(n)\n\n\n\n[237. åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/delete-node-in-a-linked-list/)\t2024å¹´7æœˆ7æ—¥ 11ç‚¹44åˆ†\n\nå¯ä»¥å°†ç»™å®šçš„èŠ‚ç‚¹ç§»åˆ°æœ«å°¾ï¼Œç„¶åè®©å®ƒçš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹`node.next = null`ã€‚æƒ¯æ€§æ€ç»´äº†ï¼Œä¸€ç›´æƒ³åœ¨åŸåœ°ç§»é™¤nodeğŸ˜‚\n\n\n\n[2095. åˆ é™¤é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/delete-the-middle-node-of-a-linked-list/description/)\t2024å¹´7æœˆ7æ—¥ 13ç‚¹53åˆ†\n\nå¿«æ…¢æŒ‡é’ˆï¼Œå¿«æŒ‡é’ˆä¸€æ¬¡ç§»åŠ¨ä¸¤ä¸ªå…ƒç´ ï¼Œè€Œæ…¢æŒ‡é’ˆä¸€æ¬¡ç§»åŠ¨ä¸€ä¸ª\n\n\n\n[19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/remove-nth-node-from-end-of-list/description/)\t2024å¹´7æœˆ8æ—¥ 20ç‚¹27åˆ†\n\nåŒæŒ‡é’ˆï¼Œä¸¤ä¸ªæŒ‡é’ˆä¹‹é—´é—´éš”ä¸ºnï¼Œç­‰rightåˆ°æœ«å°¾äº†ï¼Œleftå°±æ˜¯ç›®æ ‡å…ƒç´ äº†ã€‚\n\n\n\n[é¢è¯•é¢˜ 02.07. é“¾è¡¨ç›¸äº¤ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/intersection-of-two-linked-lists-lcci/description/)\t2024å¹´7æœˆ8æ—¥ 21ç‚¹30åˆ†\n\nå¯ä»¥ç”¨å“ˆå¸Œè¡¨åšã€‚\n\nä¹Ÿå¯ä»¥ç”¨åŒæŒ‡é’ˆï¼Œä¸¤ä¸ªæŒ‡é’ˆéƒ½ä¼šéå†ä¸¤ä¸ªé“¾è¡¨ï¼Œ`-`å’Œ`=`åˆ†åˆ«ä»£è¡¨ä¸¤ä¸ªé“¾è¡¨çš„èŠ‚ç‚¹ï¼Œå¦‚ä¸‹\n\nAéå†`===----`\n\nBéå†`----===`\n\néå†é•¿åº¦ç›¸åŒï¼Œè‹¥æœ‰äº¤ç‚¹ï¼Œä¸­é—´é‚£ä¸ªå°±æ˜¯ã€‚\n\n\n\n[142. ç¯å½¢é“¾è¡¨ II - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/linked-list-cycle-ii/description/)\t2024å¹´7æœˆ9æ—¥ 22ç‚¹22åˆ†\n\næ¯”è¾ƒéš¾ï¼ŒåŒæŒ‡é’ˆ+æ•°å­¦ğŸ˜…\n\n\n\n### å“ˆå¸Œè¡¨\n\n#### æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯\n\n[438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/find-all-anagrams-in-a-string/description/)\t2024å¹´7æœˆ11æ—¥ æ™š\n\næ»‘åŠ¨çª—å£\n\n\n\n[349. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›† - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/intersection-of-two-arrays/description/)\t2024å¹´7æœˆ12æ—¥ 21ç‚¹41åˆ†\n\nå“ˆå¸Œè¡¨/ æ’åº+åŒæŒ‡é’ˆ\n","tags":["ç¬”è®°"],"categories":["ç¬”è®°"]},{"title":"ElasticSearchå­¦ä¹ ç¬”è®°","url":"/2023/03/12/elasticsearch-note/","content":"\n# ElasticSearch\n\n> ç¬”è®°å­¦ä¹ è§†é¢‘ï¼š[ã€å°šç¡…è°·ã€‘ElasticSearchæ•™ç¨‹å…¥é—¨åˆ°ç²¾é€šï¼ˆåŸºäºELKæŠ€æœ¯æ ˆelasticsearch 7.x+8.xæ–°ç‰¹æ€§ï¼‰_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1hh411D7sb/)\n>\n> ElasticSearchå®˜ç½‘ï¼š[Elasticsearchï¼šå®˜æ–¹åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ | Elastic](https://www.elastic.co/cn/elasticsearch/)\n\n## ç®€ä»‹\n\nThe Elastic Stack, åŒ…æ‹¬ Elasticsearchã€Kibanaã€Beatså’ŒLogstashï¼ˆä¹Ÿç§°ä¸º ELK Stackï¼‰ã€‚èƒ½å¤Ÿå®‰å…¨å¯é åœ°è·å–ä»»ä½•æ¥æºã€ä»»ä½•æ ¼å¼çš„æ•°æ®ï¼Œç„¶åå®æ—¶åœ°å¯¹æ•°æ®è¿›è¡Œæœç´¢ã€åˆ†æå’Œå¯è§†åŒ–ã€‚Elaticsearchï¼Œç®€ç§°ä¸ºESï¼ŒESæ˜¯ä¸€ä¸ª**å¼€æºçš„é«˜æ‰©å±•çš„åˆ†å¸ƒå¼å…¨æ–‡æœç´¢å¼•æ“**ï¼Œæ˜¯æ•´ä¸ªElastic  StackæŠ€æœ¯æ ˆçš„æ ¸å¿ƒã€‚å®ƒå¯ä»¥è¿‘ä¹å®æ—¶çš„å­˜å‚¨ã€æ£€ç´¢æ•°æ®ï¼›æœ¬èº«æ‰©å±•æ€§å¾ˆå¥½ï¼Œå¯ä»¥æ‰©å±•åˆ°ä¸Šç™¾å°æœåŠ¡å™¨ï¼Œå¤„ç† PB çº§åˆ«çš„æ•°æ®ã€‚\n\n\n\nElasticsearch æ˜¯é¢å‘æ–‡æ¡£å‹æ•°æ®åº“ï¼Œä¸€æ¡æ•°æ®åœ¨è¿™é‡Œå°±æ˜¯ä¸€ä¸ªæ–‡æ¡£ã€‚è¿™é‡Œå’ŒMySQLè¿›è¡Œå¯¹æ¯”ã€‚\n\n{% mermaid %}\ngraph TD\n\tsubgraph a[ElasticSearch]\n\t\tIndex\n\t\tType\n\t\tDocuments\n\t\tFields\n\tend\n\tsubgraph b[MySQL]\n\t\tDatabase\n\t\tTable\n\t\tRow\n\t\tColumn\n\tend\n\tIndex --> Database\n\tType --> Table\n\tDocuments --> Row\n\tFields --> Column\n{% endmermaid %}\n\nES é‡Œçš„ Index å¯ä»¥çœ‹åšä¸€ä¸ªåº“ï¼Œè€ŒTypeç›¸å½“äºè¡¨ï¼ŒDocumentsåˆ™ç›¸å½“äºè¡¨çš„è¡Œã€‚ è¿™é‡ŒTypeçš„æ¦‚å¿µå·²ç»è¢«é€æ¸å¼±åŒ–ï¼ŒElasticsearch 6.X ä¸­ï¼Œä¸€ä¸ª index ä¸‹å·²ç»åªèƒ½åŒ…å«ä¸€ä¸ª typeï¼ŒElasticsearch 7.X ä¸­, Type çš„æ¦‚å¿µå·²ç»è¢«åˆ é™¤äº†ã€‚**æ–‡æ¡£æ˜¯ç”¨JSONä½œä¸ºåºåˆ—åŒ–çš„æ ¼å¼**ã€‚\n\n## å®‰è£…\n\nå„ç‰ˆæœ¬å®˜æ–¹ä¸‹è½½åœ°å€ï¼š[Past Releases of Elastic Stack Software | Elastic](https://www.elastic.co/cn/downloads/past-releases#elasticsearch)\n\n7.17.9ç‰ˆæœ¬å®˜æ–¹ä¸‹è½½åœ°å€ï¼š[Elasticsearch 7.17.9 | Elastic](https://www.elastic.co/cn/downloads/past-releases/elasticsearch-7-17-9)\n\nä¸‹è½½ç›¸å¯¹åº”ç³»ç»Ÿç‰ˆæœ¬çš„ESï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯Windowsã€‚\n\nç›®å½•ç»“æ„å¦‚ä¸‹ï¼š\n\n```pseudocode\nElasticSearch-7.17.9\nâ”œâ”€bin\t\t-å¯æ‰§è¡Œè„šæœ¬\nâ”œâ”€config\t-é…ç½®ç›®å½•\nâ”œâ”€data\t\t-æ•°æ®ç›®å½•\nâ”œâ”€jdk\t\t-å†…ç½®JDKç›®å½•\nâ”œâ”€lib\t\t-ç±»åº“\nâ”œâ”€logs\t\t-æ—¥å¿—ç›®å½•\nâ”œâ”€modules\t-æ¨¡å—ç›®å½•\nâ””â”€plugins\t-æ’ä»¶ç›®å½•\n```\n\nè§£å‹ååœ¨binä¸‹åŒå‡»elasticsearch.batå¯åŠ¨\n\nå¯åŠ¨åè®¿é—®http://localhost:9200 å‡ºç°ç±»ä¼¼å¦‚ä¸‹ä¿¡æ¯è¡¨ç¤ºæˆåŠŸï¼š\n\n```json\n{\n    \"name\": \"LAPTOP-xxx\",\n    \"cluster_name\": \"elasticsearch\",\n    \"cluster_uuid\": \"V5Ep9BM7Q2q9WCGBOYQ2BQ\",\n    \"version\": {\n        \"number\": \"7.17.9\",\n        \"build_flavor\": \"default\",\n        \"build_type\": \"zip\",\n        \"build_hash\": \"ef48222227ee6b9e70e502f0f0daa52435ee634d\",\n        \"build_date\": \"2023-01-31T05:34:43.305517834Z\",\n        \"build_snapshot\": false,\n        \"lucene_version\": \"8.11.1\",\n        \"minimum_wire_compatibility_version\": \"6.8.0\",\n        \"minimum_index_compatibility_version\": \"6.0.0-beta1\"\n    },\n    \"tagline\": \"You Know, for Search\"\n}\n```\n\næ³¨æ„ï¼š9300 ç«¯å£ä¸º Elasticsearch é›†ç¾¤é—´ç»„ä»¶çš„é€šä¿¡ç«¯å£ï¼Œ9200 ç«¯å£ä¸ºæµè§ˆå™¨è®¿é—®çš„ http åè®® RESTful ç«¯å£ã€‚\n\n### å‡ºç°é—®é¢˜\n\n1. Elasticsearchæ˜¯ä½¿ç”¨javaå¼€å‘çš„ï¼Œä¸”7.8ç‰ˆæœ¬çš„ESéœ€è¦**JDKç‰ˆæœ¬1.8ä»¥ä¸Š**ï¼Œé»˜è®¤å®‰è£…åŒ…å¸¦æœ‰ jdk ç¯å¢ƒï¼Œå¦‚æœç³»ç»Ÿé…ç½® JAVA_HOMEï¼Œé‚£ä¹ˆä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„ JDKï¼Œå¦‚æœæ²¡æœ‰é…ç½®ä½¿ç”¨è‡ªå¸¦çš„ JDKï¼Œä¸€èˆ¬å»ºè®®ä½¿ç”¨ç³»ç»Ÿé…ç½®çš„ JDKã€‚\n\n2. åŒå‡»å¯åŠ¨çª—å£é—ªé€€ï¼Œé€šè¿‡è·¯å¾„è®¿é—®è¿½è¸ªé”™è¯¯ï¼Œå¦‚æœæ˜¯â€œç©ºé—´ä¸è¶³â€ï¼Œè¯·ä¿®æ”¹config/jvm.optionsé…ç½®æ–‡ä»¶\n\n   ```properties\n   # è®¾ç½® JVM åˆå§‹å†…å­˜ä¸º 1Gã€‚æ­¤å€¼å¯ä»¥è®¾ç½®ä¸-Xmx ç›¸åŒï¼Œä»¥é¿å…æ¯æ¬¡åƒåœ¾å›æ”¶å®Œæˆå JVM é‡æ–°åˆ†é…å†…å­˜\n   # Xms represents the initial size of total heap space\n   # è®¾ç½® JVM æœ€å¤§å¯ç”¨å†…å­˜ä¸º 1G\n   # Xmx represents the maximum size of total heap space\n   -Xms1g\n   -Xmx1g\n   ```\n\n## ESåŸºæœ¬æ“ä½œ\n\n### HTTPæ“ä½œ\n\nå¯ä»¥ä½¿ç”¨[Postman](https://www.postman.com/)æ¥è¯·æ±‚Http\n\nHTTPè¯·æ±‚ESä½¿ç”¨çš„æ˜¯RESTful\n\n> [RESTful æ¶æ„è¯¦è§£ | èœé¸Ÿæ•™ç¨‹ (runoob.com)](https://www.runoob.com/w3cnote/restful-architecture.html)\n\n#### ç´¢å¼•æ“ä½œ\n\n##### åˆ›å»ºç´¢å¼•\n\nå¯¹æ¯”å…³ç³»å‹æ•°æ®åº“ï¼Œåˆ›å»ºç´¢å¼•å°±ç­‰åŒäºåˆ›å»ºæ•°æ®åº“ã€‚\n\n```pseudocode\nPUT | http://127.0.0.1:9200/shopping\n```\n\nåˆ›å»ºç´¢å¼•åä¸ºshoppingçš„ç´¢å¼•\n\næˆåŠŸåè¿”å›ï¼š\n\n```json\n{\n    // å“åº”ç»“æœ\n    \"acknowledged\": true,\n    // åˆ†ç‰‡ç»“æœ\n    \"shards_acknowledged\": true,\n    // ç´¢å¼•åç§°\n    \"index\": \"shopping\"\n}\n```\n\n**æ³¨æ„ï¼š**åˆ›å»ºç´¢å¼•åº“çš„åˆ†ç‰‡æ•°é»˜è®¤ 1 ç‰‡ï¼Œåœ¨ 7.0.0 ä¹‹å‰çš„ Elasticsearch ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤ 5 ç‰‡\n\nPUTå…·æœ‰å¹‚ç­‰æ€§ï¼Œ**é‡å¤æ·»åŠ **ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š\n\n```json\n{\n    \"error\": {\n        \"root_cause\": [\n            {\n                \"type\": \"resource_already_exists_exception\",\n                \"reason\": \"index [shopping/GWBeiEYFTZesYHgCPgvRMw] already exists\",\n                \"index_uuid\": \"GWBeiEYFTZesYHgCPgvRMw\",\n                \"index\": \"shopping\"\n            }\n        ],\n        \"type\": \"resource_already_exists_exception\",\n        \"reason\": \"index [shopping/GWBeiEYFTZesYHgCPgvRMw] already exists\",\n        \"index_uuid\": \"GWBeiEYFTZesYHgCPgvRMw\",\n        \"index\": \"shopping\"\n    },\n    \"status\": 400\n}\n```\n\n**æ³¨æ„ï¼š**æ¯æ¬¡æ·»åŠ çš„ç´¢å¼•uuidéƒ½ä¸ä¸€æ ·ï¼Œç”±ESè‡ªåŠ¨ç”Ÿæˆ\n\n##### æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•\n\n```pseudocode\nGET | http://127.0.0.1:9200/_cat/indices?v\n```\n\n- _catï¼šæŸ¥çœ‹\n\n- indicesï¼šç´¢å¼•\n\nç±»ä¼¼äºMySQLçš„show tablesï¼›\n\n**ç»“æœå¦‚ä¸‹ï¼š**\n\n```pseudocode\nhealth status index            uuid                   pri rep docs.count docs.deleted store.size pri.store.size\ngreen  open   .geoip_databases C0Hb6jtCSAKTujBNW90M2g   1   0         42            0     40.6mb         40.6mb\nyellow open   shopping         GWBeiEYFTZesYHgCPgvRMw   1   1          0            0       226b           226b\nyellow open   shopping1        Dr-xHmbwTA2icb-Yn_65EQ   1   1          0            0       226b           226b\n```\n\n**æ•´ç†æˆè¡¨æ ¼ï¼š**\n\n| health | status | index            | uuid                   | pri  | rep  | docs.count | docs.deleted | store.size | pri.store.size |\n| ------ | ------ | ---------------- | ---------------------- | ---- | ---- | ---------- | ------------ | ---------- | -------------- |\n| green  | open   | .geoip_databases | C0Hb6jtCSAKTujBNW90M2g | 1    | 0    | 42         | 0            | 40.6mb     | 40.6mb         |\n| yellow | open   | shopping         | GWBeiEYFTZesYHgCPgvRMw | 1    | 1    | 0          | 0            | 226b       | 226b           |\n| yellow | open   | shopping1        | Dr-xHmbwTA2icb-Yn_65EQ | 1    | 1    | 0          | 0            | 226b       | 226b           |\n\n**è¡¨å¤´å«ä¹‰ï¼š**\n\n- **health**ï¼šå½“å‰æœåŠ¡å™¨å¥åº·çŠ¶æ€\n  - **green**ï¼šé›†ç¾¤å®Œæ•´\n  - **yellow**ï¼šå•ç‚¹æ­£å¸¸ã€é›†ç¾¤ä¸å®Œæ•´\n  - **red**ï¼šå•ç‚¹ä¸æ­£å¸¸\n- **status**ï¼šç´¢å¼•çŠ¶æ€ï¼Œopenå’Œclose\n- **index**ï¼šç´¢å¼•å\n- **uuid**ï¼šç´¢å¼•ç»Ÿä¸€ç¼–å·\n- **pri**ï¼šä¸»åˆ†ç‰‡æ•°é‡\n- **rep**ï¼šå‰¯æœ¬æ•°é‡\n- **docs.count**ï¼šå¯ç”¨æ–‡æ¡£æ•°é‡\n- **docs.deleted**ï¼šæ–‡æ¡£åˆ é™¤çŠ¶æ€ï¼ˆé€»è¾‘åˆ é™¤ï¼‰\n- **store.size**ï¼šä¸»åˆ†ç‰‡å’Œå‰¯åˆ†ç‰‡æ•´ä½“å ç©ºé—´å¤§å°\n- **pri.store.size**ï¼šä¸»åˆ†ç‰‡å ç©ºé—´å¤§å°\n\n##### æŸ¥çœ‹å•ä¸ªç´¢å¼•\n\n```pseudocode\nGET | http://127.0.0.1:9200/shopping\n```\n\næŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š\n\n```json\n{\n    // ç´¢å¼•å\n    \"shopping\": {\n   \t\t// åˆ«å\n        \"aliases\": {},\n\t\t// æ˜ å°„\n        \"mappings\": {},\n\t\t// è®¾ç½®\n        \"settings\": {\n            \"index\": {\n                \"routing\": {\n                    \"allocation\": {\n                        \"include\": {\n                            \"_tier_preference\": \"data_content\"\n                        }\n                    }\n                },\n                // ä¸»åˆ†ç‰‡æ•°é‡\n                \"number_of_shards\": \"1\",\n                \"provided_name\": \"shopping\",\n                // åˆ›å»ºç´¢å¼•çš„æ—¶é—´æˆ³\n                \"creation_date\": \"1678613828568\",\n                // å‰¯åˆ†ç‰‡æ•°é‡\n                \"number_of_replicas\": \"1\",\n                \"uuid\": \"GWBeiEYFTZesYHgCPgvRMw\",\n                \"version\": {\n                    \"created\": \"7170999\"\n                }\n            }\n        }\n    }\n}\n```\n\n##### åˆ é™¤ç´¢å¼•\n\n```pseudocode\nDELETE | http://127.0.0.1:9200/shopping\n```\n\nåˆ é™¤æˆåŠŸï¼Œè¿”å›ç»“æœå¦‚ä¸‹ï¼š\n\n```json\n{\n    \"acknowledged\": true\n}\n```\n\nåˆ é™¤å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n```json\n{\n    \"error\": {\n        \"root_cause\": [\n            {\n                \"type\": \"index_not_found_exception\",\n                \"reason\": \"no such index [shopping]\",\n                \"resource.type\": \"index_or_alias\",\n                \"resource.id\": \"shopping\",\n                \"index_uuid\": \"_na_\",\n                \"index\": \"shopping\"\n            }\n        ],\n        \"type\": \"index_not_found_exception\",\n        \"reason\": \"no such index [shopping]\",\n        \"resource.type\": \"index_or_alias\",\n        \"resource.id\": \"shopping\",\n        \"index_uuid\": \"_na_\",\n        \"index\": \"shopping\"\n    },\n    \"status\": 404\n}\n```\n\n#### æ–‡æ¡£æ“ä½œ\n\nè·ŸMySQLç›¸æ¯”ï¼Œç´¢å¼•ç›¸å½“äºæ•°æ®åº“ï¼Œè€Œ**æ–‡æ¡£**ç›¸å½“äº**è¡Œ**ã€‚\n\n##### åˆ›å»ºæ–‡æ¡£\n\n```json\nPOST | http://127.0.0.1:9200/shopping/_doc\nè¯·æ±‚ä½“ï¼š\n{\n \"title\":\"å°ç±³13\",\n \"category\":\"å°ç±³\",\n \"images\":\"https://cdn.cnbj1.fds.api.mi-img.com/product-images/xiaomi-13kb7buy/4301.png\",\n \"price\":3999.00\n}\n```\n\n**_docè¡¨ç¤ºå¯¹ç´¢å¼•shoppingè¿›è¡Œæ–‡æ¡£æ“ä½œ**\nåˆ›å»ºæˆåŠŸï¼Œè¿”å›ç»“æœå¦‚ä¸‹ï¼š\n\n```json\n{\n    \"_index\": \"shopping\",\n    \"_type\": \"_doc\",\n    // æ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ï¼Œç±»æ¯”MySQLçš„ä¸»é”®\n    \"_id\": \"o1my1YYBHspLkJUmUbdQ\",\n    // ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šæ›´æ–°\n    \"_version\": 1,\n    // è¿™é‡Œcreatedè¡¨ç¤ºåˆ›å»ºæˆåŠŸ\n    \"result\": \"created\",\n    // åˆ†ç‰‡\n    \"_shards\": {\n        \"total\": 2,\n        \"successful\": 1,\n        \"failed\": 0\n    },\n    \"_seq_no\": 0,\n    \"_primary_term\": 1\n}\n```\n\n**æ³¨æ„ï¼š**æ¯æ¬¡æ·»åŠ çš„idéƒ½ä¸ä¸€æ ·ï¼Œç”±ESè‡ªåŠ¨ç”Ÿæˆ\n\nåœ¨åˆ›å»ºæ–‡æ¡£æ—¶æŒ‡å®šidä¸º1001ï¼Œå¦‚ä¸‹ï¼š\n\n```pseudocode\nPOST | http://127.0.0.1:9200/shopping/_doc/1001\n```\n\n**æ­¤å¤„éœ€è¦æ³¨æ„ï¼š**å¦‚æœå¢åŠ æ•°æ®æ—¶æ˜ç¡®æ•°æ®ä¸»é”®ï¼Œé‚£ä¹ˆè¯·æ±‚æ–¹å¼ä¹Ÿå¯ä»¥ä¸º PUT\n\n##### æŸ¥çœ‹æ‰€æœ‰æ–‡æ¡£\n\næŸ¥è¯¢ç´¢å¼•shoppingçš„å…¨éƒ¨æ–‡æ¡£\n\n```pseudocode\nGET | http://127.0.0.1:9200/shopping/_search\n```\n\næŸ¥è¯¢æˆåŠŸç»“æœå¦‚ä¸‹ï¼š\n\n```json\n{\n    \"took\": 12,\n    \"timed_out\": false,\n    // åˆ†ç‰‡\n    \"_shards\": {\n        \"total\": 1,\n        \"successful\": 1,\n        \"skipped\": 0,\n        \"failed\": 0\n    },\n    // å‘½ä¸­\n    \"hits\": {\n        \"total\": {\n    \t\t// æŸ¥è¯¢åˆ°çš„æ•°é‡\n            \"value\": 3,\n            \"relation\": \"eq\"\n        },\n        \"max_score\": 1.0,\n        // æŸ¥è¯¢åˆ°çš„æ•°æ®\n        \"hits\": [\n            {\n                \"_index\": \"shopping\",\n                \"_type\": \"_doc\",\n                \"_id\": \"o1my1YYBHspLkJUmUbdQ\",\n                \"_score\": 1.0,\n                \"_source\": {\n                    \"title\": \"å°ç±³13\",\n                    \"category\": \"å°ç±³\",\n                    \"images\": \"https://cdn.cnbj1.fds.api.mi-img.com/product-images/xiaomi-13kb7buy/4301.png\",\n                    \"price\": 3999.00\n                }\n            },\n            {\n                \"_index\": \"shopping\",\n                \"_type\": \"_doc\",\n                \"_id\": \"plm51YYBHspLkJUmxrdq\",\n                \"_score\": 1.0,\n                \"_source\": {\n                    \"title\": \"å°ç±³13\",\n                    \"category\": \"å°ç±³\",\n                    \"images\": \"https://cdn.cnbj1.fds.api.mi-img.com/product-images/xiaomi-13kb7buy/4301.png\",\n                    \"price\": 3999.00\n                }\n            },\n            {\n                \"_index\": \"shopping\",\n                \"_type\": \"_doc\",\n                \"_id\": \"1001\",\n                \"_score\": 1.0,\n                \"_source\": {\n                    \"title\": \"å°ç±³13\",\n                    \"category\": \"å°ç±³\",\n                    \"images\": \"https://cdn.cnbj1.fds.api.mi-img.com/product-images/xiaomi-13kb7buy/4301.png\",\n                    \"price\": 3999.00\n                }\n            }\n        ]\n    }\n}\n```\n\n##### æŸ¥çœ‹å•ä¸ªæ–‡æ¡£\n\n```pseudocode\nGET | http://127.0.0.1:9200/shopping/_doc/1001\n```\n\næŸ¥è¯¢ç´¢å¼•shoppingæ–‡æ¡£idä¸º1001çš„æ•°æ®ï¼Œå¦‚ä¸‹ï¼š\n\n```json\n{\n    \"_index\": \"shopping\",\n    \"_type\": \"_doc\",\n    \"_id\": \"1001\",\n    \"_version\": 1,\n    \"_seq_no\": 2,\n    \"_primary_term\": 1,\n    // æ˜¯å¦æŸ¥è¯¢åˆ°ç»“æœ\n    \"found\": true,\n    // æ–‡æ¡£æºä¿¡æ¯\n    \"_source\": {\n        \"title\": \"å°ç±³13\",\n        \"category\": \"å°ç±³\",\n        \"images\": \"https://cdn.cnbj1.fds.api.mi-img.com/product-images/xiaomi-13kb7buy/4301.png\",\n        \"price\": 3999.00\n    }\n}\n```\n\n##### ä¿®æ”¹æ–‡æ¡£\n\n**æ–‡æ¡£ä¿¡æ¯è¦†ç›–ï¼š**\n\n```json\nPOST | http://127.0.0.1:9200/shopping/_doc/1001\nè¯·æ±‚ä½“ï¼š\n{\n \"title\":\"å°ç±³13Pro\",\n \"category\":\"å°ç±³\",\n \"images\":\"https://cdn.cnbj1.fds.api.mi-img.com/product-images/xiaomi13pro5r9luc/specs/4025.png\",\n \"price\":5399.00\n}\n```\n\nè¦†ç›–æˆåŠŸï¼Œè¿”å›ç»“æœå¦‚ä¸‹ï¼š\n\n```json\n{\n    \"_index\": \"shopping\",\n    \"_type\": \"_doc\",\n    \"_id\": \"1001\",\n    // ç‰ˆæœ¬\n    \"_version\": 2,\n    // updatedè¡¨ç¤ºæ›´æ–°æˆåŠŸ\n    \"result\": \"updated\",\n    \"_shards\": {\n        \"total\": 2,\n        \"successful\": 1,\n        \"failed\": 0\n    },\n    \"_seq_no\": 3,\n    \"_primary_term\": 1\n}\n```\n\n**ä¿®æ”¹éƒ¨åˆ†ä¿¡æ¯ï¼š**_doc --> _update\n\n```json\nPOST | http://127.0.0.1:9200/shopping/_update/1001\nè¯·æ±‚ä½“ï¼š\n{\n    \"doc\": {\n        \"price\":6299.00\n    }\n}\n```\n\nåªä¿®æ”¹ä»·æ ¼ï¼Œè¿”å›ä¿®æ”¹æˆåŠŸç»“æœçš„ç»“æ„åŒä¸Šã€‚\n\n##### åˆ é™¤æ–‡æ¡£\n\n```pseudocode\nDELETE | http://127.0.0.1:9200/shopping/_doc/1001\n```\n\nåˆ é™¤ç´¢å¼•shoppingæ–‡æ¡£idä¸º1001ï¼Œè¿”å›æˆåŠŸç»“æœï¼š\n\n```json\n{\n    \"_index\": \"shopping\",\n    \"_type\": \"_doc\",\n    \"_id\": \"1001\",\n    \"_version\": 4,\n    // deletedè¡¨ç¤ºåˆ é™¤æˆåŠŸ\n    \"result\": \"deleted\",\n    \"_shards\": {\n        \"total\": 2,\n        \"successful\": 1,\n        \"failed\": 0\n    },\n    \"_seq_no\": 5,\n    \"_primary_term\": 1\n}\n```\n\n##### æ¡ä»¶æŸ¥è¯¢\n\nåœ¨è¯·æ±‚è·¯å¾„ä¸Šå¸¦å‚æ•°çš„æ¡ä»¶æŸ¥è¯¢\n\n```pseudocode\nGET | http://127.0.0.1:9200/shopping/_search?q=category:å°ç±³\n```\n\nä½†æ˜¯å®¹æ˜“å‡ºç°ä¸­æ–‡ä¹±ç ï¼Œæ‰€ä»¥å¯ä»¥åœ¨è¯·æ±‚ä½“é‡Œæ¥å¸¦å‚ï¼š\n\n```json\nGET | http://127.0.0.1:9200/shopping/_search\nè¯·æ±‚ä½“ï¼š\n{\n    \"query\": {\n        \"match\": {\n            \"category\": \"å°ç±³\"\n        }\n    }\n}\n```\n\næ¨èä½¿ç”¨ç¬¬äºŒç§æŸ¥è¯¢æ–¹å¼\n\nè‹¥è¦å¯¹æŸ¥è¯¢çš„æ•°æ®è¿›è¡Œå­—æ®µè¿‡æ»¤ï¼ˆä¾‹å¦‚è¿‡æ»¤titleï¼‰ï¼Œå¯ä»¥åœ¨è¯·æ±‚ä½“æ·»åŠ å‚æ•°ï¼š\n\n```json\n\"_source\": [\"title\"]\n```\n\n##### åˆ†é¡µæŸ¥è¯¢\n\n```json\nGET | http://127.0.0.1:9200/shopping/_search\nè¯·æ±‚ä½“ï¼š\n{\n    \"query\": {\n        // è¡¨ç¤ºå…¨æŸ¥è¯¢\n        \"match_all\": {\n        }\n    },\n    // å½“å‰é¡µæ•°æ®èµ·å§‹çš„ç´¢å¼•ä½ç½®\n    // ç¬¬né¡µæ•°æ®èµ·å§‹çš„ç´¢å¼•=(n - 1) * size\n    \"from\": 0,\n    // æ¯ä¸€é¡µæ˜¾ç¤ºå¤šå°‘ä¸ªæ•°æ®\n    \"size\": 2\n}\n```\n\nè‹¥è¦å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºï¼Œå¯ä»¥åœ¨è¯·æ±‚ä½“æ·»åŠ å¦‚ä¸‹å‚æ•°ï¼š\n\n```json\n\"sort\": {\n    // è¡¨ç¤ºå¯¹priceå­—æ®µæ’åº\n    \"price\": {\n        // descæ˜¯é™åºï¼Œascæ˜¯å‡åº\n        \"order\": \"desc\"\n    }\n}\n```\n\n##### å¤šæ¡ä»¶æŸ¥è¯¢\n\n```pseudocode\nGET | http://127.0.0.1:9200/shopping/_search\n```\n**AND**\tä¸‹é¢è¯·æ±‚ä½“è¡¨ç¤ºæŸ¥è¯¢categoryä¸ºå°ç±³å’Œä»·æ ¼ä¸º4999.00çš„æ•°æ®\n\n```json\n{\n    \"query\": {\n        // è¡¨ç¤ºå¤šæ¡ä»¶æŸ¥è¯¢\n        \"bool\": {\n            // è¡¨ç¤ºand\n            \"must\": [{\n                \"match\": {\n                \t\"category\": \"å°ç±³\"\n                }\n            },{\n                \"match\": {\n                    \"price\": \"3999.00\"\n                }\n            }]\n        }\n    }\n}\n```\n\n**OR**\t\tä¸‹é¢è¯·æ±‚ä½“è¡¨ç¤ºæŸ¥è¯¢categoryä¸ºå°ç±³æˆ–åä¸ºçš„æ•°æ®\n\n```json\n{\n    \"query\": {\n        // è¡¨ç¤ºå¤šæ¡ä»¶æŸ¥è¯¢\n        \"bool\": {\n            // è¡¨ç¤ºor\n            \"should\": [{\n                \"match\": {\n                \t\"category\": \"å°ç±³\"\n                }\n            },{\n                \"match\": {\n                    \"category\": \"åä¸º\"\n                }\n            }]\n        }\n    }\n}\n```\n\nå¦‚æœæˆ‘ä»¬è¦è¡¨ç¤ºprice>2000çš„è¯å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š\n\n```json\n//åœ¨boolå†…æ·»åŠ ï¼š\n\"filter\": {\n    // è¡¨ç¤ºèŒƒå›´\n    \"range\": {\n        \"price\": {\n            // gt = greater than å¤§äº\n            // lt = less than å°äº\n            \"gt\": 2000\n        }\n    }\n}\n```\n\n##### å…¨æ–‡æ£€ç´¢&é«˜äº®æŸ¥è¯¢\n\n```json\nGET | http://127.0.0.1:9200/shopping/_search\nè¯·æ±‚ä½“ï¼š\n{\n    \"query\": {\n        // ä½¿ç”¨matchæ˜¯ æ‹†åˆ†å­—è¯åçš„æ¨¡ç³ŠæŸ¥è¯¢\n        \"match\": {\n            // ä¸‹åˆ—æ˜¯æŸ¥è¯¢åŒ…å«â€œç±³â€çš„æ•°æ®\n            \"category\": \"ç±³\"\n            // ä¸‹åˆ—æŸ¥è¯¢åŒ…å«\"å°\"æˆ–\"å\"çš„æ•°æ®\n            // \"category\": \"å°å\"\n        }\n        // è‹¥ä½¿ç”¨çš„æ˜¯match_parse,åˆ™è¡¨ç¤º æ•´ä½“åŒ¹é…çš„æ¨¡ç³ŠæŸ¥è¯¢\n    },\n    // é«˜äº®æŸ¥è¯¢ï¼Œé«˜äº®æŒ‡å®šå­—æ®µ\n    \"highlight\": {\n        \"fields\": {\n            // é«˜äº®æ˜¾ç¤ºcategoryå­—æ®µ ç›¸åº”å…³é”®è¯\n            \"category\": {}\n        }\n\t}\n}\n```\n\n##### èšåˆæŸ¥è¯¢\n\n```json\nGET | http://127.0.0.1:9200/shopping/_search\nè¯·æ±‚ä½“ï¼š\n{\n    // èšåˆæ“ä½œ\n    \"aggs\": {\n        // åç§°ï¼Œå¯ä»¥éšæ„å–\n        \"price_group\": {\n            // termsåˆ†ç»„ï¼Œç±»ä¼¼äºmysqlçš„group by\n            // ç±»ä¼¼çš„æ“ä½œè¿˜æœ‰ avg max min sum doc_count\n            \"terms\": {\n                // åˆ†ç»„çš„å­—æ®µï¼Œè¿™é‡Œæ˜¯æŒ‰priceçš„ä¸åŒæ¥åˆ†ç»„\n                \"field\": \"price\"\n            }\n        }\n    },\n    // æŸ¥è¯¢æ˜¾ç¤ºçš„æ•°é‡\n    \"size\": 0\n}\n```\n\n##### æ˜ å°„å…³ç³»\n\nè·å–ç´¢å¼•shoppingçš„æ˜ å°„ä¿¡æ¯\n\n```pseudocode\nGET | http://127.0.0.1:9200/shopping/_mapping\n```\n\nåˆ›å»ºç´¢å¼•shoppingçš„æ˜ å°„ä¿¡æ¯\n\n```json\nPUT | http://127.0.0.1:9200/shopping/_mapping\nè¯·æ±‚ä½“ï¼š\n{\n    \"properties\": {\n        // é…ç½®å­—æ®µçš„æ˜ å°„å…³ç³»\n        \"category\": {\n            // å­—æ®µç±»å‹\n            \"type\": \"text\",\n            // æ˜¯å¦å¯ä»¥ç´¢å¼•æŸ¥è¯¢\n            \"index\": true\n        },\n        \"price\": {\n            \"type\": \"keyword\",\n            // è‹¥ä¸ºfalseåˆ™ä¸èƒ½è¢«å…¨æ–‡æ£€ç´¢\n            \"index\": false\n        }\n    }\n}\n```\n\n","tags":["ç¬”è®°","ElasticSearch"],"categories":["å¾®æœåŠ¡ç”Ÿæ€"]},{"title":"Dubboå­¦ä¹ ç¬”è®°","url":"/2023/03/10/dubbo-note/","content":"\n# Dubbo\n\n> è§†é¢‘å­¦ä¹ ï¼š[åŠ¨åŠ›èŠ‚ç‚¹Dubboæ•™ç¨‹(2020æœ€æ–°ç‰ˆ)Dubboé¡¹ç›®å®æˆ˜_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1Sk4y197eD/?vd_source=c155e4a52de51664d15aaf241c4a7656)\n\n## ç®€ä»‹\n\nApache Dubbo æ˜¯ä¸€æ¬¾æ˜“ç”¨ã€é«˜æ€§èƒ½çš„ WEB å’Œ RPC æ¡†æ¶ï¼ŒåŒæ—¶ä¸ºæ„å»ºä¼ä¸šçº§å¾®æœåŠ¡æä¾›æœåŠ¡å‘ç°ã€æµé‡æ²»ç†ã€å¯è§‚æµ‹ã€è®¤è¯é‰´æƒç­‰èƒ½åŠ›ã€å·¥å…·ä¸æœ€ä½³å®è·µã€‚\n\nDubboæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶,è‡´åŠ›äºæä¾›é«˜æ€§èƒ½å’Œé€æ˜åŒ–çš„RPCè¿œç¨‹æœåŠ¡è°ƒç”¨æ–¹æ¡ˆã€æœåŠ¡æ²»ç†æ–¹æ¡ˆã€‚\n\n> **å®˜ç½‘**ï¼š[Apache Dubbo](https://cn.dubbo.apache.org)\n\n![dubboArchitecture](https://cn.dubbo.apache.org/imgs/architecture.png)\n\n- **æœåŠ¡æä¾›è€…ï¼ˆProviderï¼‰**ï¼š**æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹**ï¼›æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±çš„æœåŠ¡ã€‚\n\n- **æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰**ï¼š**è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹**ï¼›æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼›æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚\n- **æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰**ï¼š **æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ**ï¼›æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼›å¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚\n\n- **ç›‘æ§ä¸­å¿ƒï¼ˆMonitorï¼‰**ï¼šæœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡**è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´**ï¼Œå®šæ—¶**æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡**ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚\n- **å®¹å™¨ï¼ˆContainerï¼‰**ï¼šæœåŠ¡è¿è¡Œçš„å®¹å™¨\n\n## ä½¿ç”¨SpringBootè¿›è¡Œè¿æ¥\n\nä½¿ç”¨çš„**Dubboç‰ˆæœ¬æ˜¯3.1.7**\n\nä½¿ç”¨Zookeeper3.7.1ä½œä¸ºæ³¨å†Œä¸­å¿ƒ\n\n### ä¾‹å­\n\nåˆ†åˆ«åˆ›å»ºä¸‰ä¸ªSpringBooté¡¹ç›®æˆ–æ¨¡å—ï¼š\n\n```pseudocode\nspringboot-interface\t--æä¾›æ¥å£\nspringboot-provider\t\t--æä¾›è€…\nspringboot-consumer\t\t--æ¶ˆè´¹è€…\n```\n\n`springboot-interface`å­˜åœ¨çš„æ„ä¹‰æ˜¯é˜²æ­¢æ¶ˆè´¹è€…é€šè¿‡newçš„æ–¹å¼æ¥è·å–æä¾›è€…çš„æœåŠ¡ã€‚\n\n#### ç¼–å†™æ¥å£\n\n- `springboot-interface`ä½¿ç”¨æ™®é€šçš„Mavenå·¥ç¨‹å³å¯ã€‚\n\n- `pom.xml`å¼•å…¥ç›¸åº”çš„ä¾èµ–ï¼Œæ‰“åŒ…æ–¹å¼ä¸ºjarã€‚\n\n- åˆ›å»ºæœåŠ¡æ¥å£`top.wshape1.interface.service.HelloService`\n  \n- `HelloService.java`å†…å®¹å¦‚ä¸‹ï¼š\n  \n  ```java\n  public interface HelloService {\n      String hello(String msg);\n  }\n  ```\n  \n  \n\nç¼–å†™å®Œæˆä¹‹åç¼–è¯‘å®‰è£…åˆ°æœ¬åœ°Mavenä»“åº“ã€‚\n\n#### ç¼–å†™æä¾›è€…\n\n##### æ·»åŠ ä¾èµ–\n\n```xml\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n    \n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-test</artifactId>\n        <scope>test</scope>\n    </dependency>\n    \n    <dependency>\n        <groupId>top.wshape1</groupId>\n        <artifactId>springboot-interface</artifactId>\n        <version>1.0-SNAPSHOT</version>\n    </dependency>\n    \n    <dependency>\n        <groupId>org.apache.curator</groupId>\n        <artifactId>curator-x-discovery</artifactId>\n        <version>5.4.0</version>\n    </dependency>\n    \n    <dependency>\n        <groupId>org.apache.dubbo</groupId>\n        <artifactId>dubbo-spring-boot-starter</artifactId>\n        <version>3.1.7</version>\n    </dependency>\n</dependencies>\n```\n\n##### åˆ›å»ºæ¥å£å®ç°ç±»\n\n`top.wshape1.provider.service.impl.HelloServiceImpl`\n\n`HelloServiceImpl.java`å†…å®¹å¦‚ä¸‹ï¼š\n\n```java\n@DubboService\npublic class HelloServiceImpl implements HelloService {\n    @Override\n    public String hello(String msg) {\n        return \"hello, \" + msg;\n    }\n}\n```\n\n3.xç‰ˆæœ¬åä¸ºäº†é˜²æ­¢ä¸è§†é¢‘springçš„@Serviceæ··æ·†è€Œå˜æ›´ä¸º@DubboServiceï¼Œæ ‡æ³¨ä¸ºæš´éœ²çš„æœåŠ¡\n\n##### å¯ç”¨Dubbo\n\nåœ¨é…ç½®ç±»ä¸Šæ³¨è§£@EnableDubbo\n\n```java\n@EnableDubbo\n@SpringBootApplication\npublic class SpringbootProviderApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(SpringbootProviderApplication.class, args);\n    }\n\n}\n```\n\n##### é…ç½®`application.yml`\n\n```yaml\ndubbo:\n  application:\n  # dubbo åº”ç”¨å”¯ä¸€æ ‡è¯†\n    name: dubbo-provider\n  registry:\n  # æ³¨å†Œä¸­å¿ƒåœ°å€ï¼Œè¿™é‡Œä½¿ç”¨zookeeper\n    address: zookeeper://127.0.0.1:2181\n  protocol:\n  # é€šä¿¡åè®®å’Œç«¯å£\n  # é€šä¿¡åè®®æœ‰dubboã€gRPCã€Thriftã€RESTã€JsonRPCã€Hessian2ç­‰ï¼Œå®˜æ–¹æ¨èdubbo\n    name: dubbo\n  # ç«¯å£é»˜è®¤ä¸º20880\n    port: 20880\nserver:\n# webç«¯å£ï¼Œä¿®æ”¹ä»¥é˜²æ­¢ç«¯å£å†²çª\n  port: 8081\n```\n\n#### ç¼–å†™æ¶ˆè´¹è€…\n\n##### æ·»åŠ ä¾èµ–\n\n```xml\n<dependencies>\n    <dependency>\n        <groupId>top.wshape1</groupId>\n        <artifactId>springboot-interface</artifactId>\n        <version>1.0-SNAPSHOT</version>\n    </dependency>\n\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n\n    <dependency>\n        <groupId>org.apache.curator</groupId>\n        <artifactId>curator-x-discovery</artifactId>\n        <version>5.4.0</version>\n    </dependency>\n\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-test</artifactId>\n        <scope>test</scope>\n    </dependency>\n\n    <dependency>\n        <groupId>org.apache.dubbo</groupId>\n        <artifactId>dubbo-spring-boot-starter</artifactId>\n        <version>3.1.7</version>\n    </dependency>\n</dependencies>\n```\n\n##### åˆ›å»ºcontroller\n\nåŒ…è·¯å¾„`top.wshape1.consumer.controller.HelloController`\n\n`HelloController.java`å¦‚ä¸‹ï¼š\n\n```java\n@Controller\npublic class HelloController {\n\n    @DubboReference\n    private HelloService helloService;\n\n    @GetMapping(\"/hello\")\n    @ResponseBody\n    public String hello(String msg) {\n        return helloService.hello(msg);\n    }\n\n}\n```\n\næ³¨è§£@DubboReferenceå¼•ç”¨è¿œç¨‹æœåŠ¡æ³¨å…¥\n\n##### é…ç½®`application.yml`\n\n```yaml\ndubbo:\n  application:\n  # dubbo åº”ç”¨å”¯ä¸€æ ‡è¯†\n    name: dubbo-consumer\n  registry:\n  # æ³¨å†Œä¸­å¿ƒåœ°å€ï¼Œä¸æä¾›è€…ä½¿ç”¨åŒä¸€ä¸ª\n    address: zookeeper://127.0.0.1:2181\n\nserver:\n# webç«¯å£ï¼Œä¿®æ”¹ä»¥é˜²æ­¢ç«¯å£å†²çª\n  port: 8080\n```\n\n#### è¿è¡Œæµ‹è¯•\n\n1. å¯åŠ¨Zookeeper\n2. å¯åŠ¨æä¾›è€…\n3. å¯åŠ¨æ¶ˆè´¹è€…\n4. æ‰“å¼€http://localhost:8080/hello?msg=worldæµ‹è¯•\n\n#### å‡ºç°é—®é¢˜\n\n1.**ç«¯å£å†²çª**\n\nå‡ºç°ç«¯å£å†²çªï¼Œå¦‚ä¸‹qosç«¯å£å†²çª\n\n```shell\n2023-03-10 22:43:32.780 ERROR 11144 --- [           main] org.apache.dubbo.qos.server.Server       :  [DUBBO] qos-server can not bind localhost:22222, dubbo version: 3.1.7, current host: 10.77.97.83, error code: 7-4. This may be caused by , go to https://dubbo.apache.org/faq/7/4 to find instructions. \n\njava.net.BindException: Address already in use: bind\n```\n\nå¯å°è¯•ä¿®æ”¹ç«¯å£\n\nåœ¨`application.yml`ä¿®æ”¹qosç«¯å£\n\n```yaml\ndubbo:\n\tapplication:\n\t# é»˜è®¤ä¸º22222\n    \tqos-host: 22223\n```\n\n## å¸¸è§é…ç½®å±æ€§\n\n```yaml\n# application.yml\ndubbo:\n\tconsumer:\n  # æ˜¯å¦åœ¨å¯åŠ¨æ—¶æ£€æŸ¥æä¾›è€…æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨å°†åœæ­¢\n\t\tcheck: true\n    \n        # æ¶ˆè´¹è€…å°†å¼•ç”¨çš„è¿œç¨‹æœåŠ¡ç‰ˆæœ¬\n        # version: \"\"\n\n\tprovider:\n\t\t# æä¾›è€…å°†æä¾›çš„è¿œç¨‹æœåŠ¡ç‰ˆæœ¬\n    \t# version: \"\"\n```\n\n**@DubboServiceæ³¨è§£**\n\n- `String version() default \"\"`æš´éœ²æœåŠ¡çš„ç‰ˆæœ¬å·ï¼Œè‹¥æœ‰ç‰ˆæœ¬å·åˆ™æ¶ˆè´¹è€…å¿…é¡»æŒ‡å®šç‰ˆæœ¬å·ã€‚\n\n**@DubboReference**\n\n- `String version() default \"\"`æŒ‡å®šç‰ˆæœ¬å·ï¼Œè‹¥æœ‰ç‰ˆæœ¬å·åˆ™å¿…å¡«ã€‚\n- `boolean check() default true`åœ¨å¯åŠ¨æœŸé—´æ£€æŸ¥æä¾›è€…æ˜¯å¦å¯ç”¨ã€‚\n\n## ç›‘æ§ä¸­å¿ƒ\n\n[apache/dubbo-admin: The ops and reference implementation for Apache Dubbo (github.com)](https://github.com/apache/dubbo-admin/)\n","tags":["ç¬”è®°","Dubbo"],"categories":["å¾®æœåŠ¡ç”Ÿæ€"]},{"title":"Zookeeperå­¦ä¹ ç¬”è®°","url":"/2023/02/21/zookeeper-note/","content":"\n# Zookeeper\n\n> è§‚çœ‹[åƒé”‹æœ€æ–°Zookeeperé›†ç¾¤æ•™ç¨‹-å…¨ç½‘æœ€å…¨Zookeeperåº”ç”¨åŠåŸç†åˆ†æè¯¾ç¨‹_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1Ph411n7Ep/)è¿›è¡Œå­¦ä¹ ã€‚\n>\n> éƒ¨åˆ†ç¬”è®°æ¥æºäºç½‘ç»œã€‚\n>\n> **æœ¬æ–‡ä½¿ç”¨çš„Zookeeperç‰ˆæœ¬æ˜¯3.7.1**\n\n- åˆ†å¸ƒå¼åè°ƒç»„ä»¶\n\n{% mermaid %}\ngraph LR\n\tç”¨æˆ· ==> Nginx\n\t--> a[æœåŠ¡A-1<br/>int flag=true] --> r\n\tb[æœåŠ¡A-2<br/>int flag=true] --> r\n\tr[åˆ†å¸ƒå¼åè°ƒä¸­å¿ƒZookeeper<br>ZnodeèŠ‚ç‚¹:flag=true<br>ä¸€æ—¦èŠ‚ç‚¹å‘ç”Ÿæ”¹å˜,<br>å°±ä¼šé€šçŸ¥æ‰€æœ‰ç›‘å¬æ”¹å˜è‡ªå·±çš„å€¼-Watchæœºåˆ¶<br>åˆ†å¸ƒå¼é”å¯ä»¥è®©åˆ†å¸ƒå¼æœåŠ¡å¤„äºæ— çŠ¶æ€]\n{% endmermaid %}\n\n\n\nåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œéœ€è¦æœ‰zookeeperä½œä¸ºåˆ†å¸ƒå¼åè°ƒç»„ä»¶ï¼Œåè°ƒåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„çŠ¶æ€\n\n- åˆ†å¸ƒå¼é”\n\nzkåœ¨å®ç°åˆ†å¸ƒå¼é”ä¸Šï¼Œå¯ä»¥åšåˆ°å¼ºä¸€è‡´æ€§ï¼Œå…³äºåˆ†å¸ƒå¼é”çš„ç›¸å…³çŸ¥è¯†ï¼Œä¼šåœ¨ä¹‹åçš„ZABåè®®ä¸­ä»‹ç»\n\n- æ— çŠ¶æ€åŒ–çš„å®ç°\n\n{% mermaid %}\nflowchart TD\n\tå®¢æˆ·ç«¯ --> b\n\ta[åˆ†å¸ƒå¼ç³»ç»Ÿ<br>ç™»å½•ç³»ç»Ÿ] --ä¿å­˜ç™»å½•ä¿¡æ¯--> z\n\tb[åˆ†å¸ƒå¼ç³»ç»Ÿ<br>ç™»å½•ç³»ç»Ÿ] --> z\n\tc[åˆ†å¸ƒå¼ç³»ç»Ÿ<br>ç™»å½•ç³»ç»Ÿ] --æ ¡éªŒ--> z\n\tsubgraph z[Zookeeper]\n\t\tç™»å½•ä¿¡æ¯\n\tend\n{% endmermaid %}\n\n\n\n## å®‰è£…å’Œé…ç½®å¯åŠ¨\n\n### ä¸‹è½½åœ°å€\n\nå®˜ç½‘ä¸‹è½½ï¼š[Apache ZooKeeper](https://zookeeper.apache.org/releases.html)\n\né˜¿é‡Œäº‘é•œåƒç«™ä¸‹è½½ï¼š[apache-zookeeperå®‰è£…åŒ…ä¸‹è½½_å¼€æºé•œåƒç«™-é˜¿é‡Œäº‘ (aliyun.com)](https://mirrors.aliyun.com/apache/zookeeper/)\n\nä¸‹è½½åè§£å‹å³å¯ã€‚\n\n### é…ç½®æ–‡ä»¶\n\né…ç½®æ–‡ä»¶æ ·ä¾‹`conf/zoo_sample.cfg`å¦‚ä¸‹ï¼š\n\n```properties\n# The number of milliseconds of each tick\ntickTime=2000\n# å…è®¸followeråˆå§‹åŒ–è¿æ¥åˆ°leaderæœ€å¤§æ—¶é•¿ï¼Œå®ƒè¡¨ç¤ºtickTimeæ—¶é—´å€æ•°\n# å³initLimit*tickTime\ninitLimit=10\n# å…è®¸followerä¸leaderæ•°æ®åŒæ­¥æœ€å¤§æ—¶é•¿ï¼Œå®ƒè¡¨ç¤ºtickTimeæ—¶é—´å€æ•°\nsyncLimit=5\n# zookeeperæ•°æ®ï¼ˆå¿«ç…§ï¼‰å‚¨å­˜çš„ç›®å½•\n# è‹¥æ— dataLogDiråˆ™æ—¥å¿—ä¹Ÿå‚¨å­˜åœ¨æ­¤ç›®å½•\ndataDir=/tmp/zookeeper\n# å¯¹å®¢æˆ·ç«¯æä¾›çš„ç«¯å£å·\nclientPort=2181\n# å®¢æˆ·ç«¯çš„æœ€å¤§è¿æ¥æ•°\n#maxClientCnxns=60\n\n# ä¿å­˜çš„å¿«ç…§æ•°é‡\n#autopurge.snapRetainCount=3\n\n# è‡ªåŠ¨è§¦å‘æ¸…é™¤ä»»åŠ¡æ—¶é—´é—´éš”ï¼Œå•ä½å°æ—¶\n# 0è¡¨ç¤ºå…³é—­\n#autopurge.purgeInterval=1\n\n## Metrics Providers\n#\n# https://prometheus.io Metrics Exporter\n#metricsProvider.className=org.apache.zookeeper.metrics.prometheus.PrometheusMetricsProvider\n#metricsProvider.httpPort=7000\n#metricsProvider.exportJvmInfo=true\n\n\n```\n\nè¦å¯åŠ¨å¿…é¡»è¦æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¤åˆ¶ä¸€ä»½æ ·ä¾‹æ–‡ä»¶åœ¨ç›¸åŒç›®å½•å¹¶é‡å‘½åä¸º`zoo.cfg`ï¼Œä¿®æ”¹ç›¸å…³é…ç½®å³å¯ã€‚\n\n**zookeeperé»˜è®¤å¯»æ‰¾conf/zoo.cfgé…ç½®æ–‡ä»¶ã€‚**\n\n### å¯åŠ¨Zookeeper\n\nåœ¨binç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°è®¸å¤šå¯æ‰§è¡Œè„šæœ¬ï¼Œåç¼€ä¸ºcmdä¸ºWindowsä¸‹æ‰§è¡Œçš„ï¼Œshä¸ºLinuxä¸‹æ‰§è¡Œçš„ã€‚\n\n#### Windowsä¸‹å¯åŠ¨\n\nåŒå‡»`zkServer.cmd`æ‰“å¼€ï¼Œä¸é—ªé€€åˆ™å¯åŠ¨æˆåŠŸã€‚\n\nåŒå‡»`zkCli.cmd`æ‰“å¼€å®¢æˆ·ç«¯çª—å£ã€‚\n\n#### Linuxä¸‹å¯åŠ¨\n\nåœ¨binç›®å½•ä¸‹ï¼š\n\n- `./zkServer.sh start`å¯åŠ¨Zookeeper\n- `./zkServer.sh status`æŸ¥è¯¢ZookeeperçŠ¶æ€ä¿¡æ¯\n- `./zkServer.sh stop`åœæ­¢Zookeeper\n- åœ¨åé¢æ·»åŠ é…ç½®æ–‡ä»¶è·¯å¾„æ¥æŒ‡å®šé…ç½®æ–‡ä»¶\n  - å¦‚ï¼š`./zkServer.sh start ../conf/zoo.cfg`\n\nè¿æ¥å®¢æˆ·ç«¯ï¼š\n\n- `./zkCli.sh -server <host:port>`è¿æ¥Zookeeperï¼Œæ²¡æœ‰-serveré»˜è®¤è¿æ¥localhost:2181\n\n## å†…éƒ¨æ•°æ®æ¨¡å‹\n\nZookeeperçš„æ•°æ®æ˜¯ä»¥**èŠ‚ç‚¹(Znode)**çš„å½¢å¼æ„æˆä¸€æ£µ**æ ‘**å‚¨å­˜ã€‚\n\n`/`ä¸ºæ ‘çš„æ ¹ã€‚\n\n{% mermaid %}\nflowchart TD\n\t/ --> a --> aa\n\t/ --> b -->ba\n\ta --> ab\n\tb --> bb\n{% endmermaid %}\n\n\n\n### Znodeçš„ç»„æˆ\n\nZookeeperä¸­çš„ZnodeåŒ…å«äº†å››ä¸ªéƒ¨åˆ†\n\n dataï¼šä¿å­˜æ•°æ®\n\n aclï¼šæƒé™ï¼š\n\n- cï¼šcreate åˆ›å»ºæƒé™ï¼Œå…è®¸åœ¨è¯¥èŠ‚ç‚¹ä¸‹åˆ›å»ºå­èŠ‚ç‚¹\n\n- wï¼šwrite æ›´æ–°æƒé™ï¼Œå…è®¸æ›´æ–°è¯¥èŠ‚ç‚¹çš„æ•°æ®\n\n- rï¼šread è¯»å–æƒé™ï¼Œå…è®¸è¯»å–è¯¥èŠ‚ç‚¹çš„å†…å®¹ä»¥åŠå­èŠ‚ç‚¹çš„åˆ—è¡¨ä¿¡æ¯\n\n- dï¼šdelete åˆ é™¤æƒé™ï¼Œå…è®¸åˆ é™¤è¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¿¡æ¯\n\n- aï¼šadmin ç®¡ç†è€…æƒé™ï¼Œå…è®¸å¯¹è¯¥èŠ‚ç‚¹è¿›è¡Œaclæƒé™è®¾ç½®\n\n  statï¼šæè¿°å½“å‰znodeçš„å…ƒæ•°æ®\n\n  childï¼šå½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹\n\n### Znodeçš„ç±»å‹\n\n1. **æŒä¹…èŠ‚ç‚¹**ï¼šåˆ›å»ºå‡ºçš„èŠ‚ç‚¹ï¼Œåœ¨ä¼šè¯ç»“æŸåä¾ç„¶å­˜åœ¨ã€‚ä¿å­˜æ•°æ®\n\n2. **æŒä¹…åºå·èŠ‚ç‚¹**ï¼šåˆ›å»ºå‡ºçš„èŠ‚ç‚¹ï¼Œæ ¹æ®å…ˆåé¡ºåºï¼Œä¼šåœ¨èŠ‚ç‚¹ä¹‹åå¸¦ä¸Šä¸€ä¸ªæ•°å€¼ï¼Œè¶Šåæ‰§è¡Œæ•°å€¼è¶Šå¤§ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼é”çš„åº”ç”¨åœºæ™¯-å•è°ƒé€’å¢\n\n3. **ä¸´æ—¶èŠ‚ç‚¹**ï¼šä¸´æ—¶èŠ‚ç‚¹æ˜¯åœ¨ä¼šè¯ç»“æŸåï¼Œè‡ªåŠ¨è¢«åˆ é™¤çš„ï¼Œé€šè¿‡è¿™ä¸ªç‰¹æ€§ï¼Œzkå¯ä»¥å®ç°æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ•ˆæœã€‚\n\n4. **ä¸´æ—¶åºå·èŠ‚ç‚¹**ï¼šè·ŸæŒä¹…åºå·èŠ‚ç‚¹ç›¸åŒï¼Œé€‚ç”¨äºä¸´æ—¶çš„åˆ†å¸ƒå¼é”\n\n5. **ContainerèŠ‚ç‚¹**ï¼ˆ3.5.3ç‰ˆæœ¬æ–°å¢ï¼‰ï¼šContainerå®¹å™¨èŠ‚ç‚¹ï¼Œå½“å®¹å™¨ä¸­æ²¡æœ‰ä»»ä½•å­èŠ‚ç‚¹ï¼Œè¯¥å®¹å™¨èŠ‚ç‚¹ä¼šè¢«zkå®šæœŸåˆ é™¤\n\n6. **TTLèŠ‚ç‚¹**ï¼šå¯ä»¥æŒ‡å®šèŠ‚ç‚¹çš„åˆ°æœŸæ—¶é—´ï¼Œåˆ°æœŸåè¢«zkå®šæ—¶åˆ é™¤ã€‚åªèƒ½é€šè¿‡ç³»ç»Ÿé…ç½®zookeeper.extendedTypeEnablee=trueå¼€å¯\n\n## æ•°æ®æŒä¹…åŒ–\n\nzkçš„æ•°æ®æ˜¯è¿è¡Œåœ¨å†…å­˜ä¸­ï¼Œzkæä¾›äº†ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶ï¼š\n\n- **äº‹åŠ¡æ—¥å¿—**ï¼šzkæŠŠæ‰§è¡Œçš„å‘½ä»¤ä»¥æ—¥å¿—å½¢å¼ä¿å­˜åœ¨dataLogDiræŒ‡å®šçš„è·¯å¾„ä¸­çš„æ–‡ä»¶ä¸­\n\n- **æ•°æ®å¿«ç…§**ï¼šzkä¼šåœ¨ä¸€å®šçš„æ—¶é—´é—´éš”å†…åšä¸€æ¬¡å†…å­˜æ•°æ®å¿«ç…§ï¼ŒæŠŠæ—¶åˆ»çš„å†…å­˜æ•°æ®ä¿å­˜åœ¨å¿«ç…§æ–‡ä»¶ä¸­\n\nzké€šè¿‡ä¸¤ç§å½¢å¼çš„æŒä¹…åŒ–ï¼Œåœ¨æ¢å¤æ—¶**å…ˆæ¢å¤å¿«ç…§æ–‡ä»¶**ä¸­çš„æ•°æ®åˆ°å†…å­˜ä¸­ï¼Œå†ç”¨æ—¥å¿—æ–‡ä»¶ä¸­çš„æ•°æ®åšå¢é‡æ¢å¤ï¼Œè¿™æ ·æ¢å¤çš„é€Ÿåº¦æ›´å¿«ã€‚\n\n## zkCliå®¢æˆ·ç«¯çš„ä½¿ç”¨\n\n### å¤šèŠ‚ç‚¹ç±»å‹åˆ›å»º\n\n- åˆ›å»ºæŒä¹…èŠ‚ç‚¹\n\n  create <path> [data] [acl]\n\n- åˆ›å»ºæŒä¹…åºå·èŠ‚ç‚¹\n\n  create -s <path> [data] [acl]\n\n- åˆ›å»ºä¸´æ—¶èŠ‚ç‚¹\n\n  create -e <path> [data] [acl]\n\n- åˆ›å»ºä¸´æ—¶åºå·èŠ‚ç‚¹\n\n  create -e -s <path> [data] [acl]\n\n- åˆ›å»ºå®¹å™¨èŠ‚ç‚¹\n\n  create -c <path> [data] [acl]\n\n### æŸ¥è¯¢èŠ‚ç‚¹\n\n- æ™®é€šæŸ¥è¯¢\n\n  - ls [-s -R] <path>\n\n    -s è¯¦ç»†ä¿¡æ¯\n\n    -R å½“å‰ç›®å½•å’Œå­ç›®å½•ä¸­çš„æ‰€æœ‰ä¿¡æ¯\n\n- æŸ¥è¯¢èŠ‚ç‚¹ç›¸å…³ä¿¡æ¯\n\n  - cZxidï¼šåˆ›å»ºèŠ‚ç‚¹çš„äº‹åŠ¡ID\n  - mZxidï¼šä¿®æ”¹èŠ‚ç‚¹çš„äº‹åŠ¡ID\n  - pZxidï¼šæ·»åŠ å’Œåˆ é™¤å­èŠ‚ç‚¹çš„äº‹åŠ¡ID\n  - ctimeï¼šèŠ‚ç‚¹åˆ›å»ºçš„æ—¶é—´\n  - mtimeï¼šèŠ‚ç‚¹æœ€è¿‘ä¿®æ”¹çš„æ—¶é—´\n  - cversionï¼šå­èŠ‚ç‚¹çš„version\n  - dataVersionï¼šèŠ‚ç‚¹å†…æ•°æ®çš„ç‰ˆæœ¬ï¼Œæ¯æ›´æ–°ä¸€æ¬¡æ•°æ®ï¼Œç‰ˆæœ¬ä¼š+1\n  - aclVersionï¼šæ­¤èŠ‚ç‚¹çš„æƒé™ç‰ˆæœ¬\n  - ephemeralOwnerï¼šå¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ä¸´æ—¶èŠ‚ç‚¹ï¼Œè¯¥æ˜¯æ˜¯å½“å‰èŠ‚ç‚¹æ‰€æœ‰è€…çš„session idã€‚å¦‚æœèŠ‚ç‚¹ä¸æ˜¯ä¸´æ—¶èŠ‚ç‚¹ï¼Œåˆ™è¯¥å€¼ä¸ºé›¶\n  - dataLengthï¼šèŠ‚ç‚¹å†…æ•°æ®çš„é•¿åº¦\n  - numChildrenï¼šè¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸ªæ•°\n\n- æŸ¥è¯¢èŠ‚ç‚¹çš„å†…å®¹\n\n  - get [-s] <path>\n\n    -s è¯¦ç»†ä¿¡æ¯\n\n### åˆ é™¤èŠ‚ç‚¹\n\n- delete [-v] <path> åˆ é™¤ç©ºèŠ‚ç‚¹\n  - -v ç‰ˆæœ¬\n\n- deleteall <path> [-b batch size] åˆ é™¤åŒ…æ‹¬éç©ºèŠ‚ç‚¹\n\n### æƒé™è®¾ç½®\n\n- æ³¨å†Œå½“å‰ä¼šè¯çš„è´¦å·å’Œå¯†ç ï¼š\n\n  ~~~pseudocode\n  addauth digest <è´¦å·>:<å¯†ç >\n  ~~~\n\n- åˆ›å»ºèŠ‚ç‚¹å¹¶è®¾ç½®æƒé™ï¼ˆæŒ‡å®šè¯¥èŠ‚ç‚¹çš„ç”¨æˆ·ï¼Œä»¥åŠç”¨æˆ·æ‰€æ‹¥æœ‰çš„æƒé™sï¼‰\n\n  ~~~ pseudocode\n  create /<node> <data> auth:<è´¦å·>:<å¯†ç >:<æƒé™>\n  ~~~\n\n  ä¾‹ï¼š`create /test-node abcd auth:xiaowang:123456:cdwra`\n\n- åœ¨å¦ä¸€ä¸ªä¼šè¯ä¸­å¿…é¡»å…ˆä½¿ç”¨è´¦å·å¯†ç ï¼Œæ‰èƒ½æ‹¥æœ‰æ“ä½œèŠ‚ç‚¹çš„æƒé™\n\n## ä½¿ç”¨Curatorå®¢æˆ·ç«¯\n\nCuratoræ˜¯Netflixå…¬å¸å¼€æºçš„ä¸€å¥—zookeeperå®¢æˆ·ç«¯æ¡†æ¶ï¼ŒCuratoræ˜¯å¯¹Zookeeperæ”¯æŒæœ€å¥½çš„å®¢æˆ·ç«¯æ¡†æ¶ã€‚Curatorå°è£…äº†å¤§éƒ¨åˆ†Zookeeperçš„åŠŸèƒ½ï¼Œæ¯”å¦‚Leaderé€‰ä¸¾ã€åˆ†å¸ƒå¼é”ç­‰ï¼Œå‡å°‘äº†æŠ€æœ¯äººå‘˜åœ¨ä½¿ç”¨Zookeeperæ—¶çš„åº•å±‚ç»†èŠ‚å¼€å‘å·¥ä½œã€‚\n\n**å¼•å…¥ä¾èµ–ï¼š**\n\n```xml\n<!-- https://mvnrepository.com/artifact/org.apache.zookeeper/zookeeper -->\n<dependency>\n    <groupId>org.apache.zookeeper</groupId>\n    <artifactId>zookeeper</artifactId>\n    <version>3.7.1</version>\n</dependency>\n        <!-- https://mvnrepository.com/artifact/org.apache.curator/curator-framework -->\n<dependency>\n    <groupId>org.apache.curator</groupId>\n    <artifactId>curator-framework</artifactId>\n    <version>5.4.0</version>\n</dependency>\n```\n\n**åˆ›å»ºCuratorProperties**\n\n```java\n@Data\n@Component\n@ConfigurationProperties(prefix = \"curator\")\npublic class CuratorProperties {\n\n    private int retryCount;\n\n    private int elapsedTimeMs;\n\n    private String connectionString;\n\n    private int sessionTimeoutMs;\n\n    private int connectionTimeoutMs;\n\n}\n```\n\n**åˆ›å»ºCuratorConfigé…ç½®ç±»**\n\n```java\n@Configuration\npublic class CuratorConfig {\n\n    @Resource\n    private CuratorProperties curatorProperties;\n    \n    @Bean\n    public CuratorFramework curatorFramework() {\n        CuratorFramework client = CuratorFrameworkFactory.builder()\n                .connectString(curatorProperties.getConnectionString())\n                .connectionTimeoutMs(curatorProperties.getConnectionTimeoutMs())\n                .sessionTimeoutMs(curatorProperties.getSessionTimeoutMs())\n                .retryPolicy(new RetryNTimes(curatorProperties.getRetryCount(), curatorProperties.getElapsedTimeMs()))\n                .build();\n        client.start();\n        return client;\n    }\n}\n```\n\n**é…ç½®application.yml**\n\n```yaml\ncurator:\n  connection-string: localhost:2181\n  retry-count: 5\n  session-timeout-ms: 60000\n  connection-timeout-ms: 4000\n  elapsed-time-ms: 5000\n```\n\n## åˆ†å¸ƒå¼é”\n\n### é”çš„ç§ç±»ï¼š\n\n- è¯»é”ï¼ˆè¯»é”å…±äº«ï¼‰ï¼šå¤§å®¶éƒ½å¯ä»¥è¯»ã€‚ä¸Šé”å‰æï¼šä¹‹å‰çš„é”æ²¡æœ‰å†™é”\n- å†™é”ï¼ˆå†™é”æ’ä»–ï¼‰ï¼šåªæœ‰å¾—åˆ°å†™é”çš„æ‰èƒ½å†™ã€‚ä¸Šé”å‰æï¼šä¹‹å‰æ²¡æœ‰ä»»ä½•é”\n\n### å¦‚ä½•ä¸Šè¯»é”\t\n\n- åˆ›å»ºä¸€ä¸ªä¸´æ—¶åºå·èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„æ•°æ®æ˜¯readï¼Œè¡¨ç¤ºæ˜¯è¯»é”\n\n- è·å–å½“å‰zkä¸­åºå·æ¯”è‡ªå·±å°çš„æ‰€æœ‰èŠ‚ç‚¹\n- åˆ¤æ–­æœ€å°èŠ‚ç‚¹æ˜¯å¦æ˜¯è¯»é”\n  - å¦‚æœä¸æ˜¯è¯»é”çš„è¯ï¼Œåˆ™ä¸Šé”å¤±è´¥ï¼Œä¸ºæœ€å°èŠ‚ç‚¹è®¾ç½®ç›‘å¬ã€‚é˜»å¡ç­‰å¾…ï¼Œzkçš„watchæœºåˆ¶ä¼šå½“æœ€å°èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥å½“å‰èŠ‚ç‚¹ï¼Œå†æ‰§è¡Œç¬¬äºŒæ­¥çš„æµç¨‹\n  - å¦‚æœæ˜¯è¯»é”çš„è¯ï¼Œåˆ™ä¸Šé”æˆåŠŸã€‚\n\n### å¦‚ä½•ä¸Šå†™é”\n\n- åˆ›å»ºä¸€ä¸ªä¸´æ—¶åºå·èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„æ•°æ®æ˜¯writeï¼Œè¡¨ç¤ºå†™é”\n- è·å–zkä¸­æ‰€æœ‰çš„å­èŠ‚ç‚¹\n- åˆ¤æ–­è‡ªå·±æ˜¯å¦æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼š\n  - å¦‚æœæ˜¯ï¼Œåˆ™ä¸Šå†™é”æˆåŠŸ\n  - å¦‚æœä¸æ˜¯ï¼Œè¯´æ˜å‰é¢è¿˜æœ‰é”ï¼Œåˆ™ä¸Šé”å¤±è´¥ï¼Œç›‘å¬æœ€å°èŠ‚ç‚¹ï¼Œå¦‚æœæœ€å°èŠ‚ç‚¹æœ‰å˜åŒ–ï¼Œåˆ™å†æ‰§è¡Œç¬¬äºŒæ­¥ã€‚\n\n### ç¾Šç¾¤æ•ˆåº”\n\nå¦‚æœç”¨ä¸Šè¿°çš„ä¸Šé”æ–¹å¼ï¼Œåªè¦æœ‰èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè§¦å‘å…¶ä»–èŠ‚ç‚¹çš„ç›‘å¬äº‹ä»¶ï¼Œè¿™æ ·å¯¹zkçš„å‹åŠ›éå¸¸å¤§ï¼Œè€Œç¾Šç¾¤æ•ˆåº”ï¼Œå¯ä»¥è°ƒæ•´æˆ**é“¾å¼ç›‘å¬**ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\n{% mermaid %}\ngraph LR\n\t/lock-node --> /read0001\n\t/lock-node --> /read0002\n\t/lock-node --> /read0003\n\t/lock-node --> /read0004\n\t\n\t/read0002 --ç›‘å¬-->/read0001\n\t/read0003 --ç›‘å¬-->/read0002\n\t/read0004 --ç›‘å¬-->/read0003\n{% endmermaid %}\n\n\n\n### Curatorå®ç°è¯»å†™é”\n\n- è·å–è¯»é”\n\n~~~ java\n@Test\nvoid testGetReadLock()throws Exception{\n    //è¯»å†™é”\n    InterProcessReadWriteLock interProcessReadWriteLock = new InterProcessReadWriteLock(client, \"/lock1\");\n    //è·å–è¯»é”å¯¹è±¡\n    InterProcessLock interProcessLock = interProcessReadWriteLock.readLock();\n    System.out.println(\"ç­‰å¾…è·å–è¯»é”å¯¹è±¡ä¸­...\");\n    //è·å–é”\n    interProcessLock.acquire();\n    for(int i = 1; i <= 100; i ++){\n        Thread.sleep(3000);\n        System.out.println(i);\n    }\n    //é‡Šæ”¾é”\n    interProcessLock.release();\n    System.out.println(\"ç­‰å¾…é‡Šæ”¾é”...\");\n}\n~~~\n\n- è·å–å†™é”\n\n~~~ java\n@Test\nvoid testGetWriteLock()throws Exception{\n    //è¯»å†™é”\n    InterProcessReadWriteLock interProcessReadWriteLock = new InterProcessReadWriteLock(client, \"/lock1\");\n    //è·å–å†™é”å¯¹è±¡\n    InterProcessLock interProcessLock = interProcessReadWriteLock.writeLock();\n    System.out.println(\"ç­‰å¾…è·å–å†™é”å¯¹è±¡ä¸­...\");\n    //è·å–é”\n    interProcessLock.acquire();\n    for(int i = 1; i <= 100; i ++){\n        Thread.sleep(3000);\n        System.out.println(i);\n    }\n    //é‡Šæ”¾é”\n    interProcessLock.release();\n    System.out.println(\"ç­‰å¾…é‡Šæ”¾é”...\");\n}\n~~~\n\n## watchæœºåˆ¶\n\n### ä»‹ç»\n\næˆ‘ä»¬å¯ä»¥æŠŠWatchç†è§£æˆæ˜¯æ³¨å†Œåœ¨ç‰¹å®šZnodeä¸Šçš„**è§¦å‘å™¨**ã€‚å½“è¿™ä¸ªZnodeå‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨äº†**create**ï¼Œ**delete**ï¼Œ**setData**æ–¹æ³•çš„æ—¶å€™ï¼Œå°†ä¼šè§¦å‘Znodeä¸Šæ³¨å†Œçš„å¯¹åº”äº‹ä»¶ï¼Œè¯·æ±‚Watchçš„å®¢æˆ·ç«¯ä¼šæ”¶åˆ°å¼‚æ­¥é€šçŸ¥ã€‚\n\nå…·ä½“äº¤äº’è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n- å®¢æˆ·ç«¯è°ƒç”¨getDataæ–¹æ³•ï¼Œwatchå‚æ•°æ˜¯trueã€‚æœåŠ¡ç«¯æ¥åˆ°è¯·æ±‚ï¼Œè¿”å›èŠ‚ç‚¹æ•°æ®ï¼Œå¹¶ä¸”åœ¨å¯¹åº”çš„å“ˆå¸Œè¡¨é‡Œæ’å…¥è¢«Watchçš„Znodeè·¯å¾„ï¼Œä»¥åŠWatcheråˆ—è¡¨ã€‚\n\n- å½“è¢«Watchçš„Znodeå·²åˆ é™¤ï¼ŒæœåŠ¡ç«¯ä¼šæŸ¥æ‰¾å“ˆå¸Œè¡¨ï¼Œæ‰¾åˆ°è¯¥Znodeå¯¹åº”çš„æ‰€æœ‰Watcherï¼Œå¼‚æ­¥é€šçŸ¥å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”åˆ é™¤å“ˆå¸Œè¡¨ä¸­å¯¹åº”çš„key-valueã€‚\n\n### zkCliå®¢æˆ·ç«¯ä½¿ç”¨Watch\n\n~~~ shell\ncreate /test date\nget -w /test\tä¸€æ¬¡æ€§ç›‘å¬èŠ‚ç‚¹\nls -w /test\t\tç›‘å¬ç›®å½•ï¼Œåˆ›å»ºå’Œåˆ é™¤å­èŠ‚ç‚¹ä¼šæ”¶åˆ°é€šçŸ¥ã€‚ä½†æ˜¯å­èŠ‚ç‚¹ä¸­æ–°å¢èŠ‚ç‚¹ä¸ä¼šè¢«ç›‘å¬åˆ°\nls -R -w /test\tç›‘å¬å­èŠ‚ç‚¹ä¸­èŠ‚ç‚¹çš„å˜åŒ–ï¼Œä½†å†…å®¹çš„å˜åŒ–ä¸ä¼šæ”¶åˆ°é€šçŸ¥\n~~~\n\n### Curatorå®¢æˆ·ç«¯ä½¿ç”¨Watch\n\n~~~ java\n@Test\npublic void addNodeListener() throws Exception{\n    NodeCache nodeCache = new NodeCache(curatorFramework,\"/curator-node\");\n    nodeCache.getListenable().addListener(new NodeCacheListener() {\n        @Override\n        public void nodeChanged() throws Exception{\n            log.info(\"{} path nodeChanged: \", \"/curator-node\");\n            printNodeData();\n        }\n    )};\n    nodeCache.start();\n    //System.in.read();\n}\n\npublic void printNodeData() throws Exception{\n    byte[] bytes = curatorFramework.getData().forPath(\"/curator-node\");\n    log.info(\"data: {}\", new String(bytes));\n}\n~~~\n\n## Zookeeperé›†ç¾¤\n\n### é›†ç¾¤è§’è‰²\n\nzookeeperé›†ç¾¤ä¸­çš„èŠ‚ç‚¹æœ‰ä¸‰ç§è§’è‰²\n\n- Leaderï¼šå¤„ç†é›†ç¾¤çš„æ‰€æœ‰äº‹åŠ¡è¯·æ±‚ï¼Œé›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ªLeader\n- Followerï¼šåªèƒ½å¤„ç†è¯»è¯·æ±‚ï¼Œå‚ä¸Leaderé€‰ä¸¾\n- Observerï¼šåªèƒ½å¤„ç†è¯»è¯·æ±‚ï¼Œæå‡é›†ç¾¤è¯»çš„æ€§èƒ½ï¼Œä½†ä¸èƒ½å‚ä¸Leaderé€‰ä¸¾\n\n{% mermaid %}\nflowchart LR\n\tc1[Client1] --> a\n\tc2[Client2] --> a\n\tc3[Client3] --> a\n\tsubgraph a[ ]\n\t\tLeader --> f1[Follower1]\n\t\tLeader --> f2[Follower2]\n\t\tLeader --> f3[Follower3]\n\t\tObserver\n\tend\n{% endmermaid %}\n\n### é›†ç¾¤æ­å»º\n\nä»¥æ­å»º4ä¸ªèŠ‚ç‚¹ä¸ºä¾‹ï¼Œæ­å»ºä¼ªé›†ç¾¤ï¼Œå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä¸ºObserver\n\n- åˆ›å»º4ä¸ªèŠ‚ç‚¹çš„myidå¹¶è®¾å€¼\n\n  åœ¨ZKçš„æ•°æ®å‚¨å­˜ç›®å½•/tmp/zookeeperä¸­åˆ›å»ºä»¥ä¸‹å››ä¸ªæ–‡ä»¶\n\n  ~~~ shell\n  /tmp/zookeeper/zk1# echo 1 > myid\n  /tmp/zookeeper/zk2# echo 2 > myid\n  /tmp/zookeeper/zk3# echo 3 > myid\n  /tmp/zookeeper/zk4# echo 4 > myid\n  ~~~\n\n- ç¼–å†™4ä¸ªzoo.cfgå¹¶ä¿®æ”¹ä»¥ä¸‹é€‰é¡¹\n\n  ~~~ properties\n  dataDir=/tmp/zookeeper/zk1\n  clientPort=2181\n  \n  #2001ä¸ºé›†ç¾¤é€šä¿¡ç«¯å£ï¼Œ3001ä¸ºé›†ç¾¤é€‰ä¸¾ç«¯å£ï¼Œobserverï¼ˆè§‚å¯Ÿè€…èº«ä»½ï¼‰\n  server.1=192.168.245.128:2001:3001\n  server.2=192.168.245.128:2002:3002\n  server.3=192.168.245.128:2003:3003\n  server.4=192.168.245.128:2004:3004:observer\n  ~~~\n\n- ä¾æ¬¡å¯åŠ¨Zookeeper\n\n  ```shell\n  ./zkServer.sh start ../conf/zoo1.cfg\n  ./zkServer.sh start ../conf/zoo2.cfg\n  ./zkServer.sh start ../conf/zoo3.cfg\n  ./zkServer.sh start ../conf/zoo4.cfg\n  ```\n\n- è¿æ¥é›†ç¾¤  \n\n  ~~~ shell\n  ./zkCli.sh -server 192.168.245.128:2181,192.168.245.128:2182,192.168.245.128:2183\n  ~~~\n\n## ZABåè®®\n\n### ç®€ä»‹\n\nZookeeperä½œä¸ºéå¸¸é‡è¦çš„åˆ†å¸ƒå¼åè°ƒç»„ä»¶ï¼Œéœ€è¦è¿›è¡Œé›†ç¾¤éƒ¨ç½²ï¼Œé›†ç¾¤ä¸­ä¼šä»¥ä¸€ä¸»å¤šä»çš„å½¢å¼è¿›è¡Œéƒ¨ç½²ã€‚zookeeperä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä½¿ç”¨äº†ZABï¼ˆZookeeper Atomic Broadcastï¼‰åè®®ï¼Œè¿™ä¸ªåè®®è§£å†³äº†Zookeeperçš„å´©æºƒæ¢å¤å’Œä¸»ä»æ•°æ®åŒæ­¥çš„é—®é¢˜ã€‚\n\n### é›†ç¾¤é€‰ä¸¾Leaderçš„è¿‡ç¨‹\n\n**é›†ç¾¤èŠ‚ç‚¹çš„çŠ¶æ€ï¼š**\n\n- Lookingï¼šé€‰ä¸¾çŠ¶æ€\n- Followingï¼šFollowerèŠ‚ç‚¹ï¼ˆä»èŠ‚ç‚¹ï¼‰æ‰€å¤„çš„çŠ¶æ€\n- Leadingï¼šLeaderèŠ‚ç‚¹ï¼ˆä¸»èŠ‚ç‚¹ï¼‰æ‰€å¤„çŠ¶æ€\n\n![leaderé€‰ä¸¾è¿‡ç¨‹](https://gitee.com/Wshape1/share-file/raw/master/blog/zookeeper/leader_looking.png)\n\n### å´©æºƒæ¢å¤æ—¶çš„Leaderé€‰ä¸¾\n\nLeaderå»ºç«‹å®Œåï¼ŒLeaderå‘¨æœŸæ€§åœ°ä¸æ–­å‘Followerå‘é€å¿ƒè·³ï¼ˆpingå‘½ä»¤ï¼Œæ²¡æœ‰å†…å®¹çš„socketï¼‰ã€‚å½“Leaderå´©æºƒåï¼ŒFollowerå‘ç°socketé€šé“å·²å…³é—­ï¼Œäºæ˜¯Followerå¼€å§‹è¿›å…¥åˆ°LookingçŠ¶æ€ï¼Œé‡æ–°å›åˆ°ä¸Šä¸€èŠ‚ä¸­çš„Leaderé€‰ä¸¾çŠ¶æ€ï¼Œæ­¤æ—¶é›†ç¾¤ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ã€‚\n\n### ä¸»ä»æœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®åŒæ­¥\n\n![ä¸»ä»å¤åˆ¶](https://gitee.com/Wshape1/share-file/raw/master/blog/zookeeper/lf_copy.png)\n\n### Zookeeperä¸­çš„NIOä¸BIOçš„åº”ç”¨\n\n- NIO\n  - ç”¨äºè¢«å®¢æˆ·ç«¯è¿æ¥çš„2181ç«¯å£ï¼Œä½¿ç”¨çš„æ˜¯NIOæ¨¡å¼ä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥\n  - å®¢æˆ·ç«¯å¼€å¯Watchæ—¶ï¼Œä¹Ÿä½¿ç”¨NIOï¼Œç­‰å¾…ZookeeperæœåŠ¡å™¨çš„å›è°ƒ\n- BIO\n  - é›†ç¾¤åœ¨é€‰ä¸¾æ—¶ï¼Œå¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æŠ•ç¥¨é€šä¿¡ç«¯å£ï¼Œä½¿ç”¨BIOè¿›è¡Œé€šä¿¡\n\n## CAPç†è®º\n\n### CAPç†è®º\n\nCAPç†è®ºä¸ºï¼šä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰å’ŒåŒºåˆ†å®¹é”™æ€§ï¼ˆPartition toleranceï¼‰è¿™ä¸‰é¡¹ä¸­çš„ä¸¤é¡¹ã€‚\n\n- **â€”è‡´æ€§(Consistency)**\n\nä¸€è‡´æ€§æŒ‡\"all nodespsee the same data at the same time\"ï¼Œå³æ›´æ–°æ“ä½œæˆåŠŸå¹¶è¿”å›å®¢æˆ·ç«¯å®Œæˆåï¼Œæ‰€æœ‰èŠ‚ç‚¹åœ¨åŒä¸€æ—¶é—´çš„æ•°æ®å®Œå…¨ä¸€è‡´ã€‚\n\n- **å¯ç”¨æ€§(Availability)**\n\nå¯ç”¨æ€§æŒ‡\"Reads and writes always succeed\"ï¼Œå³æœåŠ¡ä¸€ç›´å¯ç”¨ï¼Œè€Œä¸”æ˜¯æ­£å¸¸å“åº”æ—¶é—´ã€‚\n\n- **åˆ†åŒºå®¹é”™æ€§(Partition tolerance)**\n\nåˆ†åŒºå®¹é”™æ€§æŒ‡\"the system continues to operate despite arbitrary message loss or failure of part of the system\"ï¼Œå³åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é‡åˆ°æŸèŠ‚ç‚¹æˆ–ç½‘ç»œåˆ†åŒºæ•…éšœçš„æ—¶å€™ï¼Œä»ç„¶èƒ½å¤Ÿå¯¹å¤–æä¾›æ»¡è¶³ä¸€è‡´æ€§æˆ–å¯ç”¨æ€§çš„æœåŠ¡ã€‚â€”â€”é¿å…å•ç‚¹æ•…éšœï¼Œå°±è¦è¿›è¡Œå†—ä½™éƒ¨ç½²ï¼Œå†—ä½™éƒ¨ç½²ç›¸å½“äºæ˜¯æœåŠ¡çš„åˆ†åŒºï¼Œè¿™æ ·çš„åˆ†åŒºå°±å…·å¤‡äº†å®¹é”™æ€§ã€‚\n\n### BASEç†è®º\n\næ ¸å¿ƒæ€æƒ³æ˜¯å³ä½¿æ— æ³•åšåˆ°å¼ºä¸€è‡´æ€§(Strong Consistencyï¼ŒCAPçš„ä¸€è‡´æ€§å°±æ˜¯å¼ºä¸€è‡´æ€§)ï¼Œä½†åº”ç”¨å¯ä»¥é‡‡ç”¨é€‚åˆçš„æ–¹å¼è¾¾åˆ°æœ€ç»ˆä¸€è‡´æ€§(Eventual Consitency) ã€‚\n\n- **åŸºæœ¬å¯ç”¨(Basically Available)**\n\nåŸºæœ¬å¯ç”¨æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œå…è®¸æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§ï¼Œå³ä¿è¯æ ¸å¿ƒå¯ç”¨ã€‚\n\nç”µå•†å¤§ä¿ƒæ—¶ï¼Œä¸ºäº†åº”å¯¹è®¿é—®é‡æ¿€å¢ï¼Œéƒ¨åˆ†ç”¨æˆ·å¯èƒ½ä¼šè¢«å¼•å¯¼åˆ°é™çº§é¡µé¢ï¼ŒæœåŠ¡å±‚ä¹Ÿå¯èƒ½åªæä¾›é™çº§æœåŠ¡ã€‚è¿™å°±æ˜¯æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§çš„ä½“ç°ã€‚\n\n- **è½¯çŠ¶æ€(Soft State)**\n\nè½¯çŠ¶æ€æ˜¯æŒ‡å…è®¸ç³»ç»Ÿå­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œè€Œè¯¥ä¸­é—´çŠ¶æ€ä¸ä¼šå½±å“ç³»ç»Ÿæ•´ä½“å¯ç”¨æ€§ã€‚åˆ†å¸ƒå¼å­˜å‚¨ä¸­ä¸€èˆ¬ä¸€ä»½æ•°æ®è‡³å°‘ä¼šæœ‰ä¸‰ä¸ªå‰¯æœ¬ï¼Œå…è®¸ä¸åŒèŠ‚ç‚¹é—´å‰¯æœ¬åŒæ­¥çš„å»¶æ—¶å°±æ˜¯è½¯çŠ¶æ€çš„ä½“ç°ã€‚mysql replicationçš„å¼‚æ­¥å¤åˆ¶ä¹Ÿæ˜¯ä¸€ç§ä½“ç°ã€‚\n\n- **æœ€ç»ˆä¸€è‡´æ€§(Eventual Consistency)**\n\næœ€ç»ˆä¸€è‡´æ€§æ˜¯æŒ‡ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®å‰¯æœ¬ç»è¿‡ä¸€å®šæ—¶é—´åï¼Œæœ€ç»ˆèƒ½å¤Ÿè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚å¼±ä¸€è‡´æ€§å’Œå¼ºä¸€è‡´æ€§ç›¸åï¼Œæœ€ç»ˆä¸€è‡´æ€§æ˜¯å¼±ä¸€è‡´æ€§çš„â€”ç§ç‰¹æ®Šæƒ…å†µã€‚\n\n### Zookeeperè¿½æ±‚çš„ä¸€è‡´æ€§\n\nZookeeperåœ¨æ•°æ®åŒæ­¥æ—¶ï¼Œè¿½æ±‚çš„å¹¶ä¸æ˜¯å¼ºä¸€è‡´æ€§ï¼Œè€Œæ˜¯é¡ºåºä¸€è‡´æ€§ï¼ˆäº‹åŠ¡idçš„å•è°ƒé€’å¢ï¼‰\n","tags":["ç¬”è®°","Zookeeper"],"categories":["å¾®æœåŠ¡ç”Ÿæ€"]},{"title":"Rediså­¦ä¹ ç¬”è®°","url":"/2023/01/30/redis-note/","content":"\n# Redis\n\nå­¦ä¹ [ã€å°šç¡…è°·ã€‘Redis 6 å…¥é—¨åˆ°ç²¾é€š è¶…è¯¦ç»† æ•™ç¨‹](https://www.bilibili.com/video/BV1Rv41177Af \"å°šç¡…è°·-Bilibili\") ï¼Œ\n\nè®°å½•ç¬”è®°ã€‚\n\n## ç®€ä»‹\n\n- Redisæ˜¯ä¸€ä¸ªå¼€æºçš„key-valueå­˜å‚¨ç³»ç»Ÿã€‚\n\n- å’ŒMemcachedç±»ä¼¼ï¼Œå®ƒæ”¯æŒå­˜å‚¨çš„valueç±»å‹ç›¸å¯¹æ›´å¤šï¼ŒåŒ…æ‹¬string(å­—ç¬¦ä¸²)ã€list(é“¾è¡¨)ã€set(é›†åˆ)ã€zset(sorted set --æœ‰åºé›†åˆ)å’Œhashï¼ˆå“ˆå¸Œç±»å‹ï¼‰ã€‚\n\n- è¿™äº›æ•°æ®ç±»å‹éƒ½æ”¯æŒpush/popã€add/removeåŠå–äº¤é›†å¹¶é›†å’Œå·®é›†åŠæ›´ä¸°å¯Œçš„æ“ä½œï¼Œè€Œä¸”è¿™äº›æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚\n\n- åœ¨æ­¤åŸºç¡€ä¸Šï¼ŒRedisæ”¯æŒå„ç§ä¸åŒæ–¹å¼çš„æ’åºã€‚\n\n- ä¸memcachedä¸€æ ·ï¼Œä¸ºäº†ä¿è¯æ•ˆç‡ï¼Œæ•°æ®éƒ½æ˜¯ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚\n\n- åŒºåˆ«çš„æ˜¯Redisä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ã€‚\n\n- å¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº†master-slave(ä¸»ä»)åŒæ­¥ã€‚\n\n## å®‰è£…Redis\n\n[Download | Redis](https://redis.io/download/)\n\n**å·²Redis6.2.10ä¸ºä¾‹**\n\n- **æ£€æŸ¥gccç¯å¢ƒ**`gcc --version`\n  - å®‰è£…gccï¼š`yum install gcc`\n\n**å®‰è£…æ­¥éª¤ï¼š**\n\n1. ä¸‹è½½`redis-6.2.10.tar.gz`åˆ°/opt ï¼ˆå…¶å®ƒç›®å½•ä¹Ÿè¡Œï¼‰\n2. æ‰§è¡Œ`tar -zxvf redis-6.2.10.tar.gz`è§£å‹\n3. è¿›å…¥redis-6.2.10/  `cd redis-6.2.10/`\n4. æ‰§è¡Œç¼–è¯‘ `make`\n   - è‹¥å‡ºç°é”™è¯¯ï¼š`make distclean` æ¸…é™¤ç¼–è¯‘ç»“æœ\n   - å†æ¬¡æ‰§è¡Œ `make`\n5. æ‰§è¡Œå®‰è£… `make install` ï¼Œé»˜è®¤å®‰è£…åœ¨/usr/local/bin/\n   - ä½¿ç”¨`make install PREFIX=/usr/local/redis` æŒ‡å®šå®‰è£…ç›®å½•åˆ°/usr/local/redis\n\n**æŸ¥çœ‹é»˜è®¤å®‰è£…ç›®å½•:**\n\n- redis-benchmark:æ€§èƒ½æµ‹è¯•å·¥å…·,å¯ä»¥åœ¨è‡ªå·±æœ¬å­è¿è¡Œ,çœ‹çœ‹è‡ªå·±æœ¬å­æ€§èƒ½å¦‚ä½•\n- redis-check-aof :ä¿®å¤æœ‰é—®é¢˜çš„ AOF æ–‡ä»¶\n- redis-check-dump:ä¿®å¤æœ‰é—®é¢˜çš„ dump.rdb æ–‡ä»¶\n- redis-sentinel : Redis é›†ç¾¤ä½¿ç”¨\n- **redis-server** : RedisæœåŠ¡å™¨å¯åŠ¨å‘½ä»¤\n- **redis-cli**: å®¢æˆ·ç«¯ï¼Œæ“ä½œå…¥å£\n\n**å‰å°å¯åŠ¨ï¼š**`redis-server`\n\n**åå°å¯åŠ¨ï¼š**\n\n- å¤åˆ¶redis.confåˆ°/etc/ ï¼š`cp /opt/redis-6.2.10/redis.conf /etc/`\n- ç¼–è¾‘/etc/redis.conf `vim /etc/redis.conf`\n  - ä¿®æ”¹`daemonize no`ä¸º`daemonize yes`\n- æ‰§è¡Œ`redis-server /etc/redis.conf`å¯åŠ¨Redis\n- `redis-cli` è¿›å…¥Redisåå°ï¼Œè¾“å…¥`ping`æµ‹è¯•å¯åŠ¨çŠ¶æ€\n\n**ä½¿ç”¨Screençª—å£è¿›è¡Œåå°è¿è¡Œï¼š**\n\n- å®‰è£…Screenï¼š`yum install screen`\n- åˆ›å»ºæˆ–è¿›å…¥ä¸€ä¸ªscreenï¼š`screen -R <åç§°>`\n- è¿›å…¥Screenåæ‰§è¡Œ`redis-server`\n- `Ctrl + A + D`é€€å‡ºscreen\n\n## äº”å¤§å¸¸ç”¨æ•°æ®ç±»å‹\n\n### Redisé”®\n\n**â€œé”®å€¼å¯¹â€**\n\n\n\n`keys *`æŸ¥çœ‹å½“å‰åº“æ‰€æœ‰key  (åŒ¹é…ï¼škeys *1)\n\n`exists <key>`åˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨\n\n`type <key>` æŸ¥çœ‹ä½ çš„keyæ˜¯ä»€ä¹ˆç±»å‹\n\n`del <key>`    åˆ é™¤æŒ‡å®šçš„keyæ•°æ®\n\n`unlink <key>`  æ ¹æ®valueé€‰æ‹©éé˜»å¡åˆ é™¤ï¼Œä»…å°†keysä»keyspaceå…ƒæ•°æ®ä¸­åˆ é™¤ï¼ŒçœŸæ­£çš„åˆ é™¤ä¼šåœ¨åç»­å¼‚æ­¥æ“ä½œã€‚\n\n`expire <key> <s>`  ä¸ºç»™å®šçš„keyè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆå•ä½ç§’ï¼‰\n\n`ttl <key>` æŸ¥çœ‹è¿˜æœ‰å¤šå°‘ç§’è¿‡æœŸï¼Œ-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œ-2è¡¨ç¤ºå·²è¿‡æœŸ\n\n \n\n`select <db>` å‘½ä»¤åˆ‡æ¢æ•°æ®åº“\n\n- é»˜è®¤16ä¸ªæ•°æ®åº“ï¼Œç±»ä¼¼æ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹ï¼Œåˆå§‹é»˜è®¤ä½¿ç”¨0å·åº“\n\n`dbsize` æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„keyçš„æ•°é‡\n\n`flushdb` æ¸…ç©ºå½“å‰åº“\n\n`flushall` é€šæ€å…¨éƒ¨åº“\n\n### Rediså­—ç¬¦ä¸²\n\n#### ç®€ä»‹\n\n- Stringç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚æ„å‘³ç€Redisçš„stringå¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ã€‚æ¯”å¦‚jpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡ã€‚\n\n- Stringç±»å‹æ˜¯Redisæœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¸€ä¸ªRedisä¸­å­—ç¬¦ä¸²valueæœ€å¤šå¯ä»¥æ˜¯512M\n\n#### å¸¸ç”¨å‘½ä»¤\n\n`set <key> <value>`æ·»åŠ é”®å€¼å¯¹\n\n- `setnx` å½“æ•°æ®åº“ä¸­keyä¸å­˜åœ¨æ—¶ï¼Œå¯ä»¥å°†key-valueæ·»åŠ æ•°æ®åº“\n- `setxx` å½“æ•°æ®åº“ä¸­keyå­˜åœ¨æ—¶ï¼Œå¯ä»¥å°†key-valueæ·»åŠ æ•°æ®åº“ï¼Œä¸NXå‚æ•°äº’æ–¥\n- `setex` keyçš„è¶…æ—¶ç§’æ•°\n- `setpx` keyçš„è¶…æ—¶æ¯«ç§’æ•°ï¼Œä¸EXäº’æ–¥\n\n`get  <key>`æŸ¥è¯¢å¯¹åº”é”®å€¼\n\n`append <key> <value>` å°†ç»™å®šçš„<value> è¿½åŠ åˆ°åŸå€¼çš„æœ«å°¾\n\n`strlen <key>` è·å¾—å€¼çš„é•¿åº¦\n\n\n\n**ä»¥ä¸‹å‘½ä»¤æ˜¯å…·æœ‰åŸå­æ€§çš„ï¼š**\n\n- `incr <key>` å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢1ï¼Œåªèƒ½å¯¹æ•°å­—å€¼æ“ä½œï¼Œå¦‚æœä¸ºç©ºï¼Œæ–°å¢å€¼ä¸º1\n\n- `decr <key>` å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡1ï¼Œåªèƒ½å¯¹æ•°å­—å€¼æ“ä½œï¼Œå¦‚æœä¸ºç©ºï¼Œæ–°å¢å€¼ä¸º-1\n\n- `incrby / decrby <key> <æ­¥é•¿>` å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢å‡ã€‚è‡ªå®šä¹‰æ­¥é•¿ã€‚\n\n- `mset <key1><value1><key2><value2> ...`åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-valueå¯¹ \n\n- `mget <key1><key2><key3> ...`åŒæ—¶è·å–ä¸€ä¸ªæˆ–å¤šä¸ª value \n\n- `msetnx <key1><value1><key2><value2> ...`åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰ç»™å®š key éƒ½ä¸å­˜åœ¨ã€‚\n\n`getrange <key> <èµ·å§‹ä½ç½®> <ç»“æŸä½ç½®>`è·å¾—å€¼çš„èŒƒå›´ï¼Œç±»ä¼¼javaä¸­çš„substringï¼Œ**å‰åŒ…ï¼ŒååŒ…**\n\n`setrange <key> <èµ·å§‹ä½ç½®> <value>` ç”¨ <value> è¦†å†™<key>æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œä»<èµ·å§‹ä½ç½®>å¼€å§‹(**ç´¢å¼•ä»0å¼€å§‹**)ã€‚\n\n`setex <key> <è¿‡æœŸæ—¶é—´> <value>` è®¾ç½®é”®å€¼çš„åŒæ—¶ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå•ä½ç§’ã€‚\n\n`getset <key> <value>` ä»¥æ–°æ¢æ—§ï¼Œè®¾ç½®äº†æ–°å€¼åŒæ—¶è·å¾—æ—§å€¼ã€‚\n\n#### æ•°æ®ç»“æ„\n\nâ€‹\tStringçš„æ•°æ®ç»“æ„ä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸²(Simple Dynamic String,ç¼©å†™SDS)ã€‚æ˜¯å¯ä»¥ä¿®æ”¹çš„å­—ç¬¦ä¸²ï¼Œ**å†…éƒ¨ç»“æ„å®ç°ä¸Šç±»ä¼¼äºJavaçš„ArrayList**ï¼Œé‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼æ¥å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é….\n\nâ€‹\tå†…éƒ¨ä¸ºå½“å‰å­—ç¬¦ä¸²å®é™…åˆ†é…çš„ç©ºé—´capacityä¸€èˆ¬è¦é«˜äºå®é™…å­—ç¬¦ä¸²é•¿åº¦lenã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å°äº1Mæ—¶ï¼Œæ‰©å®¹éƒ½æ˜¯åŠ å€ç°æœ‰çš„ç©ºé—´ï¼Œå¦‚æœè¶…è¿‡1Mï¼Œæ‰©å®¹æ—¶ä¸€æ¬¡åªä¼šå¤šæ‰©1Mçš„ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ä¸º512Mã€‚\n\n### Redisåˆ—è¡¨\n\n#### ç®€ä»‹\n\n**â€œå•é”®å¤šå€¼â€**\n\nå®ƒçš„åº•å±‚å®é™…æ˜¯ä¸ª**åŒå‘é“¾è¡¨**ï¼Œå¯¹ä¸¤ç«¯çš„æ“ä½œæ€§èƒ½å¾ˆé«˜ï¼Œé€šè¿‡ç´¢å¼•ä¸‹æ ‡çš„æ“ä½œä¸­é—´çš„èŠ‚ç‚¹æ€§èƒ½ä¼šè¾ƒå·®ã€‚\n\nå¯ä»¥è¿›è¡Œâ€œå¤´æ’â€æˆ–â€œå°¾æ’â€ã€‚\n\n{% mermaid %}\ngraph LR\n \tv1 --> v2 --> v1\n \tv2 --> v3 --> v2\n \tv3 --> v4 --> v3\n \tv4 --> v5 --> v4\n{% endmermaid %}\n\n#### å¸¸ç”¨å‘½ä»¤\n\n`lpush/rpush <key><value1><value2><value3> ....` ä»å·¦è¾¹/å³è¾¹æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ã€‚\n\n`lpop/rpop <key>` ä»å·¦è¾¹/å³è¾¹åå‡ºä¸€ä¸ªå€¼ã€‚æœ‰å€¼æ‰æœ‰é”®ã€‚\n\n \n\n`rpoplpush <key1> <key2>` ä»<key1> åˆ—è¡¨å³è¾¹åå‡ºä¸€ä¸ªå€¼ï¼Œæ’åˆ°<key2>åˆ—è¡¨å·¦è¾¹ã€‚\n\n \n\n`lrange <key> <start> <stop>` æŒ‰ç…§ç´¢å¼•ä¸‹æ ‡è·å¾—å…ƒç´ (ä»å·¦åˆ°å³)\n\n- `lrange <key> 0 -1`æŸ¥çœ‹listçš„å…¨éƒ¨å€¼\n\n`lindex <key> <index>`æŒ‰ç…§ç´¢å¼•ä¸‹æ ‡è·å¾—å…ƒç´ (ä»å·¦åˆ°å³)\n\n`llen <key>` è·å¾—åˆ—è¡¨é•¿åº¦ \n\n \n\n`linsert <key> before <value> <newvalue>`åœ¨<value>çš„åé¢æ’å…¥<newvalue>æ’å…¥å€¼\n\n`lrem <key> <n> <value>`ä»å·¦è¾¹åˆ é™¤nä¸ªvalue(ä»å·¦åˆ°å³)\n\n`lset <key> <index> <value>` å°†åˆ—è¡¨keyä¸‹æ ‡ä¸ºindexçš„å€¼æ›¿æ¢æˆvalue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \n\n#### æ•°æ®ç»“æ„\n\n**â€å¿«é€Ÿé“¾è¡¨quickListâ€œ**\n\né¦–å…ˆåœ¨åˆ—è¡¨**å…ƒç´ è¾ƒå°‘**çš„æƒ…å†µä¸‹ä¼šä½¿ç”¨ä¸€å—è¿ç»­çš„å†…å­˜å­˜å‚¨ï¼Œè¿™ä¸ªç»“æ„æ˜¯**ziplist**ï¼Œä¹Ÿå³æ˜¯å‹ç¼©åˆ—è¡¨ã€‚å®ƒå°†æ‰€æœ‰çš„å…ƒç´ ç´§æŒ¨ç€ä¸€èµ·å­˜å‚¨ï¼Œåˆ†é…çš„æ˜¯ä¸€å—è¿ç»­çš„å†…å­˜ã€‚\n\nå½“æ•°æ®é‡æ¯”è¾ƒå¤šçš„æ—¶å€™æ‰ä¼šæ”¹æˆquicklistã€‚\n\nå› ä¸ºæ™®é€šçš„é“¾è¡¨éœ€è¦çš„**é™„åŠ æŒ‡é’ˆç©ºé—´å¤ªå¤§**ï¼Œä¼šæ¯”è¾ƒæµªè´¹ç©ºé—´ã€‚æ¯”å¦‚ä¸€ä¸ªåˆ—è¡¨é‡Œå­˜çš„åªæ˜¯intç±»å‹çš„æ•°æ®ï¼Œç»“æ„ä¸Šè¿˜éœ€è¦ä¸¤ä¸ªé¢å¤–çš„æŒ‡é’ˆprevå’Œnextã€‚\n\n{% mermaid %}\ngraph LR\n \tv1[zipList] --> v2[zipList] --> v1\n \tv2 --> v3[zipList] --> v2\n \tv3 --> v4[zipList] --> v3\n \tv4 --> v5[zipList] --> v4\n{% endmermaid %}\n\nRediså°†é“¾è¡¨å’Œziplistç»“åˆèµ·æ¥ç»„æˆäº†quicklistã€‚ä¹Ÿå°±æ˜¯å°†å¤šä¸ªziplistä½¿ç”¨åŒå‘æŒ‡é’ˆä¸²èµ·æ¥ä½¿ç”¨ã€‚è¿™æ ·æ—¢æ»¡è¶³äº†å¿«é€Ÿçš„æ’å…¥åˆ é™¤æ€§èƒ½ï¼Œåˆä¸ä¼šå‡ºç°å¤ªå¤§çš„ç©ºé—´å†—ä½™ã€‚\n\n### Redisé›†åˆ\n\n#### ç®€ä»‹\n\nRedis setå¯¹å¤–æä¾›çš„åŠŸèƒ½ä¸listç±»ä¼¼æ˜¯ä¸€ä¸ªåˆ—è¡¨çš„åŠŸèƒ½ï¼Œç‰¹æ®Šä¹‹å¤„åœ¨äºsetæ˜¯å¯ä»¥**è‡ªåŠ¨æ’é‡**çš„ã€‚\n\nRedisçš„Setæ˜¯stringç±»å‹çš„**æ— åºé›†åˆ**ã€‚å®ƒåº•å±‚å…¶å®æ˜¯ä¸€ä¸ªvalueä¸ºnullçš„hashè¡¨ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„**å¤æ‚åº¦éƒ½æ˜¯O(1)**ã€‚\n\n#### å¸¸ç”¨å‘½ä»¤\n\n- `sadd <key> <value1> <value2> ... ` æ·»åŠ ä¸€æˆ–å¤šä¸ªå€¼åˆ°é›†åˆä¸­ï¼Œå¹¶å¿½ç•¥å·²å­˜åœ¨çš„å€¼\n\n- ``smembers <key>` å–å‡ºè¯¥é›†åˆçš„æ‰€æœ‰å€¼ã€‚\n\n- `sismember <key> <value>` åˆ¤æ–­é›†åˆæ˜¯å¦å«æœ‰æŸä¸ªå€¼ï¼Œæ˜¯1ï¼Œå¦0\n\n- `scard <key>` è¿”å›è¯¥é›†åˆçš„å…ƒç´ ä¸ªæ•°ã€‚\n\n- `srem <key> <value1> <value2> ...` åˆ é™¤é›†åˆä¸­çš„æŸä¸ªå…ƒç´ ã€‚\n\n- `spop <key>`éšæœºä»è¯¥é›†åˆä¸­åå‡ºä¸€ä¸ªå€¼ã€‚\n\n- `srandmember <key> <n>`éšæœºä»è¯¥é›†åˆä¸­å–å‡ºnä¸ªå€¼ã€‚ä¸ä¼šä»é›†åˆä¸­åˆ é™¤ ã€‚\n\n- `smove <source> <dest> <value>` ç§»åŠ¨é›†åˆä¸­çš„æŸä¸ªå€¼åˆ°å¦ä¸€ä¸ªé›†åˆ\n\n- `sinter <key1> <key2>` è¿”å›ä¸¤ä¸ªé›†åˆçš„äº¤é›†å…ƒç´ ã€‚\n\n- `sunion <key1> <key2>`è¿”å›ä¸¤ä¸ªé›†åˆçš„å¹¶é›†å…ƒç´ ã€‚\n\n- `sdiff <key1> <key2>` è¿”å›ä¸¤ä¸ªé›†åˆçš„**å·®é›†**å…ƒç´ (key1ä¸­çš„ï¼Œä¸åŒ…å«key2ä¸­çš„)\n\n#### æ•°æ®ç»“æ„\n\nSetæ•°æ®ç»“æ„æ˜¯**dictå­—å…¸**ï¼Œå­—å…¸æ˜¯ç”¨å“ˆå¸Œè¡¨å®ç°çš„ã€‚\n\nJavaä¸­HashSetçš„å†…éƒ¨å®ç°ä½¿ç”¨çš„æ˜¯HashMapï¼Œåªä¸è¿‡æ‰€æœ‰çš„valueéƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚Redisçš„setç»“æ„ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå®ƒçš„å†…éƒ¨ä¹Ÿä½¿ç”¨hashç»“æ„ï¼Œæ‰€æœ‰çš„valueéƒ½æŒ‡å‘åŒä¸€ä¸ªå†…éƒ¨å€¼ã€‚\n\n### Rediså“ˆå¸Œ\n\n#### ç®€ä»‹\n\nRedis hash æ˜¯ä¸€ä¸ª**é”®å€¼å¯¹é›†åˆ**ã€‚\n\nRedis hashæ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚\n\nç±»ä¼¼Javaé‡Œé¢çš„**Map<String,Object>**\n\n{% mermaid %}\nflowchart LR\n\tkey ==> sg\n\tsubgraph sg[ ]\n\t\t field1 --> value1\n\t\t field2 --> value2\n\t\t field3 --> value3\n\tend\n{% endmermaid %}\n\n#### å¸¸ç”¨å‘½ä»¤\n\n-  `hset <key> <field> <value>` ç»™<key>é›†åˆä¸­çš„ <field>é”®èµ‹å€¼<value>\n\n- `hget <key1> <field>` ä»<key1>é›†åˆ<field>å–å‡º value \n\n- `hmset <key1> <field1> <value1> <field2> <value2>...` æ‰¹é‡è®¾ç½®å€¼\n\n- `hexists <key> <field>`æŸ¥çœ‹å“ˆå¸Œè¡¨ä¸­ï¼Œç»™å®šåŸŸ field æ˜¯å¦å­˜åœ¨ã€‚ \n\n- `hkeys <key>`åˆ—å‡ºè¯¥hashé›†åˆçš„æ‰€æœ‰field\n\n- `hvals <key>` åˆ—å‡ºè¯¥hashé›†åˆçš„æ‰€æœ‰value\n\n- `hincrby <key> <field> <incr>`ä¸ºå“ˆå¸Œè¡¨ä¸­çš„åŸŸçš„å€¼åŠ ä¸Šå¢é‡1ï¼ˆå¯ä»¥æ˜¯è´Ÿæ•°ï¼‰\n\n- `hsetnx <key> <field> <value>`å°†å“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼è®¾ç½®ä¸º value ï¼Œå½“ä¸”ä»…å½“åŸŸ field ä¸å­˜åœ¨ \n\n#### æ•°æ®ç»“æ„\n\nHashç±»å‹å¯¹åº”çš„æ•°æ®ç»“æ„æ˜¯ä¸¤ç§ï¼šziplistï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰ï¼Œhashtableï¼ˆå“ˆå¸Œè¡¨ï¼‰ã€‚å½“field-valueé•¿åº¦è¾ƒçŸ­ä¸”ä¸ªæ•°è¾ƒå°‘æ—¶ï¼Œä½¿ç”¨zipListï¼Œå¦åˆ™ä½¿ç”¨hashTableã€‚\n\n### Redisæœ‰åºé›†åˆZset(Sorted Set)\n\n#### ç®€ä»‹\n\nZsetæ‹¥æœ‰Setçš„ç‰¹æ€§ã€‚\n\nZsetæ˜¯æœ‰åºé›†åˆï¼Œæ¯ä¸ªå…ƒç´ å…³è”ä¸€ä¸ª**â€åˆ†æ•°(score)â€œ**ï¼ˆåˆ†æ•°å¯ä»¥é‡å¤ï¼Œä¹Ÿå«**æƒé‡**ï¼‰ï¼ŒæŒ‰è¯„åˆ†ä»é«˜åˆ°ä½æ’åºã€‚\n\n#### å¸¸ç”¨å‘½ä»¤\n\n- `zadd <key> <score1> <value1> <score2> <value2> â€¦` å°†ä¸€æˆ–å¤šä¸ªå…ƒç´ åŠå…¶ score å€¼åŠ å…¥åˆ°æœ‰åºé›† key å½“ä¸­ã€‚\n\n- `zrange <key> <start> <stop> [withscores]`  è¿”å›æœ‰åºé›† key ä¸­ï¼Œä¸‹æ ‡åœ¨<start><stop>ä¹‹é—´çš„å…ƒç´    \n  - å¸¦withscoresï¼Œå¯ä»¥è®©åˆ†æ•°ä¸€èµ·å’Œå€¼è¿”å›åˆ°ç»“æœé›†ã€‚\n\n- `zrangebyscore <key> <min> <max> [withscores] [limit offset count]` è¿”å›æœ‰åºé›† key ä¸­ï¼Œæ‰€æœ‰ score å€¼ä»‹äº min å’Œ max ä¹‹é—´(åŒ…æ‹¬ç­‰äº min æˆ– max )çš„æˆå‘˜ã€‚æœ‰åºé›†æˆå‘˜æŒ‰ score å€¼é€’å¢(ä»å°åˆ°å¤§)æ¬¡åºæ’åˆ—ã€‚ \n\n- `zrevrangebyscore key maxmin [withscores] [limit offset count]`  åŒä¸Šï¼Œæ”¹ä¸ºä»å¤§åˆ°å°æ’åˆ—ã€‚ \n\n- `zincrby <key> <incr> <value>`   ä¸ºå…ƒç´ çš„scoreåŠ ä¸Šå¢é‡\n\n- `zrem <key> <value>` åˆ é™¤è¯¥é›†åˆä¸‹ï¼ŒæŒ‡å®šå€¼çš„å…ƒç´ \n\n- `zcount <key> <min> <max>`ç»Ÿè®¡è¯¥é›†åˆï¼Œåˆ†æ•°åŒºé—´å†…çš„å…ƒç´ ä¸ªæ•° \n\n- `zrank <key> <value>` è¿”å›è¯¥å€¼åœ¨é›†åˆä¸­çš„æ’åï¼Œä»0å¼€å§‹ã€‚\n\n#### æ•°æ®ç»“æ„\n\nZsetåº•å±‚ä½¿ç”¨äº†ä¸¤ä¸ªæ•°æ®ç»“æ„\n\n1. hashï¼Œhashçš„ä½œç”¨å°±æ˜¯å…³è”å…ƒç´ valueå’Œæƒé‡scoreï¼Œä¿éšœå…ƒç´ valueçš„å”¯ä¸€æ€§ï¼Œå¯ä»¥é€šè¿‡å…ƒç´ valueæ‰¾åˆ°ç›¸åº”çš„scoreå€¼ã€‚\n2. è·³è·ƒè¡¨ï¼Œè·³è·ƒè¡¨çš„ç›®çš„åœ¨äºç»™å…ƒç´ valueæ’åºï¼Œæ ¹æ®scoreçš„èŒƒå›´è·å–å…ƒç´ åˆ—è¡¨ã€‚\n\n## é…ç½®æ–‡ä»¶\n\n```properties\n# redis.conf\n\n### INCLUDES ###\n#å¯¼å…¥å…¶å®ƒé…ç½®æ–‡ä»¶\n\n### NETWORK ###\n# é…ç½®ç½‘ç»œç›¸å…³\n\n# ç»‘å®šçš„å¯è®¿é—®åœ°å€ï¼Œæ²¡æœ‰åˆ™ä»»æ„IP\nbind 127.0.0.1\n\n# æ˜¯å¦åªæœ‰æœ¬åœ°å¯ä»¥è®¿é—®\nprotected-mode yes\n\n# è®¿é—®ç«¯å£\nport 6379\n\n# è®¾ç½®tcpçš„backlogï¼Œbacklogå…¶å®æ˜¯ä¸€ä¸ªè¿æ¥é˜Ÿåˆ—ã€‚\n# backlogé˜Ÿåˆ—æ€»å’Œ=æœªå®Œæˆä¸‰æ¬¡æ¡æ‰‹é˜Ÿåˆ— + å·²ç»å®Œæˆä¸‰æ¬¡æ¡æ‰‹é˜Ÿåˆ—\n# åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ä½ éœ€è¦ä¸€ä¸ªé«˜backlogå€¼æ¥é¿å…æ…¢å®¢æˆ·ç«¯è¿æ¥é—®é¢˜\n# æ³¨æ„Linuxå†…æ ¸ä¼šå°†è¿™ä¸ªå€¼å‡å°åˆ°/proc/sys/net/core/somaxconnçš„å€¼ï¼ˆ128ï¼‰ï¼Œæ‰€ä»¥éœ€è¦ç¡®è®¤å¢å¤§/proc/sys/net/core/somaxconnå’Œ/proc/sys/net/ipv4/tcp_max_syn_backlogï¼ˆ128ï¼‰ä¸¤ä¸ªå€¼æ¥è¾¾åˆ°æƒ³è¦çš„æ•ˆæœ\ntcp-backlog 511\n\n# ç”¨æˆ·ç«¯ç©ºé—²xç§’åæ–­å¼€è¿æ¥ï¼ˆ0ä¸ºä¸æ–­å¼€ï¼‰\ntimeout 0\n\n# å¯¹è®¿é—®å®¢æˆ·ç«¯çš„ä¸€ç§å¿ƒè·³æ£€æµ‹ï¼Œæ¯ä¸ªxç§’æ£€æµ‹ä¸€æ¬¡ã€‚\n# 0ä¸ºå…³é—­æ£€æµ‹ï¼Œå»ºè®®è®¾ç½®æˆ60 \ntcp-keepalive 300\n\n### GENERAL ###\n# é€šç”¨è®¾ç½®\n\n# å®ˆæŠ¤è¿›ç¨‹\n# æ˜¯å¦å¼€å¯åå°å®ˆæŠ¤\ndaemonize no\n\n# å­˜æ”¾pidæ–‡ä»¶çš„ä½ç½®ï¼Œæ¯ä¸ªå®ä¾‹ä¼šäº§ç”Ÿä¸€ä¸ªä¸åŒçš„pidæ–‡ä»¶\npidfile /var/run/redis_6379.pid\n\n# æ—¥å¿—è®°å½•çº§åˆ«\n# å››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warning\nloglevel notice\n\n# æ—¥å¿—è®°å½•æ–‡ä»¶\nlogfile \"\"\n\n# æ•°æ®åº“æ•°é‡\ndatabases 16\n\n### SECURITY ###\n# å®‰å…¨ç›¸å…³è®¾ç½®\n\n# Redisè®¿é—®å¯†ç \n# å‘½ä»¤è¡Œä¸´æ—¶è®¾ç½®å¯†ç  config set requirepass xxxx\n# å‘½ä»¤è¡Œè·å–å¯†ç  config get requirepass\n# ç™»å½• auth xxxx\n# é»˜è®¤ä¸ºä¸éœ€è¦å¯†ç ï¼Œå–æ¶ˆæ³¨é‡Šä¸‹è¡Œå¹¶ä¿®æ”¹å¯†ç å³å¯å¼€å¯\n# requirepass foobared\n\n### CLIENTS ###\n# æœ€å¤šåŒæ—¶è¿æ¥Redisçš„å®¢æˆ·ç«¯æ•°\n# é»˜è®¤ä¸º10000\n# maxclients 10000\n\n### MEMORY MANAGEMENT ###\n#å†…å­˜ç®¡ç†ç›¸å…³è®¾ç½®\n\n# Rediså¯åˆ†é…çš„æœ€å¤§å†…å­˜\n# å»ºè®®è®¾ç½®ï¼\n# maxmemory <bytes>\n\n# å†…å­˜ç®¡ç†ç­–ç•¥ï¼Œå½“å†…å­˜å æ»¡æ—¶ä¼šéµå¾ªè¯¥ç­–ç•¥è¿›è¡Œç®¡ç†\n# ç­–ç•¥æœ‰å¦‚ä¸‹ï¼š\n# volatile-lru -> ä½¿ç”¨LRUç®—æ³•ç§»é™¤keyï¼Œåªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®\n# allkeys-lru -> åœ¨æ‰€æœ‰é›†åˆkeyä¸­ï¼Œä½¿ç”¨LRUç®—æ³•ç§»é™¤key\n# volatile-lfu -> ä½¿ç”¨LFUç®—æ³•ç§»é™¤keyï¼Œåªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®\n# allkeys-lfu -> åœ¨æ‰€æœ‰é›†åˆkeyä¸­ï¼Œä½¿ç”¨LFUç®—æ³•ç§»é™¤key\n# volatile-random -> åœ¨è¿‡æœŸé›†åˆä¸­ç§»é™¤éšæœºçš„keyï¼Œåªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®\n# allkeys-random -> åœ¨æ‰€æœ‰é›†åˆkeyä¸­ï¼Œç§»é™¤éšæœºçš„key\n# volatile-ttl -> ç§»é™¤é‚£äº›TTLå€¼æœ€å°çš„keyï¼Œå³é‚£äº›æœ€è¿‘è¦è¿‡æœŸçš„key\n# noeviction -> ä¸è¿›è¡Œç§»é™¤ã€‚é’ˆå¯¹å†™æ“ä½œï¼Œåªæ˜¯è¿”å›é”™è¯¯ä¿¡æ¯\n# LRU: æœ€è¿‘æœ€å°‘ä½¿ç”¨\n# LFU: æœ€ä¸å¸¸ç”¨\n# LRUã€LFUå’Œvolatile-ttlå‡é‡‡ç”¨è¿‘ä¼¼éšæœºåŒ–ç®—æ³•å®ç°\n# maxmemory-policy noeviction\n\n# LRU, LFUå’Œæœ€å°TTLç®—æ³•ä¸æ˜¯ç²¾ç¡®çš„ç®—æ³•ï¼Œè€Œæ˜¯è¿‘ä¼¼çš„ç®—æ³•(ä¸ºäº†èŠ‚çœå†…å­˜)ï¼Œæ‰€ä»¥ä½ å¯ä»¥è°ƒæ•´å®ƒçš„é€Ÿåº¦æˆ–ç²¾åº¦ã€‚\n# é»˜è®¤æƒ…å†µä¸‹ï¼ŒRediså°†æ£€æŸ¥äº”ä¸ªé”®ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªæœ€è¿‘ä½¿ç”¨æœ€å°‘çš„é”®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®æŒ‡ä»¤æ›´æ”¹æ ·æœ¬å¤§å°ã€‚é»˜è®¤å€¼5å¯ä»¥äº§ç”Ÿè¶³å¤Ÿå¥½çš„ç»“æœã€‚10éå¸¸æ¥è¿‘çœŸå®çš„LRUï¼Œä½†æ¶ˆè€—æ›´å¤šçš„CPUã€‚3æ›´å¿«ï¼Œä½†ä¸æ˜¯å¾ˆå‡†ç¡®ã€‚\n# maxmemory-samples 5\n```\n\nå…¶ä½™é…ç½®é€‰é¡¹ä¼šåœ¨ä¸‹æ–‡é™†ç»­æåˆ°ã€‚\n\n## Rediså‘å¸ƒå’Œè®¢é˜…\n\nRedis å‘å¸ƒè®¢é˜… (pub/sub) æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€… (pub) å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€… (sub) æ¥æ”¶æ¶ˆæ¯ã€‚\n\nRedis å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“ã€‚\n\n### è®¢é˜…å’Œå‘å¸ƒ\n\n1. å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…é¢‘é“å¦‚ä¸‹å›¾\n\n   {% mermaid %}\n   graph BT\n   \tch[channel1 é¢‘é“]\n   \ta([å®¢æˆ·ç«¯A]) --è®¢é˜…--> ch\n   \tb([å®¢æˆ·ç«¯B]) --è®¢é˜…--> ch\n   \tc([å®¢æˆ·ç«¯C]) --è®¢é˜…--> ch\n   {% endmermaid %}\n\n   \n\n2. å½“ç»™è¿™ä¸ªé¢‘é“å‘å¸ƒæ¶ˆæ¯åï¼Œæ¶ˆæ¯å°±ä¼šå‘é€ç»™è®¢é˜…çš„å®¢æˆ·ç«¯\n\n   {% mermaid %}\n   graph TB\n   \tpb[PUBLISH channel1 hello]\n   \tpb --> ch[channel1 é¢‘é“]\n   \tch --hello--> a([å®¢æˆ·ç«¯A]) \n   \tch --hello--> b([å®¢æˆ·ç«¯B]) \n   \tch --hello--> c([å®¢æˆ·ç«¯C])\n   {% endmermaid %}\n\n### å‘å¸ƒè®¢é˜…å‘½ä»¤\n\n`subscribe <channel>` è®¢é˜…é¢‘é“\n\n`publish <channel> <msg>` å‘å¸ƒä¿¡æ¯ï¼Œè¿”å›è®¢é˜…è€…æ•°é‡\n\n- **å‘å¸ƒè®¢é˜…è¿‡ç¨‹è‡ªåŠ¨åˆ›å»ºé¢‘é“**\n\n- **å‘å¸ƒçš„æ¶ˆæ¯æ²¡æœ‰æŒä¹…åŒ–ï¼Œå¦‚æœåœ¨è®¢é˜…çš„å®¢æˆ·ç«¯æ”¶ä¸åˆ°helloï¼Œåªèƒ½æ”¶åˆ°è®¢é˜…åå‘å¸ƒçš„æ¶ˆæ¯**\n\n## Redisæ–°æ•°æ®ç±»å‹\n\n### Bitmaps\n\n#### ç®€ä»‹\n\nRedisæä¾›äº†Bitmapsè¿™ä¸ªâ€œæ•°æ®ç±»å‹â€å¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œï¼š\n\nï¼ˆ1ï¼‰  Bitmapsæœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œ å®é™…ä¸Šå®ƒå°±æ˜¯å­—ç¬¦ä¸²ï¼ˆkey-valueï¼‰ ï¼Œ ä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œã€‚\n\nï¼ˆ2ï¼‰  Bitmapså•ç‹¬æä¾›äº†ä¸€å¥—å‘½ä»¤ï¼Œ æ‰€ä»¥åœ¨Redisä¸­ä½¿ç”¨Bitmapså’Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³•ä¸å¤ªç›¸åŒã€‚ å¯ä»¥æŠŠBitmapsæƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½çš„æ•°ç»„ï¼Œ æ•°ç»„çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨0å’Œ1ï¼Œ æ•°ç»„çš„ä¸‹æ ‡åœ¨Bitmapsä¸­å«åšåç§»é‡ã€‚\n\n#### å¸¸ç”¨å‘½ä»¤\n\n`setbit <key> <offset> <value>` è®¾ç½®Bitmapsä¸­æŸä¸ªåç§»é‡çš„å€¼ï¼ˆ0æˆ–1ï¼‰\n\n`getbit <key> <offset>` è·å–Bitmapsä¸­æŸä¸ªåç§»é‡çš„å€¼\n\n`bitcount<key> [start] [end] ` ç»Ÿè®¡å­—ç¬¦ä¸²ä»startå­—èŠ‚åˆ°endå­—èŠ‚bitä¸º1çš„æ•°é‡\n\n`bitop <and|or|not|xor> <destkey> [keyâ€¦]` bitopæ˜¯ä¸€ä¸ªå¤åˆæ“ä½œï¼Œ å®ƒå¯ä»¥åšå¤šä¸ªBitmapsçš„andï¼ˆäº¤é›†ï¼‰ ã€ orï¼ˆå¹¶é›†ï¼‰ ã€ notï¼ˆéï¼‰ ã€ xorï¼ˆå¼‚æˆ–ï¼‰ æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨destkeyä¸­ã€‚\n\n### HyperLogLog\n\n### ç®€ä»‹\n\nRedis HyperLogLog æ˜¯ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ŒHyperLogLog çš„ä¼˜ç‚¹æ˜¯ï¼Œåœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®šçš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚\n\nåœ¨ Redis é‡Œé¢ï¼Œæ¯ä¸ª HyperLogLog é”®åªéœ€è¦èŠ±è´¹ 12 KB å†…å­˜ï¼Œå°±å¯ä»¥è®¡ç®—æ¥è¿‘ 2^64 ä¸ªä¸åŒå…ƒç´ çš„åŸºæ•°ã€‚è¿™å’Œè®¡ç®—åŸºæ•°æ—¶ï¼Œå…ƒç´ è¶Šå¤šè€—è´¹å†…å­˜å°±è¶Šå¤šçš„é›†åˆå½¢æˆé²œæ˜å¯¹æ¯”ã€‚\n\nä½†æ˜¯ï¼Œå› ä¸º HyperLogLog åªä¼šæ ¹æ®è¾“å…¥å…ƒç´ æ¥è®¡ç®—åŸºæ•°ï¼Œè€Œä¸ä¼šå‚¨å­˜è¾“å…¥å…ƒç´ æœ¬èº«ï¼Œæ‰€ä»¥ HyperLogLog ä¸èƒ½åƒé›†åˆé‚£æ ·ï¼Œè¿”å›è¾“å…¥çš„å„ä¸ªå…ƒç´ ã€‚\n\n### å¸¸ç”¨å‘½ä»¤\n\n`pfadd <key> <element> [element...]`  æ·»åŠ æŒ‡å®šå…ƒç´ åˆ° HyperLogLog ä¸­\n\n- å¦‚æœæ‰§è¡Œå‘½ä»¤åHLLä¼°è®¡çš„è¿‘ä¼¼åŸºæ•°å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚\n\n`pfcount <key> [key...]`  è®¡ç®—HLLçš„è¿‘ä¼¼åŸºæ•°ï¼Œå¯ä»¥è®¡ç®—å¤šä¸ªHLLï¼Œæ¯”å¦‚ç”¨HLLå­˜å‚¨æ¯å¤©çš„UVï¼Œè®¡ç®—ä¸€å‘¨çš„UVå¯ä»¥ä½¿ç”¨7å¤©çš„UVåˆå¹¶è®¡ç®—å³å¯\n\n`pfmerge <destkey> <sourcekey> [sourcekey...]` å°†ä¸€ä¸ªæˆ–å¤šä¸ªHLLåˆå¹¶åçš„ç»“æœå­˜å‚¨åœ¨å¦ä¸€ä¸ªHLLä¸­ï¼Œæ¯”å¦‚æ¯æœˆæ´»è·ƒç”¨æˆ·å¯ä»¥ä½¿ç”¨æ¯å¤©çš„æ´»è·ƒç”¨æˆ·æ¥åˆå¹¶è®¡ç®—å¯å¾—\n\n### Geosptial\n\n#### ç®€ä»‹\n\nRedis 3.2 ä¸­å¢åŠ äº†å¯¹GEOç±»å‹çš„æ”¯æŒã€‚GEOï¼ŒGeographicï¼Œåœ°ç†ä¿¡æ¯çš„ç¼©å†™ã€‚è¯¥ç±»å‹ï¼Œå°±æ˜¯å…ƒç´ çš„2ç»´åæ ‡ï¼Œåœ¨åœ°å›¾ä¸Šå°±æ˜¯ç»çº¬åº¦ã€‚\n\nredisåŸºäºè¯¥ç±»å‹ï¼Œæä¾›äº†ç»çº¬åº¦è®¾ç½®ï¼ŒæŸ¥è¯¢ï¼ŒèŒƒå›´æŸ¥è¯¢ï¼Œè·ç¦»æŸ¥è¯¢ï¼Œç»çº¬åº¦**Hash**ç­‰å¸¸è§æ“ä½œã€‚\n\n#### å¸¸ç”¨å‘½ä»¤\n\n`geoadd <key> <longitude> <latitude> <member> [longitude latitude member...]`  æ·»åŠ åœ°ç†ä½ç½®ï¼ˆç»åº¦ï¼Œçº¬åº¦ï¼Œåç§°ï¼‰\n\n`geopos <key> <member> [member...]` è·å¾—æŒ‡å®šåœ°åŒºçš„åæ ‡å€¼\n\n`geodist <key> <member1> <member2> [m|km|ft|mi]` è·å–ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„ç›´çº¿è·ç¦»\n\n`georadius <key> <longitude> <latitude> <radius> [m|km|ft|mi]`  ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œæ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ \n\n## Jedis\n\njedis\n\n### Jediså’ŒLettuceæ¯”è¾ƒ\n\n> [Jediså’ŒLettuceçš„åŒºåˆ«_è¿™ä¸ªåå­—å…ˆç”¨ç€çš„åšå®¢-CSDNåšå®¢_jediså’Œlettuce](https://blog.csdn.net/weixin_38568503/article/details/124867109)\n\n## Redisæ•´åˆSpringBoot\n\n### å¼•å…¥ä¾èµ–é¡¹\n\n```xml\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n```\n\næ³¨ï¼šSpring2.Xé›†æˆredisæ‰€éœ€common-pool2\n\n### è‡ªå®šä¹‰é…ç½®ç±»\n\nè‡ªå®šä¹‰Beançš„åŸå› æ˜¯ä½¿æ•°æ®èƒ½å¤Ÿæ­£å¸¸åºåˆ—åŒ–å’Œååºåˆ—åŒ–å­˜å–Redisã€‚\n\n```java\n\t@Bean\n    @SuppressWarnings(value = {\"unchecked\", \"rawtypes\"})\n    public RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory factory) {\n        RedisTemplate<String, Object> template = new RedisTemplate<>();\n        template.setConnectionFactory(factory);\n\n        ObjectMapper om = new ObjectMapper();\n        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);\n        om.activateDefaultTyping(LaissezFaireSubTypeValidator.instance, ObjectMapper.DefaultTyping.NON_FINAL);\n\n        // java 8 localDateTime jacksonåºåˆ—åŒ–æ¨¡å— æ³¨å†Œ\n        om.registerModule(new JavaTimeModule());\n\n        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(om, Object.class);\n        StringRedisSerializer stringRedisSerializer = new StringRedisSerializer();\n\n        template.setKeySerializer(stringRedisSerializer);\n        template.setHashKeySerializer(stringRedisSerializer);\n        template.setValueSerializer(jackson2JsonRedisSerializer);\n        template.setHashValueSerializer(jackson2JsonRedisSerializer);\n\n        template.afterPropertiesSet();\n\n        return template;\n    }\n```\n\n**æ³¨ï¼š**åœ¨**åºåˆ—åŒ–**åvalueä¼šå¤šäº†**åŒå¼•å·**ï¼Œä½†æ˜¯ä¸å½±å“**ååºåˆ—åŒ–**æˆStringæˆ–å…¶å®ƒç±»å‹ã€‚å°†Valueå’ŒHashValueçš„Serializerè®¾ç½®ä¸ºstringRedisSerializerå¯ä»¥è§£å†³åŒå¼•å·é—®é¢˜ï¼Œä½†æ˜¯å°†ä¸èƒ½ç¼“å­˜å®ä½“ç±»ï¼ˆåºåˆ—åŒ–ä¼šæŠ¥é”™ï¼‰ã€‚\n\n### é…ç½®properties\n\napplication.properties\n\n```properties\n#RedisæœåŠ¡å™¨åœ°å€\nspring.redis.host=192.168.245.128\n#RedisæœåŠ¡å™¨è¿æ¥ç«¯å£ï¼ˆé»˜è®¤ä¸º6379ï¼‰\nspring.redis.port=6379\n# è´¦å·\n#spring.redis.username=\n# å¯†ç \n#spring.redis.password=\n#Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰\nspring.redis.database= 0\n#è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼Œä¸å¡«åˆ™æ— é™åˆ¶ï¼‰\nspring.redis.connect-timeout=1800000\n#è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼Œé»˜è®¤ä¸º8ï¼‰\nspring.redis.lettuce.pool.max-active=8\n#æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´(è´Ÿæ•°è¡¨ç¤ºæ²¡é™åˆ¶ï¼Œé»˜è®¤ä¸º-1)\nspring.redis.lettuce.pool.max-wait=-1ms\n#è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥ï¼ˆé»˜è®¤ä¸º8ï¼‰\nspring.redis.lettuce.pool.max-idle=8\n#è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥ï¼ˆé»˜è®¤ä¸º0ï¼‰\nspring.redis.lettuce.pool.min-idle=0\n```\n\napplication.yaml\n\n```yaml\nspring:\n  redis:\n    host: 192.168.245.128\n    port: 6379\n#    username:\n#    password:\n    database: 0\n    connect-timeout: 1800000\n    lettuce:\n      pool:\n        max-active: 8\n        max-wait: -1ms\n        max-idle: 8\n        min-idle: 0\n```\n\n\n\n## äº‹åŠ¡å’Œé”æœºåˆ¶\n\n### äº‹åŠ¡çš„å®šä¹‰\n\nRedisäº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰\té¡ºåºåœ°æ‰§è¡Œã€‚**äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚**\n\nRedisäº‹åŠ¡çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸²è”å¤šä¸ªå‘½ä»¤é˜²æ­¢åˆ«çš„å‘½ä»¤æ’é˜Ÿã€‚\n\n### multiã€execå’Œdiscard\n\n**`multi` å¼€å¯äº‹åŠ¡ï¼Œè¿›å…¥å‘½ä»¤ç»„é˜Ÿ**\n\n**`exec` æ‰§è¡Œå‘½ä»¤é˜Ÿåˆ—**\n\n**`discard`  æ”¾å¼ƒäº‹åŠ¡ç»„é˜Ÿ**\n\n```pseudocode\nmulti\t\t\t\texec\n |\t\t\t\t\t |\t\t\t\t\t |\n |----|----|----|----|----|----|----|----|\n |cmd1|cmd2|... |cmdx|ex 1|ex 2|... |ex x|\n |----|----|----|----|----|----|----|----|\n | \t --- Queue --->  | --- Execute --->  |\n \t\t\t\t   x|\n \t\t\t\t\tâ†“\n \t\t\t\tdiscard\n```\n\n### äº‹åŠ¡çš„é”™è¯¯å¤„ç†\n\n**ä¸MySQLäº‹åŠ¡é”™è¯¯å¤„ç†æ–¹å¼ä¸åŒã€‚**\n\n- ç»„é˜Ÿé˜¶æ®µå‡ºç°é”™è¯¯ï¼Œå…¨éƒ¨é€€å‡ºç»„é˜Ÿã€‚\n- æ‰§è¡Œé˜¶æ®µå‡ºç°é”™è¯¯ï¼Œå…¶å®ƒå‘½ä»¤æ­£å¸¸æ‰§è¡Œã€‚\n\n### watchå’Œunwatch\n\n`watch <key> [key ...]`\n\n- åœ¨æ‰§è¡Œmultiä¹‹å‰ï¼Œå…ˆæ‰§è¡Œwatchå¯ä»¥ç›‘è§†ä¸€ä¸ª(æˆ–å¤šä¸ª) key ï¼Œå¦‚æœåœ¨äº‹åŠ¡**æ‰§è¡Œä¹‹å‰è¿™ä¸ª(æˆ–è¿™äº›) key** **è¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­ã€‚**\n\n`unwatch`\n\n- å–æ¶ˆ watch å‘½ä»¤å¯¹æ‰€æœ‰ key çš„ç›‘è§†ã€‚\n- å¦‚æœåœ¨æ‰§è¡Œ watch å‘½ä»¤ä¹‹åï¼Œexec å‘½ä»¤æˆ–discardå‘½ä»¤å…ˆè¢«æ‰§è¡Œäº†çš„è¯ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å†æ‰§è¡Œunwatchäº†ã€‚\n\n### ä¹è§‚é”\n\n#### ç®€ä»‹\n\n**ä¹è§‚é”(Optimistic Lock),** é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚**ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡**ã€‚Rediså°±æ˜¯åˆ©ç”¨è¿™ç§check-and-setæœºåˆ¶å®ç°äº‹åŠ¡çš„ã€‚\n\nç²—ç•¥è§£é‡Šï¼šæˆ‘å¯ä»¥æŠŠä¸œè¥¿å–å‡ºæ¥ä¿®æ”¹ï¼ˆä½†æ˜¯è¿™ä¸ªä¸œè¥¿è¿˜åœ¨ï¼‰ï¼Œä½†æ˜¯æ”¾å›å»çš„æ—¶å€™å¿…é¡»å’Œå–å‡ºæ¥çš„æ—¶å€™çš„**ç‰ˆæœ¬**ä¸€è‡´ï¼Œä¸ç„¶å°±ä¿®æ”¹å¤±è´¥ã€‚\n\n#### å®ç°\n\nåˆ©ç”¨watchç›‘å¬keyçš„å€¼å˜åŒ–å¯ä»¥æ‰“æ–­äº‹åŠ¡ç»„é˜Ÿçš„ä½œç”¨å®ç°Redisä¹è§‚é”\n\n```java\npublic void optimisticLock() {\n    List<Object> results = redisTemplate.execute(new SessionCallback<>() {\n        @Override\n        @SuppressWarnings({\"unchecked\"})\n        public List<Object> execute(RedisOperations operations) throws DataAccessException {\n            //        å¼€å¯watchç›‘å¬\n            operations.watch(Arrays.asList(\"exampleKey1\", \"exampleKey2\"));\n            //        å¼€å¯Redisäº‹åŠ¡\n            operations.multi();\n            //        ä¸šåŠ¡é€»è¾‘\n            operations.opsForValue().increment(\"exampleKey1\");\n            operations.opsForValue().decrement(\"exampleKey2\");\n            return operations.exec();\n        }\n    });\n    if (results == null || results.size() == 0) {\n        System.out.println(\"æäº¤äº‹åŠ¡å¤±è´¥\");\n        return;\n    }\n    System.out.println(\"æäº¤äº‹åŠ¡æˆåŠŸ\");\n}\n```\n\n### æ‚²è§‚é”\n\n#### ç®€ä»‹\n\n**æ‚²è§‚é”(Pessimistic Lock)**, é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šblockç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚**ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶**ï¼Œæ¯”å¦‚**è¡Œé”**ï¼Œ**è¡¨é”**ç­‰ï¼Œ**è¯»é”**ï¼Œ**å†™é”**ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚\n\nç²—ç•¥è§£é‡Šï¼šæˆ‘æŠŠä¸œè¥¿å–å‡ºæ¥ä¿®æ”¹ï¼ˆè¿™ä¸ªä¸œè¥¿ä¸åœ¨äº†ï¼‰ï¼Œåœ¨æ”¾å›å»ä¹‹å‰ï¼Œå…¶ä»–äººéƒ½ä¸èƒ½ä¿®æ”¹è¿™ä¸ªä¸œè¥¿ã€‚\n\n#### å®ç°\n\n**æ–¹å¼ä¸€ï¼šsetnxå®ç°**\n\n```java\npublic void pessimisticLock_setnx() {\n    boolean lock = false;\n    String uuid = UUID.randomUUID() + \":\" + Thread.currentThread().getId();\n    while (!lock) {\n        // å¦‚æœlockå­˜åœ¨åˆ™å·²ä¸Šé” ï¼ˆlockåç§°è‡ªå·±å®šï¼‰ï¼ŒsetæˆåŠŸåˆ™è¿”å›true\n        lock = Boolean.TRUE.equals(redisTemplate.opsForValue().setIfAbsent(\"lock\", uuid, 3, TimeUnit.SECONDS));\n        if (lock) {\n            // ä¸šåŠ¡é€»è¾‘\n            redisTemplate.opsForValue().increment(\"exampleKey1\");\n            redisTemplate.opsForValue().decrement(\"exampleKey2\");\n            System.out.println(\"æˆåŠŸ\");\n            if (uuid.equals(redisTemplate.opsForValue().get(\"lock\")))\n                redisTemplate.delete(\"lock\");\n        } else {\n            // ç­‰å¾…ä¸€ä¸‹å†å‘é€è¯·æ±‚\n            try {\n                Thread.sleep(10);\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        }\n    }\n}\n```\n\n**æ–¹å¼äºŒï¼šLuaè„šæœ¬**ï¼ˆæ¨èï¼‰\n\nRedisåœ¨2.6æ¨å‡ºäº†è„šæœ¬åŠŸèƒ½ï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨Luaè¯­è¨€ç¼–å†™è„šæœ¬ä¼ åˆ°Redisä¸­æ‰§è¡Œã€‚ä½¿ç”¨è„šæœ¬çš„å¥½å¤„å¦‚ä¸‹:\n\n1. å‡å°‘ç½‘ç»œå¼€é”€ï¼šå°†å¤æ‚çš„æˆ–è€…å¤šæ­¥çš„redisæ“ä½œï¼Œå†™ä¸ºä¸€ä¸ªè„šæœ¬ï¼Œä¸€æ¬¡æäº¤ç»™redisæ‰§è¡Œï¼Œå‡å°‘åå¤è¿æ¥redisçš„æ¬¡æ•°ã€‚æå‡æ€§èƒ½ã€‚\n2. åŸå­æ“ä½œï¼šRedisä¼šå°†æ•´ä¸ªè„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œä¸­é—´ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’å…¥ï¼Œæœ‰ä¸€å®šçš„åŸå­æ€§ã€‚(javaç­‰å®¢æˆ·ç«¯åˆ™ä¼šæ‰§è¡Œå¤šæ¬¡å‘½ä»¤å®Œæˆä¸€ä¸ªä¸šåŠ¡ï¼Œè¿åäº†åŸå­æ€§æ“ä½œ)ã€‚\n3. å¤ç”¨ï¼šå®¢æˆ·ç«¯å‘é€çš„è„šæœ¬ä¼šæ°¸ä¹…å­˜å‚¨åœ¨Redisä¸­ï¼Œæ„å‘³ç€å…¶ä»–å®¢æˆ·ç«¯å¯ä»¥å¤ç”¨è¿™ä¸€è„šæœ¬è€Œä¸éœ€è¦ä½¿ç”¨ä»£ç å®ŒæˆåŒæ ·çš„é€»è¾‘ã€‚\n\n```java\nprivate final String script =\n        \"\"\"\n                local exampleKey1 = KEYS[1]\n                local exampleKey2 = KEYS[2]\n                local tmpValue1 = redis.call(\"get\", exampleKey1)\n                local tmpValue2 = redis.call(\"get\", exampleKey2)\n                local incr = redis.call(\"incr\", exampleKey1)\n                local decr = redis.call(\"decr\", exampleKey2)\n                \n                if tonumber(incr) > tonumber(tmpValue1) and tonumber(decr) < tonumber(tmpValue2)\n                then\n                    return 1\n                else\n                    return 0\n                end\n                \"\"\";\npublic void pessimisticLock_lua() {\n    RedisScript<Long> redisScript = new DefaultRedisScript<>(script, Long.class);\n    Long ret = redisTemplate.execute(redisScript, Arrays.asList(\"exampleKey1\", \"exampleKey2\"));\n    if (ret != null && ret == 1) {\n        System.out.println(\"æˆåŠŸ\");\n    } else {\n        System.out.println(\"å¤±è´¥\");\n    }\n}\n```\n\n### Redisäº‹åŠ¡ä¸‰ç‰¹æ€§\n\n- å•ç‹¬çš„éš”ç¦»æ“ä½œ \n  - äº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚ \n\n- æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ \n  - é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ²¡æœ‰æäº¤ä¹‹å‰éƒ½ä¸ä¼šå®é™…è¢«æ‰§è¡Œï¼Œå› ä¸ºäº‹åŠ¡æäº¤å‰ä»»ä½•æŒ‡ä»¤éƒ½ä¸ä¼šè¢«å®é™…æ‰§è¡Œ\n\n- ä¸ä¿è¯åŸå­æ€§ \n  - äº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»š \n\n## æŒä¹…åŒ–æ“ä½œ\n\nå°†Rediså†…å­˜ä¸­çš„æ•°æ®å‚¨å­˜åˆ°ç¡¬ç›˜ã€‚\n\næŒä¹…åŒ–æ–¹å¼ï¼š\n\n- RDB\n- AOF\n\nå½“RDBå’ŒAOFåŒæ—¶å¼€å¯æ—¶ï¼ŒRedisé»˜è®¤ä½¿ç”¨AOFã€‚\n\n### RDB\n\n#### ç®€ä»‹\n\nåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œ ä¹Ÿå°±æ˜¯è¡Œè¯è®²çš„Snapshotå¿«ç…§ï¼Œå®ƒæ¢å¤æ—¶æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œã€‚\n\n#### æµç¨‹\n\n{% mermaid %}\ngraph LR\n\tbgsave --1--> p[çˆ¶è¿›ç¨‹] --2--> fork -- 3 --> o[å“åº”å…¶å®ƒå‘½ä»¤]\n    fork --> c[å­è¿›ç¨‹] --4--> rdb[ç”ŸæˆRDBæ–‡ä»¶]\n    c --5é€šçŸ¥çˆ¶è¿›ç¨‹--> p\n    p --> r([æœ‰å…¶å®ƒå­è¿›ç¨‹æ­£åœ¨æ‰§è¡Œç›´æ¥è¿”å›])\n{% endmermaid %}\n\nRedisä¼šå•ç‹¬åˆ›å»ºï¼ˆforkï¼‰ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ° ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚ æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IOæ“ä½œçš„ï¼Œè¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚**RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±**ã€‚\n\n#### é…ç½®æ–‡ä»¶\n\n```properties\n### SNAPSHOTTING  ###\n\n# æ•°æ®åº“çš„æŒä¹…åŒ–ï¼ˆå¤‡ä»½ï¼‰\n# save <seconds> <changes>\n# ä¾‹ï¼š'save 60 10000' 60ç§’å†…è‡³å°‘æœ‰10000ä¸ªkeyå‘ç”Ÿå˜åŒ–åˆ™è¿›è¡ŒæŒä¹…åŒ–\n# save \"\"\n\n# å½“Redisæ— æ³•å†™å…¥ç£ç›˜çš„è¯ï¼Œç›´æ¥å…³æ‰Redisçš„å†™æ“ä½œ\nstop-writes-on-bgsave-error yes\n\n# å¯¹äºå­˜å‚¨åˆ°ç£ç›˜ä¸­çš„å¿«ç…§ï¼Œå¯ä»¥è®¾ç½®æ˜¯å¦è¿›è¡Œå‹ç¼©å­˜å‚¨ã€‚å¦‚æœå¼€å¯ï¼Œredisä¼šé‡‡ç”¨LZFç®—æ³•è¿›è¡Œå‹ç¼©ã€‚\n# å¦‚æœä½ ä¸æƒ³æ¶ˆè€—CPUæ¥è¿›è¡Œå‹ç¼©çš„è¯ï¼Œå¯ä»¥è®¾ç½®ä¸ºå…³é—­æ­¤åŠŸèƒ½ã€‚æ¨èyes\nrdbcompression yes\n\n# åœ¨å­˜å‚¨å¿«ç…§åï¼Œè¿˜å¯ä»¥è®©redisä½¿ç”¨CRC64ç®—æ³•æ¥è¿›è¡Œæ•°æ®æ ¡éªŒï¼Œ\n# å¤§çº¦10%çš„æ€§èƒ½æ¶ˆè€—\nrdbchecksum yes\n\n# å¤‡ä»½æ–‡ä»¶çš„åç§°\ndbfilename dump.rdb\n\n# å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„\n# ./è¡¨ç¤ºåœ¨é»˜è®¤å®‰è£…ä½ç½®/usr/local/bin/\ndir ./\n```\n\nå¼€å¯rdbå¤‡ä»½åï¼Œåœ¨rediså¼€å¯çš„æ—¶å€™ä¼šåŠ è½½dump.rdbæ–‡ä»¶å†…å®¹åˆ°å†…å­˜ä¸­ã€‚\n\nåŠ¨æ€åœæ­¢ï¼š`redis-cli config set save \"\"`\n\n#### saveå’Œbgsaveå‘½ä»¤\n\nsave: ä¿å­˜æ˜¯é˜»å¡ä¸»è¿›ç¨‹ï¼Œå®¢æˆ·ç«¯æ— æ³•è¿æ¥redisï¼Œç­‰SAVEå®Œæˆåï¼Œä¸»è¿›ç¨‹æ‰å¼€å§‹å·¥ä½œï¼Œå®¢æˆ·ç«¯å¯ä»¥è¿æ¥ã€‚\n\nbgsave: æ˜¯forkä¸€ä¸ªsaveçš„å­è¿›ç¨‹ï¼Œåœ¨æ‰§è¡Œsaveè¿‡ç¨‹ä¸­ï¼Œä¸å½±å“ä¸»è¿›ç¨‹ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ­£å¸¸é“¾æ¥redisï¼Œç­‰å­è¿›ç¨‹forkæ‰§è¡Œsaveå®Œæˆåï¼Œé€šçŸ¥ä¸»è¿›ç¨‹ï¼Œå­è¿›ç¨‹å…³é—­ã€‚\n\n> [Redis Save ä¸ BGSAVE çš„åŒºåˆ« - Rayé›· - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/rayong/p/6791330.html)\n\n#### ä¼˜ç¼ºç‚¹\n\n**ä¼˜ç‚¹ï¼š**\n\n- é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤\n\n- å¯¹æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§è¦æ±‚ä¸é«˜æ›´é€‚åˆä½¿ç”¨\n\n- èŠ‚çœç£ç›˜ç©ºé—´\n\n- æ¢å¤é€Ÿåº¦å¿«\n\n**ç¼ºç‚¹ï¼š**\n\n- Forkçš„æ—¶å€™ï¼Œå†…å­˜ä¸­çš„æ•°æ®è¢«å…‹éš†äº†ä¸€ä»½ï¼Œå¤§è‡´2å€çš„è†¨èƒ€æ€§éœ€è¦è€ƒè™‘\n- è™½ç„¶Redisåœ¨forkæ—¶ä½¿ç”¨äº†**å†™æ—¶æ‹·è´æŠ€æœ¯**,ä½†æ˜¯å¦‚æœæ•°æ®åºå¤§æ—¶è¿˜æ˜¯æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½ã€‚\n- åœ¨å¤‡ä»½å‘¨æœŸåœ¨ä¸€å®šé—´éš”æ—¶é—´åšä¸€æ¬¡å¤‡ä»½ï¼Œæ‰€ä»¥å¦‚æœRedisæ„å¤–downæ‰çš„è¯ï¼Œå°±ä¼šä¸¢å¤±æœ€åä¸€æ¬¡å¿«ç…§åçš„æ‰€æœ‰ä¿®æ”¹ã€‚\n\n### AOF\n\n#### ç®€ä»‹\n\nä»¥**æ—¥å¿—**çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼ˆå¢é‡ä¿å­˜ï¼‰ï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥(**è¯»æ“ä½œä¸è®°å½•**)ï¼Œ **åªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶**ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredis é‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œã€‚\n\n#### æµç¨‹\n\n{% mermaid %}\ngraph TD\n\twrite[å‘½ä»¤å†™å…¥] -- 1 append--> aof_buffer[AOFç¼“å†²] \n\t-- 2 sync --> aof_file[AOFæ–‡ä»¶] -- 4 load --> reboot[é‡å¯]\n\taof_file --3 rewrite --> aof_file\n{% endmermaid %}\n\n1. å®¢æˆ·ç«¯çš„è¯·æ±‚å†™å‘½ä»¤ä¼šè¢«appendè¿½åŠ åˆ°AOFç¼“å†²åŒºå†…ï¼›\n2. AOFç¼“å†²åŒºæ ¹æ®AOFæŒä¹…åŒ–ç­–ç•¥[always,everysec,no]å°†æ“ä½œsyncåŒæ­¥åˆ°ç£ç›˜çš„AOFæ–‡ä»¶ä¸­ï¼›\n3. AOFæ–‡ä»¶å¤§å°è¶…è¿‡é‡å†™ç­–ç•¥æˆ–æ‰‹åŠ¨é‡å†™æ—¶ï¼Œä¼šå¯¹AOFæ–‡ä»¶rewriteé‡å†™ï¼Œå‹ç¼©AOFæ–‡ä»¶å®¹é‡ï¼›\n4. RedisæœåŠ¡é‡å¯æ—¶ï¼Œä¼šé‡æ–°loadåŠ è½½AOFæ–‡ä»¶ä¸­çš„å†™æ“ä½œè¾¾åˆ°æ•°æ®æ¢å¤çš„ç›®çš„ï¼›\n\n#### é…ç½®æ–‡ä»¶\n\n```properties\n### APPEND ONLY MODE ###\n\n# æ˜¯å¦å¼€å¯AOF\nappendonly no\n\n# AOFæ–‡ä»¶åç§°\n# é»˜è®¤è·¯å¾„åœ¨é»˜è®¤å®‰è£…è·¯å¾„/usr/local/bin/\nappendfilename \"appendonly.aof\"\n\n# AOFåŒæ­¥é¢‘ç‡\n# always å§‹ç»ˆåŒæ­¥ï¼Œï¼Œæ¯æ¬¡Redisçš„å†™å…¥éƒ½ä¼šç«‹åˆ»è®°å…¥æ—¥å¿—ï¼›æ€§èƒ½è¾ƒå·®ä½†æ•°æ®å®Œæ•´æ€§æ¯”è¾ƒå¥½\n# everysec æ¯ç§’åŒæ­¥ï¼Œæ¯ç§’è®°å…¥æ—¥å¿—ä¸€æ¬¡ï¼Œå¦‚æœå®•æœºï¼Œæœ¬ç§’çš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚\n# no redisä¸ä¸»åŠ¨è¿›è¡ŒåŒæ­¥ï¼ŒæŠŠåŒæ­¥æ—¶æœºäº¤ç»™æ“ä½œç³»ç»Ÿã€‚\nappendfsync everysec\n\n# Rewriteå‹ç¼©æ–‡ä»¶\n# yes,ä¸å†™å…¥aofæ–‡ä»¶åªå†™å…¥aofç¼“å­˜ï¼Œç”¨æˆ·è¯·æ±‚ä¸ä¼šé˜»å¡ï¼Œä½†æ˜¯åœ¨è¿™æ®µæ—¶é—´å¦‚æœå®•æœºä¼šä¸¢å¤±è¿™æ®µæ—¶é—´çš„ç¼“å­˜æ•°æ®ã€‚ï¼ˆé™ä½æ•°æ®å®‰å…¨æ€§ï¼Œæé«˜æ€§èƒ½ï¼‰\n# no, ä¼šæŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œä½†æ˜¯é‡åˆ°é‡å†™æ“ä½œï¼Œå¯èƒ½ä¼šå‘ç”Ÿé˜»å¡ã€‚ï¼ˆæ•°æ®å®‰å…¨ï¼Œä½†æ˜¯æ€§èƒ½é™ä½ï¼‰\nno-appendfsync-on-rewrite no\n\n# è¶…è¿‡min + min * percent æ—¶é‡å†™\nauto-aof-rewrite-percentage 100\nauto-aof-rewrite-min-size 64mb\n```\n\n#### Rewriteæµç¨‹\n\n1. bgrewriteaofè§¦å‘é‡å†™ï¼Œåˆ¤æ–­æ˜¯å¦å½“å‰æœ‰bgsaveæˆ–bgrewriteaofåœ¨è¿è¡Œï¼Œå¦‚æœæœ‰ï¼Œåˆ™ç­‰å¾…è¯¥å‘½ä»¤ç»“æŸåå†ç»§ç»­æ‰§è¡Œã€‚\n2. ä¸»è¿›ç¨‹forkå‡ºå­è¿›ç¨‹æ‰§è¡Œé‡å†™æ“ä½œï¼Œä¿è¯ä¸»è¿›ç¨‹ä¸ä¼šé˜»å¡ã€‚\n3. å­è¿›ç¨‹éå†rediså†…å­˜ä¸­æ•°æ®åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯çš„å†™è¯·æ±‚åŒæ—¶å†™å…¥aof_bufç¼“å†²åŒºå’Œaof_rewrite_bufé‡å†™ç¼“å†²åŒºä¿è¯åŸAOFæ–‡ä»¶å®Œæ•´ä»¥åŠæ–°AOFæ–‡ä»¶ç”ŸæˆæœŸé—´çš„æ–°çš„æ•°æ®ä¿®æ”¹åŠ¨ä½œä¸ä¼šä¸¢å¤±ã€‚\n4. å­è¿›ç¨‹å†™å®Œæ–°çš„AOFæ–‡ä»¶åï¼Œå‘ä¸»è¿›ç¨‹å‘ä¿¡å·ï¼Œçˆ¶è¿›ç¨‹æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ã€‚2).ä¸»è¿›ç¨‹æŠŠaof_rewrite_bufä¸­çš„æ•°æ®å†™å…¥åˆ°æ–°çš„AOFæ–‡ä»¶ã€‚\n5. ä½¿ç”¨æ–°çš„AOFæ–‡ä»¶è¦†ç›–æ—§çš„AOFæ–‡ä»¶ï¼Œå®ŒæˆAOFé‡å†™ã€‚\n\n#### ä¼˜ç¼ºç‚¹\n\n**ä¼˜ç‚¹ï¼š**\n\n- å¤‡ä»½æœºåˆ¶æ›´ç¨³å¥ï¼Œä¸¢å¤±æ•°æ®æ¦‚ç‡æ›´ä½ã€‚\n- å¯è¯»çš„æ—¥å¿—æ–‡æœ¬ï¼Œé€šè¿‡æ“ä½œAOFç¨³å¥ï¼Œå¯ä»¥å¤„ç†è¯¯æ“ä½œã€‚\n\n**ç¼ºç‚¹ï¼š**\n\n- æ¯”èµ·RDBå ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ã€‚\n- æ¢å¤å¤‡ä»½é€Ÿåº¦è¦æ…¢ã€‚\n- æ¯æ¬¡è¯»å†™éƒ½åŒæ­¥çš„è¯ï¼Œæœ‰ä¸€å®šçš„æ€§èƒ½å‹åŠ›ã€‚\n- å­˜åœ¨ä¸ªåˆ«Bugï¼Œé€ æˆæ¢å¤ä¸èƒ½ã€‚\n\n## ä¸»ä»å¤åˆ¶\n\n### ç›¸å…³å†…å®¹\n\n- masterä¸»æœåŠ¡å™¨ï¼Œslaveä»æœåŠ¡å™¨\n\n- è¯»å†™åˆ†ç¦»ï¼Œæ€§èƒ½æ‰©å±•\n\n- å®¹ç¾å¿«é€Ÿæ¢å¤\n\n{% mermaid %}\nflowchart\n\tapp([åº”ç”¨]) -- å†™ --> z[ä¸»]\n\tapp -- è¯» --> c1[ä»]\n\tapp -- è¯» --> c2[ä»]\n\tapp -- è¯» --> c3[ä»]\n\tz -- å¤åˆ¶ --> c1\n\tz -- å¤åˆ¶ --> c2\n\tz -- å¤åˆ¶ --> c3\n{% endmermaid %}\n\n**æ³¨ï¼š**ä»æœåŠ¡å™¨å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ä»æœåŠ¡å™¨ï¼Œä¸”æ•°æ®ä¾æ¬¡ä¼ é€’ã€‚\n\n**ç›¸å…³Rediså‘½ä»¤ï¼š**\n\n- `info replication` æŸ¥çœ‹ä¸»ä»å¤åˆ¶ç›¸å…³ä¿¡æ¯\n\n- `slaveof <ip> <port>` æˆä¸ºæŸä¸ªå®ä¾‹çš„ä»æœåŠ¡å™¨\n\n  - `slaveof no one` è‡ªå·±æˆä¸ºä¸»æœåŠ¡å™¨\n\n  - é‡å¯Rediså¤±æ•ˆï¼Œå†™å…¥é…ç½®æ–‡ä»¶å³å¯æ°¸ä¹…\n\n**ä¸»ä»è¯»å†™æƒ…å†µï¼š**\n\n- æœåŠ¡å™¨æˆä¸ºä»æœåŠ¡å™¨åä¼šåŒæ­¥ä¸»æœåŠ¡å™¨çš„æ•°æ®\n\n- ä¸»æœåŠ¡å™¨å¯ä»¥è¯»å†™ï¼Œå†™å…¥æ“ä½œåä¼šä»æœåŠ¡å™¨ä¼šåŒæ­¥\n- ä»æœåŠ¡å™¨åªèƒ½è¿›è¡Œè¯»æ“ä½œ\n\n**ä¸»ä»æ‰çº¿æƒ…å†µï¼š**\n\n- ä¸»æœåŠ¡å™¨æ‰çº¿ï¼šä»æœåŠ¡å™¨ä¸å˜ï¼Œç­‰å¾…ä¸»æœåŠ¡å™¨ä¸Šçº¿\n- ä»æœåŠ¡å™¨æ‰çº¿ï¼šä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨æ•°é‡å‡å°‘ï¼Œä»æœåŠ¡å™¨ä¸Šçº¿åslaveofå³å¯\n\n**è‹¥ä¸»æœåŠ¡å™¨æœ‰è®¾ç½®`requirepass`åˆ™ä»æœåŠ¡å™¨å¿…é¡»è®¾ç½®`masterauth`ã€‚**\n\n### ä¸»ä»å¤åˆ¶åŸç†\n\n- æŸæœåŠ¡å™¨æˆä¸ºä»æœåŠ¡å™¨åä¼šå‘ä¸»æœåŠ¡å™¨å‘é€æ•°æ®åŒæ­¥è¯·æ±‚ï¼ˆsyncå‘½ä»¤ï¼‰ï¼Œä¸»æœåŠ¡å™¨å¯åŠ¨åå°ç¨‹åºå°†æ•°æ®å†™å…¥æ–‡ä»¶ï¼ˆRDBæ–‡ä»¶ï¼‰ï¼Œç„¶åæ–‡ä»¶ç»™ä»æœåŠ¡å™¨ã€‚ï¼ˆ**å…¨é‡å¤åˆ¶**ï¼‰\n\n- ä¸»æœåŠ¡å™¨å†™å…¥æ“ä½œåä¼šå‘é€ç›¸åŒå‘½ä»¤ç»™ä»æœåŠ¡å™¨è¿›è¡ŒåŒæ­¥ï¼ˆ**å¢é‡å¤åˆ¶**ï¼‰\n\n> [å…¨ç½‘æœ€æ¸…æ™°ï¼Redisä¸»ä»å¤åˆ¶åŸç†åŠå®ç°ï¼Œç»å¯¹ç»™ä½ éä¸€èˆ¬çš„ä½“éªŒ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/179266035)\n\n### å“¨å…µæ¨¡å¼\n\nå“¨å…µæ¨¡å¼(Sentinel)ï¼Œèƒ½å¤Ÿåå°ç›‘æ§ä¸»æœºæ˜¯å¦æ•…éšœï¼Œå¦‚æœæ•…éšœäº†æ ¹æ®æŠ•ç¥¨æ•°è‡ªåŠ¨å°†ä»åº“è½¬æ¢ä¸ºä¸»åº“ã€‚\n\nå‘½ä»¤ï¼š`redis-sentinel <sentinel.conf>`\n\nç¼–å†™sentinel.conf\n\n```properties\n# æ ¼å¼sentinel monitor <å“¨å…µç›‘æ§çš„æœåŠ¡å™¨åç§°> <ip> <port> <åŒæ„è¿ç§»ä¸»æœåŠ¡å™¨çš„æœ€å°å“¨å…µæ•°é‡>\n# ä¾‹ï¼š \nsentinel monitor mymaster 127.0.0.1 6379 1 \n\n# ä»æœåŠ¡å™¨è¿ä¸»æœåŠ¡å™¨çš„å¯†ç \nsentinel auth-pass mymaster 123456\n```\n\nå½“ä¸»æœåŠ¡å™¨æ•…éšœäº†ï¼Œä¼šå¾æ±‚å…¶å®ƒå“¨å…µæ„è§è®¤ä¸ºå®ƒæ˜¯å¦æ•…éšœï¼Œä¹‹åä¼šå¾æ±‚å…¶å®ƒå“¨å…µæ„è§é€‰ä¸¾æ–°çš„ä¸»æœåŠ¡å™¨ã€‚\n\né€‰ä¸¾æ–°æœåŠ¡å™¨æ¡ä»¶ï¼š\n\n1. ä¼˜å…ˆçº§é«˜çš„\n2. åç§»é‡æœ€å¤§çš„ï¼ˆæ‹¥æœ‰ä¸»æœåŠ¡å™¨æ•°æ®æœ€å…¨çš„ï¼‰\n3. runidæœ€å°çš„\n\né€‰ä¸¾ä¹‹åæ—§ä¸»æœåŠ¡å™¨ä¼šæ”¾è¿‡æ¥æˆä¸ºæ–°ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ã€‚\n\n```properties\n# redis.conf\n### REPLICATION ###\n\n# é€‰ä¸¾çš„ä¼˜å…ˆçº§ï¼Œå€¼è¶Šå°çº§åˆ«è¶Šé«˜\nreplica-priority 100\n```\n\n> [Redisç³»åˆ—å…«ï¼šredisä¸»ä»å¤åˆ¶å’Œå“¨å…µ - å°ä¸ç‚¹å•Š - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/leeSmall/p/8398401.html)\n\n## é›†ç¾¤\n\nRedis é›†ç¾¤å®ç°äº†å¯¹Redisçš„æ°´å¹³æ‰©å®¹ï¼Œå³å¯åŠ¨Nä¸ªredisèŠ‚ç‚¹ï¼Œå°†æ•´ä¸ªæ•°æ®åº“åˆ†å¸ƒå­˜å‚¨åœ¨è¿™Nä¸ªèŠ‚ç‚¹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨æ€»æ•°æ®çš„1/Nã€‚\n\nRedis é›†ç¾¤é€šè¿‡åˆ†åŒºï¼ˆpartitionï¼‰æ¥æä¾›ä¸€å®šç¨‹åº¦çš„å¯ç”¨æ€§ï¼ˆavailabilityï¼‰ï¼š å³ä½¿é›†ç¾¤ä¸­æœ‰ä¸€éƒ¨åˆ†èŠ‚ç‚¹å¤±æ•ˆæˆ–è€…æ— æ³•è¿›è¡Œé€šè®¯ï¼Œ é›†ç¾¤ä¹Ÿå¯ä»¥ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚\n\n> [è®¤è¯†Redisé›†ç¾¤â€”â€”Redis Cluster - JJian - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jian0110/p/14002555.html)\n\n### é…ç½®æ–‡ä»¶\n\n```properties\n### REDIS CLUSTER  ###\n# å¼€å¯é›†ç¾¤æ¨¡å¼\ncluster-enabled yes\n# è®¾å®šèŠ‚ç‚¹é…ç½®æ–‡ä»¶å\ncluster-config-file nodes-6379.conf\n# è®¾å®šèŠ‚ç‚¹å¤±è”æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé›†ç¾¤è‡ªåŠ¨è¿›è¡Œä¸»ä»åˆ‡æ¢ã€‚\ncluster-node-timeout 15000\n\n# å¦‚æœå¤„ç†æŸéƒ¨åˆ†slotçš„ä¸»ä»éƒ½æŒ‚æ‰\n# yes - æ•´ä¸ªé›†ç¾¤æŒ‚æ‰\n# no - æŒ‚æ‰slotçš„éƒ¨åˆ†ä¸å¯ç”¨ï¼Œå…¶å®ƒæ­£å¸¸\ncluster-require-full-coverage yes\n```\n\n### å¼€å¯é›†ç¾¤\n\nè¿›å…¥ç¼–è¯‘å¥½çš„è§£å‹çš„redisç›®å½•`cd /opt/redis-6.2.10/src`\n\næ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œipè¯·ä½¿ç”¨çœŸå®ip\n\n```pseudocode\nredis-cli --cluster create --cluster-replicas 1 192.168.245.128:6379 192.168.245.128:6380 192.168.245.128:6381 192.168.245.128:6389 192.168.245.128:6390 192.168.245.128:6391\n```\n\n`--replicas 1` é‡‡ç”¨æœ€ç®€å•çš„æ–¹å¼é…ç½®é›†ç¾¤ï¼Œä¸€å°ä¸»æœºï¼Œä¸€å°ä»æœºã€‚\n\n`-u` è´¦å·\n\n`-a` å¯†ç \n\n`redis-cli -c -p xxxx` è¿›å…¥é›†ç¾¤å®¢æˆ·ç«¯\n\n- `-a xxx` ç™»å½•å¯†ç \n\n`cluster nodes` æŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯\n\n**ä¸€ä¸ªé›†ç¾¤è‡³å°‘è¦æœ‰ä¸‰ä¸ªä¸»èŠ‚ç‚¹ã€‚**\n\né€‰é¡¹ --cluster-replicas 1 è¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›ä¸ºé›†ç¾¤ä¸­çš„æ¯ä¸ªä¸»èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªä»èŠ‚ç‚¹ã€‚\n\nåˆ†é…åŸåˆ™å°½é‡ä¿è¯æ¯ä¸ªä¸»æ•°æ®åº“è¿è¡Œåœ¨ä¸åŒçš„IPåœ°å€ï¼Œæ¯ä¸ªä»åº“å’Œä¸»åº“ä¸åœ¨ä¸€ä¸ªIPåœ°å€ä¸Šã€‚\n\n### slots\n\nä¸€ä¸ª Redis **é›†ç¾¤åŒ…å« 16384 ä¸ªæ’æ§½**ï¼ˆhash slotï¼‰ï¼Œ æ•°æ®åº“ä¸­çš„æ¯ä¸ªé”®éƒ½å±äºè¿™ 16384 ä¸ªæ’æ§½çš„å…¶ä¸­ä¸€ä¸ªï¼Œé›†ç¾¤ä½¿ç”¨å…¬å¼ CRC16(key) % 16384 æ¥è®¡ç®—é”® key å±äºå“ªä¸ªæ§½ï¼Œ å…¶ä¸­ CRC16(key) è¯­å¥ç”¨äºè®¡ç®—é”® key çš„ CRC16 æ ¡éªŒå’Œ ã€‚\n\n**é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£å¤„ç†ä¸€éƒ¨åˆ†æ’æ§½ã€‚** \n\n**åœ¨é›†ç¾¤ä¸­å½•å…¥æ•°æ®:** \n\n- æ¯æ¬¡å½•å…¥ã€æŸ¥è¯¢ã€Rediséƒ½ä¼šè®¡ç®—è¯¥keyå±äºå“ªä¸ªæ’æ§½ï¼Œå¹¶é‡å®šå‘åˆ°å¯¹åº”èŠ‚ç‚¹è¿›è¡Œæ“ä½œã€‚\n\n- ä¸åœ¨ä¸€ä¸ªslotä¸‹çš„é”®å€¼ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨mget,msetç­‰å¤šé”®æ‰¹é‡æ“ä½œã€‚\n  - å¯ä»¥ä½¿ç”¨{}å¯¹é”®è¿›è¡Œåˆ†ç»„ï¼Œä»è€Œç›¸åŒç»„çš„é”®å€¼ä¼šè¢«æ”¾å…¥ç›¸åŒslotä¸­ã€‚\n  - ä¾‹ï¼š`mset k1{group} v1 k2{group} v2 `\n\n\n\n`cluster keyslot <key>`  è®¡ç®—é”® key åº”è¯¥è¢«æ”¾ç½®åœ¨å“ªä¸ªæ§½ä¸Šã€‚\n\n`cluster countkeysinslot <slot>` è¿”å›æ§½ slot ç›®å‰åŒ…å«çš„é”®å€¼å¯¹æ•°é‡ã€‚\n\n`cluster getkeysinslot <slot> <count>` è¿”å› count ä¸ª slot æ§½ä¸­çš„é”® ã€‚\n\n### ä¼˜ç¼ºç‚¹\n\n**ä¼˜ç‚¹ï¼š**\n\n- å®ç°æ‰©å®¹\n- åˆ†æ‘Šå‹åŠ›\n- æ— ä¸­å¿ƒé…ç½®ç›¸å¯¹ç®€å•\n\n**ç¼ºç‚¹ï¼š**\n\n- å¤šé”®æ“ä½œæ˜¯ä¸è¢«æ”¯æŒçš„\n- å¤šé”®çš„Redisäº‹åŠ¡æ˜¯ä¸è¢«æ”¯æŒçš„ã€‚luaè„šæœ¬ä¸è¢«æ”¯æŒ\n\n## ç¼“å­˜ç©¿é€\n\nkeyå¯¹åº”çš„æ•°æ®åœ¨æ•°æ®æºå¹¶ä¸å­˜åœ¨ï¼Œæ¯æ¬¡é’ˆå¯¹æ­¤keyçš„è¯·æ±‚ä»ç¼“å­˜è·å–ä¸åˆ°ï¼Œè¯·æ±‚éƒ½ä¼šå‹åˆ°æ•°æ®æºï¼Œä»è€Œå¯èƒ½å‹å®æ•°æ®æºã€‚æ¯”å¦‚ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„ç”¨æˆ·idè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œä¸è®ºç¼“å­˜è¿˜æ˜¯æ•°æ®åº“éƒ½æ²¡æœ‰ï¼Œè‹¥é»‘å®¢åˆ©ç”¨æ­¤æ¼æ´è¿›è¡Œæ”»å‡»å¯èƒ½å‹å®æ•°æ®åº“ã€‚\n\n## ç¼“å­˜å‡»ç©¿\n\nkeyå¯¹åº”çš„æ•°æ®å­˜åœ¨ï¼Œä½†åœ¨redisä¸­è¿‡æœŸï¼Œæ­¤æ—¶è‹¥æœ‰å¤§é‡å¹¶å‘è¯·æ±‚è¿‡æ¥ï¼Œè¿™äº›è¯·æ±‚å‘ç°ç¼“å­˜è¿‡æœŸä¸€èˆ¬éƒ½ä¼šä»åç«¯DBåŠ è½½æ•°æ®å¹¶å›è®¾åˆ°ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™å¤§å¹¶å‘çš„è¯·æ±‚å¯èƒ½ä¼šç¬é—´æŠŠåç«¯DBå‹å®ã€‚\n\n## ç¼“å­˜é›ªå´©\n\nkeyå¯¹åº”çš„æ•°æ®å­˜åœ¨ï¼Œä½†åœ¨redisä¸­å¤§é‡è¿‡æœŸï¼Œæ­¤æ—¶è‹¥æœ‰å¤§é‡å¹¶å‘è¯·æ±‚è¿‡æ¥ï¼Œè¿™äº›è¯·æ±‚å‘ç°ç¼“å­˜è¿‡æœŸä¸€èˆ¬éƒ½ä¼šä»åç«¯DBåŠ è½½æ•°æ®å¹¶å›è®¾åˆ°ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™å¤§å¹¶å‘çš„è¯·æ±‚å¯èƒ½ä¼šç¬é—´æŠŠåç«¯DBå‹å®ã€‚\n\nç¼“å­˜é›ªå´©ä¸ç¼“å­˜å‡»ç©¿çš„åŒºåˆ«åœ¨äºè¿™é‡Œé’ˆå¯¹å¾ˆå¤škeyç¼“å­˜ï¼Œå‰è€…åˆ™æ˜¯æŸä¸€ä¸ªkey\n\næ­£å¸¸è®¿é—®\n\n## åˆ†å¸ƒå¼é”\n\n### setnxå®ç°\n\n```java\npublic void pessimisticLock_setnx() {\n    boolean lock = false;\n    String uuid = UUID.randomUUID() + \":\" + Thread.currentThread().getId();\n    while (!lock) {\n        // å¦‚æœlockå­˜åœ¨åˆ™å·²ä¸Šé” ï¼ˆlockåç§°è‡ªå·±å®šï¼‰ï¼ŒsetæˆåŠŸåˆ™è¿”å›true\n        lock = Boolean.TRUE.equals(redisTemplate.opsForValue().setIfAbsent(\"lock\", uuid, 3, TimeUnit.SECONDS));\n        if (lock) {\n            // ä¸šåŠ¡é€»è¾‘\n            redisTemplate.opsForValue().increment(\"exampleKey1\");\n            redisTemplate.opsForValue().decrement(\"exampleKey2\");\n            System.out.println(\"æˆåŠŸ\");\n            if (uuid.equals(redisTemplate.opsForValue().get(\"lock\")))\n                redisTemplate.delete(\"lock\");\n        } else {\n            // ç­‰å¾…ä¸€ä¸‹å†å‘é€è¯·æ±‚\n            try {\n                Thread.sleep(10);\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        }\n    }\n}\n```\n\n## Redisson\n\n### å¼•å…¥ä¾èµ–\n\n```xml\n<!-- https://mvnrepository.com/artifact/org.redisson/redisson-spring-boot-starter -->\n<dependency>\n    <groupId>org.redisson</groupId>\n    <artifactId>redisson-spring-boot-starter</artifactId>\n    <version>3.19.3</version>\n</dependency>\n```\n\n### é…ç½®\n\n#### æ–¹å¼ä¸€\n\nç›´æ¥ä½¿ç”¨application.ymlé‡Œspring.redisçš„é…ç½®ä¿¡æ¯ã€‚\n\nredissonå’Œrediså…±ç”¨é…ç½®ã€‚\n\n#### æ–¹å¼äºŒ\n\nç›´æ¥å†™åœ¨application.ymlé‡Œ:\n\n```yaml\nspring:\n\tredis:\n\t\tredisson:\n\t\t\tconfig: \n\t\t\t\t#Redissoné…ç½®\n                singleServerConfig:\n                  address: \"redis://127.0.0.1:6379\"\n                  password: null\n                  clientName: null\n                  database: 0\n                  idleConnectionTimeout: 10000\n                  pingTimeout: 1000\n                  connectTimeout: 10000\n                  timeout: 3000\n                  retryAttempts: 3\n                  retryInterval: 1500\n                  reconnectionTimeout: 3000\n                  failedAttempts: 3\n                  subscriptionsPerConnection: 5\n                  subscriptionConnectionMinimumIdleSize: 1\n                  subscriptionConnectionPoolSize: 50\n                  connectionMinimumIdleSize: 32\n                  connectionPoolSize: 64\n                  dnsMonitoringInterval: 5000\n                  #dnsMonitoring: false\n\n                # é›†ç¾¤ç›¸å…³\n                clusterServersConfig:\n                  idleConnectionTimeout: 10000\n                  connectTimeout: 10000\n                  timeout: 3000\n                  retryAttempts: 3\n                  retryInterval: 1500\n                  password: null\n                  subscriptionsPerConnection: 5\n                  clientName: null\n                  loadBalancer: !<org.redisson.connection.balancer.RoundRobinLoadBalancer> {}\n                  slaveSubscriptionConnectionMinimumIdleSize: 1\n                  slaveSubscriptionConnectionPoolSize: 50\n                  slaveConnectionMinimumIdleSize: 32\n                  slaveConnectionPoolSize: 64\n                  masterConnectionMinimumIdleSize: 32\n                  masterConnectionPoolSize: 64\n                  readMode: \"SLAVE\"\n                  nodeAddresses:\n                  - \"redis://127.0.0.1:7004\"\n                  - \"redis://127.0.0.1:7001\"\n                  - \"redis://127.0.0.1:7000\"\n                  scanInterval: 1000\n\n                  threads: 0\n                nettyThreads: 0\n                codec:\n                  class: \"org.redisson.codec.JsonJacksonCodec\"\n                transportMode: \"NIO\"\n```\n\n[Redisson åˆ†å¸ƒå¼é”å®æˆ˜ä¸ watch dog æœºåˆ¶è§£è¯» - ä¸Šå¸çˆ±åƒè‹¹æœ-Soochow - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/keeya/p/14332131.html)\n\n## ACL\n\n`acl list`\n\n[Redis 6.0 è®¿é—®æ§åˆ¶åˆ—è¡¨ACLè¯´æ˜ï¼ˆæœ‰è¿™ç¯‡å°±å¤Ÿäº†ï¼‰_å¥‡ç‚¹_97çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_29235677/article/details/121475204)\n","tags":["ç¬”è®°","Redis"],"categories":["NoSQL"]},{"title":"Linuxå­¦ä¹ ç¬”è®°","url":"/2023/01/24/linux-note/","content":"# Linuxå­¦ä¹ ç¬”è®°\n\nLinuxå­¦ä¹ è®°å½•ï¼ŒæŒ‰ç…§[éŸ©é¡ºå¹³è€å¸ˆ](https://space.bilibili.com/651245581 \"éŸ©é¡ºå¹³ - Bilibili\")[è§†é¢‘](https://www.bilibili.com/video/BV1Sv411r7vd \"ã€å°ç™½å…¥é—¨ é€šä¿—æ˜“æ‡‚ã€‘2021éŸ©é¡ºå¹³ ä¸€å‘¨å­¦ä¼šLinux\")è¿›è¡Œå­¦ä¹ ã€‚\n\n## ç›®å½•ç»“æ„\n\n> [Linux ç³»ç»Ÿç›®å½•ç»“æ„ | èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/linux/linux-system-contents.html)\n\n### åŸºæœ¬ä»‹ç»\n\n1. linuxçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯é‡‡ç”¨çº§**å±‚å¼çš„æ ‘çŠ¶**ç›®å½•ç»“æ„ï¼Œåœ¨æ­¤ç»“æ„ä¸­çš„æœ€ä¸Šå±‚æ˜¯**æ ¹ç›®å½•â€œ/â€**ã€‚\n2.  åœ¨Linuxä¸–ç•Œé‡Œï¼Œä¸€åˆ‡çš†æ–‡ä»¶ã€‚\n\næ ‘çŠ¶ç›®å½•ç»“æ„ï¼š\n\n```pseudocode\n/\nâ”œâ”€â”€ bin -> usr/bin\nâ”œâ”€â”€ boot\nâ”œâ”€â”€ dev\nâ”œâ”€â”€ etc\nâ”œâ”€â”€ home\nâ”œâ”€â”€ lib -> usr/lib\nâ”œâ”€â”€ lib64 -> usr/lib64\nâ”œâ”€â”€ lost+found\nâ”œâ”€â”€ media\nâ”œâ”€â”€ mnt\nâ”œâ”€â”€ opt\nâ”œâ”€â”€ proc\nâ”œâ”€â”€ root\nâ”œâ”€â”€ run\nâ”œâ”€â”€ sbin -> usr/sbin\nâ”œâ”€â”€ srv\nâ”œâ”€â”€ sys\nâ”œâ”€â”€ tmp\nâ”œâ”€â”€ usr\nâ””â”€â”€ var\n```\n\n![](https://www.runoob.com/wp-content/uploads/2014/06/d0c50-linux2bfile2bsystem2bhierarchy.jpg)\n\n### ç›®å½•è§£é‡Š\n\n- **/bin** [å¸¸ç”¨] (/usr/binã€ /usr/local/bin)æ˜¯Binaryçš„ç¼©å†™ï¼Œè¿™ä¸ªç›®å½•å­˜æ”¾ç€æœ€ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤\n- **/sbin** (/usr/sbinã€ /usr/local/sbin)så°±æ˜¯Super Userçš„æ„æ€ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åºã€‚\n- **/home** [å¸¸ç”¨]å­˜æ”¾æ™®é€šç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œåœ¨Linuxä¸­æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œä¸€èˆ¬è¯¥ç›®å½•åæ˜¯ä»¥ç”¨æˆ·çš„è´¦å·å‘½å\n- **/root** [å¸¸ç”¨]è¯¥ç›®å½•ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œä¹Ÿç§°ä½œè¶…çº§æƒé™è€…çš„ç”¨æˆ·ä¸»ç›®å½•\n- **/lib** ç³»ç»Ÿå¼€æœºæ‰€éœ€è¦æœ€åŸºæœ¬çš„åŠ¨æ€è¿æ¥å…±äº«åº“ï¼Œå…¶ä½œç”¨ç±»ä¼¼äºWindowsé‡Œçš„DLLæ–‡ä»¶ã€‚å‡ ä¹æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦ç”¨åˆ°è¿™äº›å…±äº«åº“\n- **/lost+found** è¿™ä¸ªç›®å½•ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç©ºçš„ï¼Œå½“ç³»ç»Ÿéæ³•å…³æœºåï¼Œè¿™é‡Œå°±å­˜æ”¾äº†ä¸€äº›æ–‡ä»¶\n- **/etc**[å¸¸ç”¨]æ‰€æœ‰çš„ç³»ç»Ÿç®¡ç†æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶å’Œå­ç›®å½•,æ¯”å¦‚å®‰è£…mysqlæ•°æ®åº“ my.conf\n- **/usr** [å¸¸ç”¨]è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç”¨æˆ·çš„å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œç±»ä¼¼ä¸windowsä¸‹çš„program filesç›®å½•ã€‚\n- **/boot** [å¸¸ç”¨] å­˜æ”¾çš„æ˜¯å¯åŠ¨Linuxæ—¶ä½¿ç”¨çš„ä¸€äº›æ ¸å¿ƒæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è¿æ¥æ–‡ä»¶ä»¥åŠé•œåƒæ–‡ä»¶\n- **/proc** [ä¸èƒ½åŠ¨]è¿™ä¸ªç›®å½•æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç›®å½•ï¼Œå®ƒæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ï¼Œè®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯\n- **/srv** [ä¸èƒ½åŠ¨]serviceç¼©å†™ï¼Œè¯¥ç›®å½•å­˜æ”¾ä¸€äº›æœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦æå–çš„æ•°æ®\n- **/sys**[ä¸èƒ½åŠ¨]è¿™æ˜¯linux2.6å†…æ ¸çš„ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚è¯¥ç›®å½•ä¸‹å®‰è£…äº†2.6å†…æ ¸ä¸­æ–°å‡ºç°çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ sysfs\n- **/tmp** è¿™ä¸ªç›®å½•æ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„\n- **/dev**ç±»ä¼¼äºwindowsçš„è®¾å¤‡ç®¡ç†å™¨ï¼ŒæŠŠæ‰€æœ‰çš„ç¡¬ä»¶ç”¨æ–‡ä»¶çš„å½¢å¼å­˜å‚¨/media[å¸¸ç”¨]linuxç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä¸€äº›è®¾å¤‡ï¼Œä¾‹å¦‚Uç›˜ã€å…‰é©±ç­‰ç­‰ï¼Œå½“è¯†åˆ«åï¼Œlinuxä¼šæŠŠè¯†åˆ«çš„è®¾å¤‡æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹\n- **/mnt** [å¸¸ç”¨]ç³»ç»Ÿæä¾›è¯¥ç›®å½•æ˜¯ä¸ºäº†è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½åˆ«çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤–éƒ¨çš„å­˜å‚¨æŒ‚è½½åœ¨/mnt/ä¸Šï¼Œç„¶åè¿›å…¥è¯¥ç›®å½•å°±å¯ä»¥æŸ¥çœ‹é‡Œçš„å†…å®¹äº†ã€‚\n- **/opt** è¿™æ˜¯ç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚å¦‚å®‰è£…ORACLEæ•°æ®åº“å°±å¯æ”¾åˆ°è¯¥ç›®å½•ä¸‹ã€‚é»˜è®¤ä¸ºç©ºã€‚\n- **/usr/local** [å¸¸ç”¨]è¿™æ˜¯å¦ä¸€ä¸ªç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€å®‰è£…çš„ç›®å½•ã€‚ä¸€èˆ¬æ˜¯é€šè¿‡ç¼–è¯‘æºç æ–¹å¼å®‰è£…çš„ç¨‹åº\n- **/var** [å¸¸ç”¨]è¿™ä¸ªç›®å½•ä¸­å­˜æ”¾ç€åœ¨ä¸æ–­æ‰©å……ç€çš„ä¸œè¥¿,ä¹ æƒ¯å°†ç»å¸¸è¢«ä¿®æ”¹çš„ç›®å½•æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚åŒ…æ‹¬å„ç§æ—¥å¿—æ–‡ä»¶\n- **/selinux** [security-enhanced linux]SELinuxæ˜¯ä¸€ç§å®‰å…¨å­ç³»ç»Ÿï¼Œå®ƒèƒ½æ§åˆ¶ç¨‹åºåªèƒ½è®¿é—®ç‰¹å®šæ–‡ä»¶ï¼Œæœ‰ä¸‰ç§å·¥ä½œæ¨¡å¼ï¼Œå¯ä»¥è‡ªè¡Œè®¾ç½®.\n\n## VimåŸºæœ¬ç”¨æ³•\n\nvimæ˜¯viçš„å¢å¼ºç‰ˆï¼Œè¯­æ³•è¯†åˆ«é«˜äº®æ˜¾ç¤ºç­‰ã€‚ã€‚ã€‚\n\nvim <file> ç”¨vimæ‰“å¼€æ–‡ä»¶ï¼Œæ²¡æœ‰åˆ™é»˜è®¤æ‰“å¼€ç©ºæ–‡ä»¶\n\n### vimçš„ä¸‰ä¸ªæ¨¡å¼\n\n- ä¸€èˆ¬æ¨¡å¼\n- è¾“å…¥æ¨¡å¼\n- å‘½ä»¤è¡Œæ¨¡å¼\n\n\n\nè¿›å…¥ä¸ºä¸€èˆ¬æ¨¡å¼ï¼Œåœ¨ä¸€ä¸€èˆ¬æ¨¡å¼ä¸‹æŒ‰a/Aï¼Œi/Iï¼Œo/OæŒ‰é”®è¿›å…¥è¾“å…¥æ¨¡å¼ï¼ŒæŒ‰Escé€€å›ä¸€èˆ¬æ¨¡å¼ï¼Œåœ¨æ­£å¸¸æ¨¡å¼ä¸‹æŒ‰:è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼è¾“å…¥å‘½ä»¤æŒ‰Enteræäº¤ã€‚\n\n{% mermaid %}\n\ngraph TD\n    EQ[è¿›å…¥/é€€å‡º] --vim filename--> Normal[ä¸€èˆ¬æ¨¡å¼]\n    Normal --:wq--> EQ\n    Normal --è¾“å…¥i a o --> Input[è¾“å…¥æ¨¡å¼]\n    Input --ESC--> Normal\n    Normal --è¾“å…¥ : --> Cmd[å‘½ä»¤è¡Œæ¨¡å¼]\n    Cmd --å›è½¦ä»¥ç»“æŸè¿è¡Œ--> Normal\n\n{% endmermaid %}\n\n### ä¸€èˆ¬æ¨¡å¼æŒ‡ä»¤\n\n- `yy` å¤åˆ¶å½“å‰è¡Œï¼ˆ`5yy`å¤åˆ¶åŒ…æ‹¬å½“å‰å¾€ä¸‹5è¡Œï¼‰\n- `p` ç²˜è´´\n- `dd` åˆ é™¤å½“å‰è¡Œï¼ˆ`5dd`åˆ é™¤åŒ…æ‹¬å½“å‰å¾€ä¸‹5è¡Œï¼‰\n- `gg` å…‰æ ‡è·³åˆ°ç¬¬ä¸€è¡Œ\n- `G` å…‰æ ‡è·³åˆ°æœ€åä¸€è¡Œ\n- `<è¡Œå·>gg/<è¡Œå·>G` å…‰æ ‡è·³åˆ°æŒ‡å®šè¡Œï¼ˆä¾‹å¦‚ï¼š`20gg/20G`è·³è½¬åˆ°è¡Œå·20ï¼‰\n- `/<å…³é”®è¯>` æœç´¢å…³é”®è¯ï¼Œ`n`æŸ¥æ‰¾ä¸‹ä¸€ä¸ªï¼ˆä¾‹å¦‚`/hello`ï¼‰\n\n### å‘½ä»¤è¡Œæ¨¡å¼æŒ‡ä»¤\n\n- `:h` æŸ¥çœ‹help.txt\n\n- `:w` ä¿å­˜å†™å…¥\n- `:q` é€€å‡º\n- `:q!` å¼ºåˆ¶é€€å‡º\n- `:wq` ä¿å­˜å†™å…¥å¹¶é€€å‡º\n- `:<è¡Œå·>` è·³è½¬åˆ°æŒ‡å®šè¡Œå·ï¼ˆå¦‚ï¼š`:20` è·³è½¬åˆ°è¡Œå·20ï¼‰\n- `:set nu` ä¸´æ—¶è®¾ç½®è¡Œå·\n- `:set nonu` å–æ¶ˆè¡Œå·\n\n### Vimé”®ç›˜å›¾\n\n![](https://www.runoob.com/wp-content/uploads/2015/10/vi-vim-cheat-sheet-sch.gif)\n\n## ç”¨æˆ·ç®¡ç†\n\n### ç›¸å…³æŒ‡ä»¤ï¼ˆå‘½ä»¤ï¼‰\n`su - <user>` åˆ‡æ¢ç”¨æˆ·\n\n`logout` / `exit` ç™»å‡º\n\n`id <user>` æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯\n\n`whoami` æŸ¥çœ‹å½“å‰ä¼šè¯ç”¨æˆ·\n\n`who am i` æŸ¥çœ‹ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ ï¼ˆç¬¬ä¸€æ¬¡ä¼šè¯çš„ï¼‰\n\n\n\n`useradd <user>` åˆ›å»ºç”¨æˆ·\n\n- `-r` æŒ‡å®šå®¶ç›®å½•\n- `-g` æ·»åŠ åˆ°æŒ‡å®šç”¨æˆ·ç»„ï¼ˆä¸æ·»åŠ å°†åˆ›å»ºä¸è¯¥ç”¨æˆ·åŒåçš„ç»„ï¼Œå¹¶æŒ‡å®šè¯¥ç»„ï¼‰\n\n`passwd <user>` ä¿®æ”¹ç”¨æˆ·å¯†ç \n\n`userdel <user>` åˆ é™¤ç”¨æˆ·\n\n- `-r` åŒæ—¶åˆ é™¤å®¶ç›®å½•\n\n`usermod [é€‰é¡¹] <user>` ä¿®æ”¹ç”¨æˆ·å±æ€§\n\n- `-g` ä¿®æ”¹ç”¨æˆ·ç»„\n- `-d` ä¿®æ”¹ç”¨æˆ·å®¶ç›®å½•ï¼ˆéœ€è¦æœ‰ä¸€å®šæƒé™ï¼‰\n\n\n\n`groupadd <group>` åˆ›å»ºç”¨æˆ·ç»„\n\n`groupdel <group>` åˆ é™¤ç”¨æˆ·ç»„\n\n\n\n### ç”¨æˆ·å’Œç»„ç›¸å…³æ–‡ä»¶\n\n/etc/passwdæ–‡ä»¶\n\n- ç”¨æˆ·çš„é…ç½®æ–‡ä»¶ï¼Œè®°å½•ç”¨æˆ·çš„å„ç§ä¿¡æ¯\n- æ¯è¡Œæ ¼å¼ï¼š ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:Shellç™»å½•\n\n/etc/shadowæ–‡ä»¶\n\n- å£ä»¤çš„é…ç½®æ–‡ä»¶\n- æ¯è¡Œæ ¼å¼ï¼š ç”¨æˆ·å:åŠ å¯†å£ä»¤:æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´:æœ€å°æ—¶é—´é—´éš”:æœ€å¤§æ—¶é—´é—´éš”:è­¦å‘Šæ—¶é—´:ä¸æ´»åŠ¨æ—¶é—´:å¤±æ•ˆæ—¶é—´:æ ‡å¿—\n\n/etc/groupæ–‡ä»¶\n\n- ç»„çš„é…ç½®æ–‡ä»¶ï¼Œè®°å½•LinuxåŒ…å«çš„ç»„çš„ä¿¡æ¯\n- æ¯è¡Œæ ¼å¼ï¼š ç»„å:å£ä»¤:ç»„æ ‡è¯†å·:ç»„å†…ç”¨æˆ·åˆ—è¡¨\n\n### å¿˜è®°å¯†ç è§£å†³åŠæ³•\n\n**åŸºäºCentOS 7.9**\n\n1. é‡å¯ç³»ç»Ÿ\n2. åœ¨é€‰æ‹©ç•Œé¢ä½¿ç”¨æ–¹å‘ä¸Šä¸‹é”®é€‰æ‹©é˜²æ­¢è‡ªåŠ¨é€‰æ‹©\n3. æŒ‰**e**è¿›å…¥ç¼–è¾‘ç•Œé¢\n4. æ‰¾åˆ°ä»¥linux16å¼€å¤´çš„è¡Œï¼Œåœ¨æœ«å°¾åŠ å…¥`init=/bin/sh`\n5. Ctrl+Xè¿›å…¥å•ç”¨æˆ·æ¨¡å¼\n6. è¾“å…¥ï¼š`mount -o remount,rw /`å¹¶å›è½¦ \n7. è¾“å…¥ï¼š`passwd`å¹¶å›è½¦\n8. è¾“å…¥ä¸¤éæ–°å¯†ç \n9. è¾“å…¥ï¼š`touch /.autorelabel`å¹¶å›è½¦\n10. è¾“å…¥ï¼š`exec /sbin/init` å¹¶å›è½¦\n11. ç­‰å¾…ç³»ç»Ÿé‡å¯å³å¯\n\n> å…¶å®ƒæ“ä½œä¿®æ”¹ï¼š [Linuxç³»ç»Ÿå¿˜è®°äº†rootå¯†ç æ€ä¹ˆåŠï¼Ÿ_Dribblelifeçš„åšå®¢-CSDNåšå®¢_å¿˜è®°rootå¯†ç ](https://blog.csdn.net/weixin_38044888/article/details/89915553)\n\n## <span id=\"runLevel\">è¿è¡Œçº§åˆ«</span>\n\n### åŸºæœ¬ä»‹ç»\n\nè¿è¡Œçº§åˆ«è¯´æ˜ï¼š\n\n- 0:å…³æœº\n- 1:å•ç”¨æˆ·ã€æ‰¾å›ä¸¢å¤±å¯†ç ã€‘\n- 2ï¼šå¤šç”¨æˆ·çŠ¶æ€æ²¡æœ‰ç½‘ç»œæœåŠ¡\n- 3ï¼šå¤šç”¨æˆ·çŠ¶æ€æœ‰ç½‘ç»œæœåŠ¡\n- 4ï¼šç³»ç»Ÿæœªä½¿ç”¨ä¿ç•™ç»™ç”¨æˆ·\n- 5ï¼šå›¾å½¢ç•Œé¢\n- 6ï¼šç³»ç»Ÿé‡å¯\n\nå¸¸ç”¨è¿è¡Œçº§åˆ«æ˜¯3å’Œ5ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤è¿è¡Œçº§åˆ«\n\næ¼”ç¤ºåº”ç”¨å®ä¾‹å‘½ä»¤ï¼š**`init [0123456]`** \n\nåº”ç”¨æ¡ˆä¾‹ï¼šé€šè¿‡init æ¥åˆ‡æ¢ä¸åŒçš„è¿è¡Œçº§åˆ«ï¼Œæ¯”å¦‚åŠ¨ 5-3ï¼Œç„¶åå…³æœºã€‚\n\n- `systemctl get-default` æŸ¥çœ‹é»˜è®¤è¿è¡Œçº§åˆ«\n- `systemctl set-default <çº§åˆ«>` è®¾ç½®é»˜è®¤è¿è¡Œçº§åˆ«\n  - `multi-user.target` å¤šç”¨æˆ·çº§åˆ« 3\n  - `graphical.target` å›¾å½¢çº§åˆ« 5\n\n## å¸®åŠ©æŒ‡ä»¤\n\n- `man <å‘½ä»¤æˆ–é…ç½®æ–‡ä»¶>` è·å¾—å¸®åŠ©ä¿¡æ¯ï¼ˆ`man ls`æŸ¥çœ‹`ls`å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼‰\n- `help [å‘½ä»¤]` è·å–shellå†…ç½®å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼ˆå¦‚`help cd`ï¼‰\n- `<å‘½ä»¤> --help` æŸ¥çœ‹æŸå‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼ˆå¦‚`ls --help`ï¼‰\n\n## æ–‡ä»¶ç›®å½•æŒ‡ä»¤\n\n`pwd` æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„\n`ls [é€‰é¡¹] [ç›®å½•/æ–‡ä»¶]` æŸ¥çœ‹æ˜¾ç¤ºç›®å½•/æ–‡ä»¶ä¿¡æ¯\n\n- `-a` æ˜¾ç¤ºå½“å‰ç›®å½•æ‰€æœ‰çš„æ–‡ä»¶å’Œç›®å½•ï¼ŒåŒ…æ‹¬éšè—çš„\n- `-l` å·²åˆ—è¡¨çš„æ–¹å¼æ˜¾ç¤ºä¿¡æ¯ï¼ˆç­‰åŒäºllï¼‰\n- `-i `\n- `-h` è½¬æ¢å¤§å°å•ä½\n\n`cd <dir>` åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•\n\n  - `cd ~` åˆ‡æ¢åˆ°å®¶ç›®å½•\n  - `cd ..` è¿”å›ä¸Šä¸€çº§ç›®å½•\n\n\n\n`mkdir [é€‰é¡¹] <ç›®å½•>` åˆ›å»ºç›®å½•\n\n- `-p` åˆ›å»ºå¤šçº§ç›®å½•\n\n`rmdir <ç›®å½•>` åˆ é™¤ç©ºç›®å½•\n`rm [é€‰é¡¹] <æ–‡ä»¶/ç›®å½•>` åˆ é™¤ç›®å½•/æ–‡ä»¶\n\n- `-r` é€’å½’åˆ é™¤æ•´ä¸ªç›®å½•\n- `-f` å¼ºåˆ¶åˆ é™¤ä¸æç¤º\n- `-rf` åŒ…å«ä¸Šé¢ä¸¤è€…\n\n`touch <file>` åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶\n\n`cp [é€‰é¡¹] <source> <dest>` å¤åˆ¶æ–‡ä»¶/ç›®å½•åˆ°æŒ‡å®šç›®å½•\n\n- `-r` é€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•\n- `\\cp` å¼ºåˆ¶è¦†ç›–ä¸æç¤º\n\nmv ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•æˆ–é‡å‘½å\n\n- `mv <oldName> <newName>` é‡å‘½å\n- `mv <file/dir> <path>` ç§»åŠ¨æ–‡ä»¶/ç›®å½•\n\n\n\n`cat [é€‰é¡¹]` æŸ¥çœ‹æ–‡ä»¶å†…å®¹\n\n- `-n` æ˜¾ç¤ºè¡Œå·\n- `cat [é€‰é¡¹] <file> | more `\n\n\n\nmore åŸºäºVIç¼–è¾‘å™¨çš„æ–‡æœ¬è¿‡æ»¤å™¨ï¼Œä»¥å…¨å±å¹•çš„æ–¹å¼æŒ‰é¡µæ˜¾ç¤º\n\n- Space  ç¿»åŠ¨ä¸‹ä¸€é¡µ\n- Enter  ç¿»åŠ¨ä¸‹ä¸€è¡Œ\n- q é€€å‡º\n- Ctrl+F ç¿»åŠ¨ä¸‹ä¸€å±\n- Ctrl+B ç¿»åŠ¨ä¸Šä¸€å±\n- = è¾“å‡ºå½“å‰è¡Œçš„è¡Œå·\n- :f è¾“å‡ºæ–‡ä»¶åå’Œå½“å‰è¡Œçš„è¡Œå·\n\nless åˆ†å±æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œä¸moreç±»ä¼¼ä½†æ›´å¼ºå¤§ï¼ŒæŒ‰éœ€åŠ è½½\n\n- Space  ç¿»åŠ¨ä¸‹ä¸€é¡µ\n- PageDown ç¿»åŠ¨ä¸‹ä¸€é¡µ\n- PageUp ç¿»åŠ¨ä¸Šä¸€é¡µ\n- /<keyword> å‘ä¸‹æœå¯»ã€‚ nï¼šä¸‹ä¸€ä¸ª Nï¼šä¸Šä¸€ä¸ª\n- ?<keyword> å‘ä¸Šæœå¯»ã€‚ nï¼šä¸‹ä¸€ä¸ª Nï¼šä¸Šä¸€ä¸ª\n- q é€€å‡º\n\n\n\n`echo [é€‰é¡¹] <content>`  è¾“å‡ºå†…å®¹åˆ°æ§åˆ¶å°\n\n- å¦‚ `echo $HOSTNAME` è¾“å‡ºä¸»æœºå\n- å¦‚ `echo $PATH` è¾“å‡ºç¯å¢ƒå˜é‡\n\n`head [é€‰é¡¹] <file>` æ˜¾ç¤ºæ–‡ä»¶çš„å¤´éƒ¨å†…å®¹ï¼Œé»˜è®¤å‰åè¡Œ\n\n- `-n <lines>` æ˜¾ç¤ºå‰å¤šå°‘è¡Œ\n- `-c  <bytes>` æ˜¾ç¤ºå‰å¤šå°‘å­—èŠ‚\n\n`tail [é€‰é¡¹] <file>` æ˜¾ç¤ºæ–‡ä»¶çš„å°¾éƒ¨å†…å®¹ï¼Œé»˜è®¤ååè¡Œ\n\n- `-n <lines>` æ˜¾ç¤ºåå¤šå°‘è¡Œ\n- `-c  <bytes>` æ˜¾ç¤ºåå¤šå°‘å­—èŠ‚\n- `-f` å®æ—¶ç›‘æ§æ–‡ä»¶å˜åŒ–\n\n\n\n'>' è¾“å‡ºé‡å®šå‘ï¼ˆè¦†ç›–ï¼‰\n\n'>>' è¿½åŠ \n\n- `ls -l > æ–‡ä»¶` åˆ—è¡¨çš„å†…å®¹è¦†ç›–åˆ°æ–‡ä»¶\n- `ls -al >> æ–‡ä»¶` åˆ—è¡¨çš„å†…å®¹è¿½åŠ åˆ°æ–‡ä»¶\n- `cat æ–‡ä»¶1 > æ–‡ä»¶2` å°†æ–‡ä»¶1çš„å†…å®¹è¦†ç›–åˆ°æ–‡ä»¶2\n- `echo \"å†…å®¹\"  >> æ–‡ä»¶` è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶\n\n\n\nInæŒ‡ä»¤ï¼šè½¯é“¾æ¥ä¹Ÿç§°ä¸ºç¬¦å·é“¾æ¥ï¼Œç±»ä¼¼äºwindowsé‡Œçš„å¿«æ·æ–¹å¼ï¼Œä¸»è¦å­˜æ”¾äº†é“¾æ¥å…¶ä»–æ–‡ä»¶çš„è·¯å¾„\n\n- `ln -s <åŸæ–‡ä»¶/ç›®å½•> <è½¯é“¾æ¥å>` ç»™åŸæ–‡ä»¶/ç›®å½•åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥ï¼ˆpwdæŸ¥çœ‹ä»åœ¨åŸæ–‡ä»¶/ç›®å½•ï¼‰\n\n\n\n`history [æ•°é‡]` æŸ¥çœ‹å·²ç»æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤ï¼Œæ— å‚é»˜è®¤æ˜¾ç¤ºå…¨éƒ¨\n\n- `!<ç¼–å·>` æ‰§è¡Œå†å²å‘½ä»¤ä¸­ç¼–å·ä¸º<ç¼–å·>çš„å‘½ä»¤ï¼ˆå¦‚!5 æ‰§è¡Œç¼–å·ä¸º5çš„å‘½ä»¤ï¼‰\n\n## æ—¶é—´æ—¥æœŸæŒ‡ä»¤\n\n`date` æ˜¾ç¤ºå½“å‰æ—¶é—´\n`date +%Y` æ˜¾ç¤ºå½“å‰å¹´ä»½\n`date +%m` æ˜¾ç¤ºå½“å‰æœˆä»½\n`date +%d` æ˜¾ç¤ºå½“å‰æ˜¯å“ªä¸€å¤©\n`date \"+%Y-%m-%d %H:%M:%S\"` æ˜¾ç¤ºå¹´æœˆæ—¥æ—¶åˆ†ç§’\n`date -s <å­—ç¬¦ä¸²æ—¶é—´>` è®¾ç½®ç³»ç»Ÿå½“å‰æ—¶é—´\n\n\n\n`cal [é€‰é¡¹]` æ˜¾ç¤ºå½“å‰æ—¥å†ï¼Œæ— å‚é»˜è®¤æ˜¾ç¤ºå½“å‰æ—¶é—´æ—¥å†\n\n- `cal 2023` æ˜¾ç¤º2023å¹´æ—¥å†\n\n## æœç´¢æŸ¥æ‰¾æŒ‡ä»¤\n\n`find [èŒƒå›´] [é€‰é¡¹]` ä»æŒ‡å®šç›®å½•å‘ä¸‹é€’å½’éå†å…¶å„ä¸ªå­ç›®å½•æŸ¥æ‰¾\n\n- `-name <name>` æŒ‰ç…§æŒ‡å®šçš„æ–‡ä»¶åæŸ¥æ‰¾\n- `-user <user>` æŸ¥æ‰¾å±äºæŒ‡å®šç”¨æˆ·åçš„æ‰€æœ‰æ–‡ä»¶\n- `-size <size> `æŒ‰ç…§æŒ‡å®šçš„æ–‡ä»¶å¤§å°æŸ¥æ‰¾æ–‡ä»¶ï¼ˆå•ä½Kï¼ŒMï¼ŒGï¼‰\n  - `find / -size +200M `æŸ¥æ‰¾/ä¸‹å¤§äº200Mçš„æ–‡ä»¶ï¼Œ-200Mè¡¨ç¤ºå°äº200Mçš„æ–‡ä»¶\n\n`locate <file>` å¯ä»¥å¿«é€Ÿå®šä½æ–‡ä»¶è·¯å¾„ã€‚\n\n- locateæŒ‡ä»¤åˆ©ç”¨äº‹å…ˆå»ºç«‹çš„ç³»ç»Ÿä¸­æ‰€æœ‰æ–‡ä»¶åç§°åŠè·¯å¾„çš„locateæ•°æ®åº“å®ç°å¿«é€Ÿå®šä½ç»™å®šçš„æ–‡ä»¶ã€‚\n- locateæŒ‡ä»¤æ— éœ€éå†æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ,æŸ¥è¯¢é€Ÿåº¦è¾ƒå¿«ã€‚\n- ä¸ºäº†ä¿è¯æŸ¥è¯¢ç»“æœçš„å‡†ç¡®åº¦ï¼Œç®¡ç†å‘˜å¿…é¡»å®šæœŸæ›´æ–°locateæ—¶åˆ»\n- `updatedb` æ›´æ–°æ•°æ®åº“\n\n`which <cmd>` æŸ¥è¯¢æŸä¸ªæŒ‡ä»¤åœ¨å“ªä¸ªç›®å½•ä¸‹\n\n\n\n`grep [é€‰é¡¹] <å†…å®¹> <æºæ–‡ä»¶>` è¿‡æ»¤æŸ¥æ‰¾\n\n- `-n` æ˜¾ç¤ºåŒ¹é…è¡ŒåŠè¡Œå·\n- `-i` å¿½ç•¥å­—æ¯å¤§å°å†™\n\n\n\n`|`ç®¡é“ç¬¦ ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤æŸ¥è¯¢åˆ°çš„å†…å®¹äº¤ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤\n\n- `cat a.txt | grep \"hello\"`    catæŸ¥è¯¢åˆ°çš„å†…å®¹äº¤ç»™grepè¿›è¡Œè¿‡æ»¤æŸ¥æ‰¾\n\n## å‹ç¼©å’Œè§£å‹\n\n`gzip <file>` åªèƒ½å°†æ–‡ä»¶å‹ç¼©æˆ.gzæ–‡ä»¶\n\n`gunzip <file.gz>` è§£å‹.gzæ–‡ä»¶\n\n\n\n`zip [é€‰é¡¹] <name.zip> <file/dir>` å‹ç¼©æˆname.zipæ–‡ä»¶\n\n- `-r` é€’å½’å‹ç¼©ï¼Œå³å‹ç¼©ç›®å½•\n\n`unzip [é€‰é¡¹] <file.zip>` è§£å‹\n\n- `-d <dir>` æŒ‡å®šè§£å‹åå­˜æ”¾ç›®å½•\n\n\n\n`tar [é€‰é¡¹]` æ‰“åŒ…ã€å‹ç¼©æˆ–è§£å‹\n\n- `-c` äº§ç”Ÿ.taræ‰“åŒ…æ–‡ä»¶\n- `-v` æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯\n- `-f` æŒ‡å®šå‹ç¼©åçš„æ–‡ä»¶å\n- `-z` é€šè¿‡gzipæŒ‡ä»¤å¤„ç†å‹ç¼©è§£å‹\n- `-j` é€šè¿‡bzip2æŒ‡ä»¤å¤„ç†å‹ç¼©è§£å‹\n- `-x` è§£åŒ….taræ–‡ä»¶\n- `-C` æŒ‡å®šè§£å‹ç›®å½•\n- å¸¸è§ç”¨æ³•\n  - `tar -czvf <xxx.tar.gz> <file>...` å‹ç¼©æˆ.tar.gz\n  - `tar -xzvf <xxx.tar.gz>` è§£å‹\n  - `tar -tzvf <xxx.tar.gz>` åˆ—å‡ºå‹ç¼©æ–‡ä»¶å†…å®¹\n\n> [Linux tar å‘½ä»¤ |  èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/linux/linux-comm-tar.html)\n\n## Linuxç»„(æƒé™)\n\n### åŸºæœ¬å†…å®¹\n\nåœ¨linuxä¸­çš„æ¯ä¸ªç”¨æˆ·å¿…é¡»å±äºä¸€ä¸ªç»„ï¼Œä¸èƒ½ç‹¬ç«‹äºç»„å¤–ã€‚åœ¨linuxä¸­æ¯ä¸ªæ–‡æ¡£/æ–‡ä»¶æœ‰æ‰€æœ‰è€…ã€æ‰€å±ç»„ã€å…¶å®ƒç»„çš„æ¦‚å¿µã€‚\n\n\n\n`ls -ahl`æ˜¾ç¤ºæ ¼å¼è§£é‡Šå¦‚ä¸‹ï¼š\n\n| æ–‡æ¡£/æ–‡ä»¶å±æ€§ | é“¾æ¥æ•° | æ‰€æœ‰è€…  | æ‰€å±ç»„  | å¤§å° |   ä¿®æ”¹æ—¶é—´    |\n| :-----------: | :----: | :-----: | :-----: | :--: | :-----------: |\n|  drwx------.  |   16   | wshape1 | wshape1 | 4.0K | 1æœˆ  25 14:17 |\n|  -rw-r--r--.  |   1    |  root   |  root   | 15K  | 1æœˆ  25 17:03 |\n\n![](https://www.runoob.com/wp-content/uploads/2014/06/file-llls22.jpg)\n\næ–‡æ¡£å±æ€§ï¼š\n\n- ç¬¬ä¸€ä½ï¼šè¡¨ç¤ºæ–‡æ¡£ç±»å‹\n  - d ç›®å½•\n  - -æ–‡ä»¶\n  - l é“¾æ¥æ–‡æ¡£\n  - b è£…ç½®æ–‡ä»¶é‡Œé¢çš„å¯ä¾›å‚¨å­˜çš„æ¥å£è®¾å¤‡(å¯éšæœºå­˜å–è£…ç½®)ï¼ˆå—æ–‡ä»¶ï¼‰\n  - c è£…ç½®æ–‡ä»¶é‡Œé¢çš„ä¸²è¡Œç«¯å£è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡(ä¸€æ¬¡æ€§è¯»å–è£…ç½®)ï¼ˆå­—ç¬¦è®¾å¤‡ï¼‰\n- ç¬¬2åˆ°4ä½ï¼šæ‰€æœ‰è€…æƒé™\n- ç¬¬3åˆ°5ä½ï¼šæ‰€å±ç»„æƒé™\n- ç¬¬6åˆ°8ä½ï¼šå…¶ä»–ç»„æƒé™\n\n![](https://www.runoob.com/wp-content/uploads/2014/06/363003_1227493859FdXT.png)\n\n**rwxä½œç”¨åˆ°æ–‡ä»¶**\n\n1. [**r**]ä»£è¡¨å¯è¯»(read):å¯ä»¥è¯»å–,æŸ¥çœ‹å­—\n2. [**w**]ä»£è¡¨å¯å†™(write)ï¼šå¯ä»¥ä¿®æ”¹ï¼Œä½†æ˜¯ä¸ä»£è¡¨å¯ä»¥åˆ é™¤è¯¥æ–‡ä»¶,åˆ é™¤ä¸€ä¸ªæ–‡ä»¶çš„å‰ææ¡ä»¶æ˜¯å¯¹è¯¥æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æœ‰å†™æƒé™ï¼Œæ‰èƒ½åˆ é™¤è¯¥æ–‡ä»¶.\n3. [**x**]ä»£è¡¨å¯æ‰§è¡Œ(execute):å¯ä»¥è¢«æ‰§è¡Œ\n\n**rwxä½œç”¨åˆ°ç›®å½•**\n\n1. [**r**]ä»£è¡¨å¯è¯»(read)ï¼šå¯ä»¥è¯»å–ï¼ŒIsæŸ¥çœ‹ç›®å½•å†…å®¹ ï¼ˆä½†æ˜¯ä¸èƒ½è¿›å…¥ç›®å½•ï¼‰\n2. [**w**]ä»£è¡¨å¯å†™(write)ï¼š å¯ä»¥ä¿®æ”¹,å¯¹ç›®å½•å†…åˆ›å»º+åˆ é™¤+é‡å‘½åç›®å½•\n3. [**x**]ä»£è¡¨å¯æ‰§è¡Œ(execute)ï¼šå¯ä»¥è¿›å…¥è¯¥ç›®å½• ï¼ˆä½†æ˜¯ä¸èƒ½æŸ¥çœ‹ç›®å½•å†…å®¹ï¼‰\n\n\n\n### å¸¸ç”¨æŒ‡ä»¤\n\n`chown [é€‰é¡¹] <user> <file/dir>` ä¿®æ”¹æ–‡ä»¶/ç›®å½•æ‰€æœ‰è€…\n\n- `chown [é€‰é¡¹] <newOwner>:<newGroup> <file/dir>` åŒæ—¶ä¿®æ”¹æ‰€æœ‰è€…ä¸æ‰€å±ç»„\n\n`chgrp [é€‰é¡¹] <group> <file/dir>` ä¿®æ”¹æ–‡ä»¶/ç›®å½•æ‰€åœ¨ç»„ \n\n`chmod [é€‰é¡¹] <æƒé™> <file/dir>` ä¿®æ”¹æ–‡ä»¶/ç›®å½•æƒé™\n\n- rwxæ–¹å¼å˜æ›´æƒé™uï¼šæ‰€æœ‰è€…ï¼Œgï¼šæ‰€å±ç»„ï¼Œoï¼šå…¶å®ƒç»„ï¼Œaï¼šæ‰€æœ‰äººï¼ˆu g oçš„æ€»å’Œï¼‰\n  - ä¾‹ï¼š`chmod u=rwx, g=rx, o=x <æ–‡ä»¶/ç›®å½•>` ç»™u g oåˆ†åˆ«èµ‹äºˆrwx rx xæƒé™\n  - ä¾‹ï¼š`chmod o+w <æ–‡ä»¶/ç›®å½•>` ç»™oå¢åŠ wæƒé™\n  - ä¾‹ï¼š`chmod a-x <æ–‡ä»¶/ç›®å½•>` ç»™aç§»é™¤xæƒé™\n- æ•°å­—æ–¹å¼å˜æ›´æƒé™r=4 w=2 x=1ï¼Œrwx=4+2+1=7\n  - ä¾‹ï¼š`chmod 751<æ–‡ä»¶/ç›®å½•>` ç­‰åŒäºu=rwx, g=rx, o=x\n\n\n\nä»¥ä¸Šä¸‰ä¸ªæŒ‡ä»¤å…±æœ‰é€‰é¡¹ï¼š\n\n- -R é€’å½’ä¿®æ”¹ç›®å½•å†…å†…å®¹æƒé™\n\n\n\nä¿®æ”¹æƒé™åç”¨æˆ·ä»æ— æ³•æ§åˆ¶åˆ™å¯èƒ½éœ€è¦é‡æ–°ç™»é™†\n\n## å®šæ—¶ä»»åŠ¡è°ƒåº¦\n\n**ä»»åŠ¡è°ƒåº¦**ï¼šæ˜¯æŒ‡ç³»ç»Ÿåœ¨æŸä¸ªæ—¶é—´æ‰§è¡Œçš„ç‰¹å®šçš„å‘½ä»¤æˆ–ç¨‹åºã€‚\n\n**ä»»åŠ¡è°ƒåº¦åˆ†ç±»**:\n\n1. ç³»ç»Ÿå·¥ä½œ:æœ‰äº›é‡è¦çš„å·¥ä½œå¿…é¡»å‘¨è€Œå¤å§‹åœ°æ‰§è¡Œã€‚å¦‚ç—…æ¯’æ‰«æç­‰\n2. ä¸ªåˆ«ç”¨æˆ·å·¥ä½œï¼šä¸ªåˆ«ç”¨æˆ·å¯èƒ½å¸Œæœ›æ‰§è¡ŒæŸäº›ç¨‹åºï¼Œæ¯”å¦‚å¯¹mysqlæ•°æ®åº“çš„å¤‡ä»½\n\n### crondä»»åŠ¡è°ƒåº¦\n\n>  [Linux crontab å‘½ä»¤ | èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/linux/linux-comm-crontab.html)\n\n`crontab [é€‰é¡¹]`\n\n- `-e` ç¼–è¾‘å®šæ—¶ä»»åŠ¡\n- `-l` æŸ¥è¯¢å®šæ—¶ä»»åŠ¡\n- `-r` åˆ é™¤å½“å‰ç”¨æˆ·æ‰€æœ‰çš„å®šæ—¶ä»»åŠ¡\n\nservice crond restart é‡å¯crond\n\n\n\n**è°ƒåº¦æ–‡ä»¶ï¼š**\n\n- æ–‡ä»¶å†…å®¹æ ¼å¼ï¼š`f1 f2 f3 f4 f5 program`  f1--5ä¸ºæ—¶é—´æ ¼å¼programä¸ºæ‰§è¡Œç¨‹åº\n\n- æ—¶é—´å ä½ç¬¦ï¼ˆæ—¶é—´æ ¼å¼ï¼‰\n\n  ```pseudocode\n  *    *    *    *    *\n  -    -    -    -    -\n  |    |    |    |    |\n  |    |    |    |    +----- æ˜ŸæœŸä¸­æ˜ŸæœŸå‡  (0 - 6) (æ˜ŸæœŸå¤© ä¸º0)\n  |    |    |    +---------- æœˆä»½ (1 - 12) \n  |    |    +--------------- ä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ å¤© (1 - 31)\n  |    +-------------------- å°æ—¶ (0 - 23)\n  +------------------------- åˆ†é’Ÿ (0 - 59)\n  ```\n\n- æ—¶é—´æ ¼å¼ç‰¹æ®Šç¬¦å·\n  \n  \n  | ç‰¹æ®Šç¬¦å· | å«ä¹‰                                                         |\n  | -------- | ------------------------------------------------------------ |\n  | *        | ä»£è¡¨ä»»ä½•æ—¶é—´ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ªâ€œ*â€å°±ä»£è¡¨ä¸€å°æ—¶ä¸­æ¯åˆ†é’Ÿéƒ½æ‰§è¡Œä¸€æ¬¡çš„æ„æ€ã€‚ |\n  | ,        | ä»£è¡¨ä¸è¿ç»­çš„æ—¶é—´ã€‚æ¯”å¦‚â€œ0 8,12,16 * * * å‘½ä»¤â€ï¼Œå°±ä»£è¡¨åœ¨æ¯å¤©çš„8ç‚¹0åˆ†ï¼Œ12ç‚¹0åˆ†ï¼Œ16ç‚¹0åˆ†éƒ½æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ |\n  | -        | ä»£è¡¨è¿ç»­çš„æ—¶é—´èŒƒå›´ã€‚æ¯”å¦‚\"05 * * 1-6å‘½ä»¤\" ,ä»£è¡¨åœ¨å‘¨ä¸€åˆ°å‘¨å…­çš„å‡Œæ™¨5ç‚¹0åˆ†æ‰§è¡Œå‘½ä»¤ |\n  | */n      | ä»£è¡¨æ¯éš”å¤šä¹…æ‰§è¡Œä¸€æ¬¡ã€‚æ¯”å¦‚â€œ*/10 * * * * å‘½ä»¤â€ï¼Œä»£è¡¨æ¯éš”10åˆ†é’Ÿå°±æ‰§è¡Œä¸€éå‘½ä»¤ |\n\n\n\n### atå®šæ—¶ä»»åŠ¡\n\n1. atå‘½ä»¤æ˜¯ä¸€æ¬¡æ€§å®šæ—¶è®¡åˆ’ä»»åŠ¡,atçš„å®ˆæŠ¤è¿›ç¨‹atdä¼šä»¥åå°æ¨¡å¼è¿è¡Œ,æ£€æŸ¥ä½œä¸šé˜Ÿåˆ—æ¥è¿è¡Œã€‚\n2. é»˜è®¤æƒ…å†µä¸‹ï¼Œatdå®ˆæŠ¤è¿›ç¨‹æ¯60ç§’æ£€æŸ¥ä½œä¸šé˜Ÿåˆ—ï¼Œæœ‰ä½œä¸šæ—¶ï¼Œä¼šæ£€æŸ¥ä½œä¸šè¿è¡Œæ—¶é—´ï¼Œå¦‚æœæ—¶é—´ä¸å½“å‰æ—¶é—´åŒ¹é…ï¼Œåˆ™è¿è¡Œæ­¤ä½œä¸šã€‚\n3. atå‘½ä»¤æ˜¯ä¸€æ¬¡æ€§å®šæ—¶è®¡åˆ’ä»»åŠ¡ï¼Œæ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡åä¸å†æ‰§è¡Œæ­¤ä»»åŠ¡äº†ã€‚\n4. åœ¨ä½¿ç”¨atå‘½ä»¤çš„æ—¶å€™,ä¸€å®šè¦ä¿è¯atdè¿›ç¨‹çš„å¯åŠ¨,å¯ä»¥ä½¿ç”¨ç›¸å…³æŒ‡ä»¤ï¼ˆ`ps -ef | grep atd`ï¼‰æ¥æŸ¥çœ‹ã€‚\n\n\n\n`at [é€‰é¡¹] [æ—¶é—´]` è®¾ç½®å®šæ—¶ä»»åŠ¡ ï¼ˆCtrl+Dç»“æŸå‘½ä»¤è¾“å…¥ï¼‰\n\n- `-m` å½“æŒ‡å®šçš„ä»»åŠ¡è¢«å®Œæˆåï¼Œå°†ç»™ç”¨æˆ·å‘é€é‚®ä»¶ï¼Œå³ä½¿æ²¡æœ‰æ ‡å‡†è¾“å‡º\n- `-I` æ˜¾ç¤ºå¾…æ‰§è¡Œä»»åŠ¡çš„åˆ—è¡¨ (åŒatqå‘½ä»¤)\n- `-d` åˆ é™¤æŒ‡å®šçš„å¾…æ‰§è¡Œä»»åŠ¡ï¼ˆåŒatrmå‘½ä»¤ï¼‰\n- `-v` æ˜¾ç¤ºä»»åŠ¡å°†è¢«æ‰§è¡Œçš„æ—¶é—´\n- `-c` æ‰“å°ä»»åŠ¡çš„å†…å®¹åˆ°æ ‡å‡†è¾“å‡º\n- `-V` æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯\n- `-q <é˜Ÿåˆ—>` ä½¿ç”¨æŒ‡å®šçš„é˜Ÿåˆ—\n- `-f <æ–‡ä»¶>` ä»æŒ‡å®šæ–‡ä»¶è¯»å…¥ä»»åŠ¡è€Œä¸æ˜¯ä»æ ‡å‡†è¾“å…¥è¯»å…¥\n- `-t <æ—¶é—´å‚æ•°>` ä»¥æ—¶é—´å‚æ•°çš„å½¢å¼æäº¤è¦è¿è¡Œçš„ä»»åŠ¡\n\næ—¶é—´è¡¨è¾¾å¼ï¼š\n\n- YYMMDDhhmm[.ss]ï¼ˆç¼©å†™å¹´ã€æœˆã€æ—¥ã€å°æ—¶ã€åˆ†é’Ÿ[ç§’]ï¼‰\n- CCYYMMDDhhmm[.ss]ï¼ˆå®Œæ•´å¹´ã€æœˆã€æ—¥ã€å°æ—¶ã€åˆ†é’Ÿå’Œ[ç§’]ï¼‰\n- now\n- midnight\n- noon\n- teatime (4:00PM)\n- tomorrow\n- AM\n- PM\n- å¯ä»¥æ·»åŠ ä¸€ä¸ª+ä½¿å®ƒä»¬ç›¸å¯¹äºæŸä¸ªæ—¶é—´ï¼Œä¸‹é¢æ˜¯å¯ç”¨å•ä½ï¼š\n  - minutes\n  - hours\n  - days\n  - weeks\n  - months\n  - years\n\n```pseudocode\n$ echo \"rsync -av /home/tux me@myserver:/home/tux/\" | at 3:30 AM tomorrow\n$ echo \"/opt/batch.sh ~/Pictures\" | at 3:30 AM 08/01/2022\n$ echo \"echo hello\" | at now + 3 days\n```\n\n>  [Linux atå‘½ä»¤è¯¦è§£ - è®¸è‰¯Linux](https://www.cnblogs.com/yychuyu/p/15483186.html)\n\n## ç£ç›˜ç®¡ç†\n\n\n\n### ç£ç›˜åˆ†åŒº\n\n**åŸç†ä»‹ç»:**\n\n1. Linuxæ¥è¯´æ— è®ºæœ‰å‡ ä¸ªåˆ†åŒºï¼Œåˆ†ç»™å“ªä¸€ç›®å½•ä½¿ç”¨ï¼Œå®ƒå½’æ ¹ç»“åº•å°±åªæœ‰ä¸€ä¸ªæ ¹ç›®å½•ï¼Œä¸€ä¸ªç‹¬ç«‹ä¸”å”¯ä¸€çš„æ–‡ä»¶ç»“æ„ï¼ŒLinuxä¸­æ¯ä¸ªåˆ†åŒºéƒ½æ˜¯ç”¨æ¥ç»„æˆæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚\n2. Linuxé‡‡ç”¨äº†ä¸€ç§å«â€œè½½å…¥â€çš„å¤„ç†æ–¹æ³•,å®ƒçš„æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­åŒ…å«äº†ä¸€æ•´å¥—çš„æ–‡ä»¶å’Œç›®å½•ï¼Œä¸”å°†ä¸€ä¸ªåˆ†åŒºå’Œä¸€ä¸ªç›®å½•è”ç³»èµ·æ¥ã€‚è¿™æ—¶è¦è½½å…¥çš„ä¸€ä¸ªåˆ†åŒºå°†ä½¿å®ƒçš„å­˜å‚¨ç©ºé—´åœ¨ä¸€ä¸ªç›®å½•ä¸‹è·å¾—ã€‚\n\n**ç¡¬ç›˜è¯´æ˜ï¼š**\n\n1. Linuxç¡¬ç›˜åˆ†IDEç¡¬ç›˜å’ŒSCSIç¡¬ç›˜ï¼Œç›®å‰åŸºæœ¬ä¸Šæ˜¯SCSIç¡¬ç›˜\n2. å¯¹äºIDEç¡¬ç›˜,é©±åŠ¨å™¨æ ‡è¯†ç¬¦ä¸º\"hdx~\",å…¶ä¸­\"hd\"è¡¨æ˜åˆ†åŒºæ‰€åœ¨è®¾å¤‡çš„ç±»å‹,è¿™é‡Œæ˜¯æŒ‡IDEç¡¬ç›˜äº†ã€‚\"xâ€ä¸ºç›˜å·ï¼ˆaä¸ºåŸºæœ¬ç›˜ï¼Œbä¸ºåŸºæœ¬ä»å±ç›˜ï¼Œcä¸ºè¾…åŠ©ä¸»ç›˜ï¼Œdä¸ºè¾…åŠ©ä»å±ç›˜ï¼‰ï¼Œ\"~â€ä»£è¡¨åˆ†åŒºå‰å››ä¸ªåˆ†åŒºç”¨æ•°å­—1åˆ°4è¡¨ç¤ºï¼Œå®ƒä»¬æ˜¯ä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒºï¼Œä»5å¼€å§‹å°±æ˜¯é€»è¾‘åˆ†åŒºã€‚ä¾‹ï¼Œhda3è¡¨ç¤ºä¸ºç¬¬ä¸€ä¸ªIDEç¡¬ç›˜ä¸Šçš„ç¬¬ä¸‰ä¸ªä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒº,hdb2è¡¨ç¤ºä¸ºç¬¬äºŒä¸ªIDEç¡¬ç›˜ä¸Šçš„ç¬¬äºŒä¸ªä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒºã€‚\n3. å¯¹äºSCSIç¡¬ç›˜åˆ™æ ‡è¯†ä¸ºâ€œsdx~â€,SCSIç¡¬ç›˜æ˜¯ç”¨â€œsd\"æ¥è¡¨ç¤ºåˆ†åŒºæ‰€åœ¨è®¾å¤‡çš„ç±»å‹çš„ï¼Œå…¶ä½™åˆ™å’ŒIDEç¡¬ç›˜çš„è¡¨ç¤ºæ–¹æ³•ä¸€æ ·ã€‚\n\n\n\n**æŸ¥çœ‹æ‰€æœ‰è®¾å¤‡æŒ‚è½½æƒ…å†µ**\n\n- `lsblk`\n\n- `lsblk -f`\n\n\n\n**åˆ†åŒºå‘½ä»¤ï¼š**\n\n- `fdisk /dev/sdx `\n- å¼€å§‹å¯¹/sdxåˆ†åŒº\n  - m æ˜¾ç¤ºå‘½ä»¤åˆ—è¡¨\n  - p æ˜¾ç¤ºç£ç›˜åˆ†åŒº\n  - n æ–°å¢åˆ†åŒº\n  - d åˆ é™¤åˆ†åŒº\n  - w å†™å…¥å¹¶é€€å‡º\n\n**æ ¼å¼åŒ–ç£ç›˜ï¼š**\n\n`mkfs -t <åˆ†åŒºç±»å‹> /dev/sdx~`\n\n- åˆ†åŒºç±»å‹ï¼šext2ã€ext3ã€ext4ã€reiserfsã€nfsã€vfat\n\n**æŒ‚è½½åˆ†åŒºï¼š**\n\n`mount <è®¾å¤‡> <ç›®å½•>`\n\n- `mount /dev/sdx~ <dir>`\n\n- **é‡å¯ç³»ç»Ÿåå¤±æ•ˆ**\n\n- **æ°¸ä¹…æŒ‚è½½åˆ†åŒºï¼š**\n\n  - ä¿®æ”¹/etc/fstab \n\n  - æ·»åŠ è¡Œï¼Œè¡Œæ ¼å¼ï¼š`UUIDæˆ–è€…è®¾å¤‡åç§° æŒ‚è½½ç›®å½• åˆ†åŒºç±»å‹ æ–‡ä»¶ç³»ç»Ÿçš„å‚æ•° èƒ½å¦è¢«dumpå¤‡ä»½å‘½ä»¤ä½œç”¨ æ˜¯å¦æ£€æµ‹æ‰‡åŒº `\n    å¦‚ï¼š`/dev/sdx~ /newdisk ext4 defaults 0 0 `\n\n  - æ‰§è¡Œmount -a æˆ–é‡å¯ç³»ç»Ÿ\n\n  - > [/etc/fstabæ–‡ä»¶çš„è¯¦è§£_éŸ©å¸…å¹³çš„åšå®¢-CSDNåšå®¢_/etc/fstab](https://blog.csdn.net/youmatterhsp/article/details/83933158)\n\n**å¸è½½åˆ†åŒºï¼š**\n\n`umount <è®¾å¤‡>`\n\n`umount <è¢«æŒ‚è½½ç›®å½•>`\n\n### ç£ç›˜ä½¿ç”¨æƒ…å†µ\n\n`df -Th` æŸ¥çœ‹æ•´ä½“ç£ç›˜ä½¿ç”¨æƒ…å†µ\n\n`du [é€‰é¡¹] [dir]` æŸ¥çœ‹æŒ‡å®šç›®å½•çš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•\n\n- `-s` æŒ‡å®šç›®å½•å ç”¨å¤§å°æ±‡æ€»\n\n- `-h` å¸¦è®¡é‡å•ä½\n\n- `-a` å«æ–‡ä»¶\n\n- `--max-depth=1` å­ç›®å½•æ·±åº¦\n\n- `-c` åˆ—å‡ºæ˜ç»†çš„åŒæ—¶ï¼Œå¢åŠ æ±‡æ€»å€¼\n\n- > [Linux ç£ç›˜ç®¡ç† | èœé¸Ÿæ•™ç¨‹ (runoob.com)](https://www.runoob.com/linux/linux-filesystem.html)\n\n### å®ç”¨æŒ‡ä»¤\n\n1. ç»Ÿè®¡/optæ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„ä¸ªæ•°\n   `ls -l /opt | grep \"^-\" | wc -l`\n2. ç»Ÿè®¡/optæ–‡ä»¶å¤¹ä¸‹ç›®å½•çš„ä¸ªæ•°\n   `ls -l /opt | grep \"^d\" | wc -l`\n3. ç»Ÿè®¡/optæ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„ä¸ªæ•°ï¼ŒåŒ…æ‹¬å­æ–‡ä»¶å¤¹é‡Œçš„\n   `ls -lR /opt | grep \"^-\" | wc -l`\n4. ç»Ÿè®¡/optæ–‡ä»¶å¤¹ä¸‹ç›®å½•çš„ä¸ªæ•°ï¼ŒåŒ…æ‹¬å­æ–‡ä»¶å¤¹é‡Œçš„\n   `ls -lR /opt | grep \"^d\" | wc -l`\n5. ä»¥æ ‘çŠ¶æ˜¾ç¤ºç›®å½•ç»“æ„treeç›®å½•ï¼Œå¯èƒ½éœ€è¦æ‰§è¡Œ`yum install tree`å®‰è£…\n\n> [Linux wcå‘½ä»¤ | èœé¸Ÿæ•™ç¨‹ (runoob.com)](https://www.runoob.com/linux/linux-comm-wc.html)\n\n\n\n## ç½‘ç»œé…ç½®\n\nNAT(Network Address Translation)ç½‘ç»œé…ç½®\n\n{% mermaid %}\n\nflowchart LR\n\tsubgraph ç”µè„‘Windows\n\t\tlinux(Linuxè™šæ‹Ÿ\\n192.168.245.128) --> vmnet(VMnet8\\n192.168.245.1)\n        vmnet --> linux\n        wk([æ— çº¿ç½‘å¡\\n192.168.31.122])\n        vmnet --> wk\n\tend\n\tsubgraph å±€åŸŸç½‘\n\t\twk --> wg(ç½‘å…³)\n\tend\n\twg --> three[äº’è”ç½‘\\nbaidu.com\\n...]\n\n{% endmermaid %}\n\n`ifconfig` æŸ¥çœ‹ç½‘ç»œé…ç½®\n\n`ping <ip>` æµ‹è¯•å½“å‰ä¸»æœºæ˜¯å¦å¯ä»¥äºç›®æ ‡ipè¿›è¡Œé€šè®¯\n\n\n\n### IPé…ç½®\n\n- è‡ªåŠ¨è·å–ï¼š\n\n  - ç™»é™†åï¼Œé€šè¿‡ç•Œé¢çš„æ¥è®¾ç½®è‡ªåŠ¨è·å–ip\n  - ç‰¹ç‚¹ï¼šlinuxå¯åŠ¨åä¼šè‡ªåŠ¨è·å–IP\n  - ç¼ºç‚¹æ˜¯æ¯æ¬¡è‡ªåŠ¨è·å–çš„ipåœ°å€å¯èƒ½ä¸ä¸€æ ·ã€‚\n\n- æ‰‹åŠ¨é…ç½®ï¼š\n\n  - å›¾å½¢åŒ–ï¼šç½‘ç»œè®¾ç½®é‡Œé…ç½®\n\n  - ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æŒ‡å®šIPå¹¶å¯ä»¥è¿æ¥åˆ°å¤–ç½‘(ç¨‹åºå‘˜æ¨è)\n    - ç¼–è¾‘/etc/sysconfig/network-scripts/ifcfg-ens33ï¼ˆå¦‚ä¿®æ”¹ä¸º192.168.245.2ï¼‰\n      - ä¿®æ”¹IPV4é…ç½®æ–¹å¼`BOOTPROTO=\"static\"`\n      - ä¿®æ”¹IPåœ°å€`IPADDR=192.168.245.128`\n      - ä¿®æ”¹ç½‘å…³`GATEWAY=192.168.245.2`\n      - ä¿®æ”¹DNS`DNS=192.168.245.2`\n      - è™šæ‹Ÿæœºçš„è®°å¾—è¦é…ç½®è™šæ‹Ÿæœºç½‘ç»œç›¸å…³é…ç½®\n      - `service network restart`æˆ–é‡å¯ç³»ç»Ÿ\n\n### ä¸»æœºåä¸hostsæ˜ å°„\n\n**æŸ¥çœ‹ä¸»æœºåï¼š**\n\n- `hostname`\n\n**ä¿®æ”¹ä¸»æœºåï¼š**\n\n- ä¿®æ”¹æ–‡ä»¶/etc/hostname\n- é‡å¯ç³»ç»Ÿ\n\n**ä¿®æ”¹hostsæ˜ å°„ï¼š**\n\n- ç¼–è¾‘é…ç½®æ–‡ä»¶/etc/hosts\n- è¡Œæ ¼å¼ï¼š`ip  åŸŸå(ä¸»æœºå)`\n\n## è¿›ç¨‹ç®¡ç†\n\nåœ¨Linuxä¸­ï¼Œæ¯ä¸ªæ‰§è¡Œçš„ç¨‹åºéƒ½ç§°ä¸ºä¸€ä¸ªè¿›ç¨‹ã€‚æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½åˆ†é…ä¸€ä¸ªIDå·(pid,è¿›ç¨‹å·)ã€‚\n\næ¯ä¸ªè¿›ç¨‹éƒ½å¯èƒ½ä»¥ä¸¤ç§æ–¹å¼å­˜åœ¨çš„ã€‚å‰å°ä¸åå°ï¼Œæ‰€è°“å‰å°è¿›ç¨‹å°±æ˜¯ç”¨æˆ·ç›®å‰çš„å±å¹•ä¸Šå¯ä»¥è¿›è¡Œæ“ä½œçš„ã€‚åå°è¿›ç¨‹åˆ™æ˜¯å®é™…åœ¨æ“ä½œï¼Œä½†ç”±äºå±å¹•ä¸Šæ— æ³•çœ‹åˆ°çš„è¿›ç¨‹ï¼Œé€šå¸¸ä½¿ç”¨åå°æ–¹å¼æ‰§è¡Œã€‚\n\n\n\n`ps [é€‰é¡¹]` æ˜¾ç¤ºç›®å‰ç³»ç»Ÿæ­£åœ¨è¿è¡Œçš„ç¨‹åº\n\n- `-a ` æ˜¾ç¤ºå½“å‰ç»ˆç«¯çš„æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯\n- `-u` ä»¥ç”¨æˆ·çš„æ ¼å¼æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯\n- `-x` æ˜¾ç¤ºåå°è¿›ç¨‹è¿è¡Œçš„å‚æ•°\n- `-w` ä¸é™åˆ¶è¾“å‡ºå®½åº¦\n- `-e` æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹\n- `-f` å…¨æ ¼å¼è¾“å‡ºï¼ŒåŒ…æ‹¬å‘½ä»¤\n- å¯»æ‰¾æŒ‡å®šè¿›ç¨‹ï¼š`ps -ef | grep <å…³é”®è¯>`\n- `ps -aux`è¾“å‡ºæ ¼å¼ï¼š`USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND`\n  - USER: è¿›ç¨‹æ‰§è¡Œç”¨æˆ·\n  - PID: è¿›ç¨‹å·\n  - %CPU: å ç”¨çš„ CPU ä½¿ç”¨ç‡\n  - %MEM: å ç”¨çš„ç‰©ç†å†…å­˜ä½¿ç”¨ç‡\n  - VSZ: å ç”¨çš„è™šæ‹Ÿå†…å­˜å¤§å° (KB)\n  - RSS: å ç”¨çš„ç‰©ç†å†…å­˜å¤§å° (KB)\n  - TTY: ç»ˆç«¯çš„æ¬¡è¦è£…ç½®å·ç  (minor device number of tty)\n  - STAT: è¯¥è¡Œç¨‹çš„çŠ¶æ€:\n    - D: æ— æ³•ä¸­æ–­çš„ä¼‘çœ çŠ¶æ€ (é€šå¸¸ IO çš„è¿›ç¨‹)\n    - R: æ­£åœ¨æ‰§è¡Œä¸­ running\n    - S: é™æ­¢çŠ¶æ€ sleep\n    - T: æš‚åœæ‰§è¡Œ\n    - Z: ä¸å­˜åœ¨ä½†æš‚æ—¶æ— æ³•æ¶ˆé™¤ï¼ˆåƒµå°¸è¿›ç¨‹ï¼‰\n    - W: æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜åˆ†é¡µå¯åˆ†é…\n    - <: é«˜ä¼˜å…ˆåºçš„è¿›ç¨‹\n    - N: ä½ä¼˜å…ˆåºçš„è¿›ç¨‹\n    - L: æœ‰å†…å­˜åˆ†é¡µåˆ†é…å¹¶é”åœ¨å†…å­˜å†… (å®æ—¶ç³»ç»Ÿæˆ–æ±A I/O)\n  - START: è¿›ç¨‹å¼€å§‹æ—¶é—´\n  - TIME: æ‰§è¡Œçš„æ—¶é—´\n  - COMMAND:æ‰€æ‰§è¡Œçš„æŒ‡ä»¤ï¼ˆè¿‡é•¿ä¼šè¢«æˆªæ–­ï¼‰\n\n**çˆ¶å­è¿›ç¨‹**\n\n- ps -ef æŸ¥çœ‹ \n- PPIDè¡¨ç¤ºçˆ¶è¿›ç¨‹pid\n\n**ç»ˆæ­¢è¿›ç¨‹**\n\n- `kill [é€‰é¡¹] <pid>` ç»ˆæ­¢è¿›ç¨‹\n  - `-9` å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹\n- `killall <ç¨‹åºå>` é€šè¿‡è¿›ç¨‹åç§°æ€æ­»è¿›ç¨‹ï¼Œä¹Ÿæ”¯æŒé€šé…ç¬¦ï¼Œè¿™åœ¨ç³»ç»Ÿå› è´Ÿè½½è¿‡å¤§è€Œå˜å¾—å¾ˆæ…¢æ—¶å¾ˆæœ‰ç”¨\n\n**æŸ¥çœ‹è¿›ç¨‹æ ‘**\n\n- `pstree [é€‰é¡¹]` æŸ¥çœ‹è¿›ç¨‹æ ‘\n  - `-p` æ˜¾ç¤ºè¿›ç¨‹çš„PID\n  - `-u` æ˜¾ç¤ºè¿›ç¨‹çš„æ‰€å±ç”¨æˆ·\n\n### åŠ¨æ€è¿›ç¨‹ç®¡ç†\n\n`top [é€‰é¡¹]` å®æ—¶æ›´æ–°æ˜¾ç¤ºè¿›ç¨‹\n\n- `-d <ç§’>` æŒ‡å®šæ›´æ–°é—´éš”\n- `-i` ä¸æ˜¾ç¤ºä»»ä½•é—²ç½®æˆ–è€…åƒµå°¸è¿›ç¨‹\n- `-p <pid>` ç›‘æ§æŒ‡å®špidçš„è¿›ç¨‹ \n- `-n` æ›´æ–°å‡ æ¬¡åé€€å‡º\n\næ˜¾ç¤ºå¤´ï¼š\n\n```pseudocode\ntop - 11:13:24 up 37 min,  1 user,  load average: 0.00, 0.01, 0.03\nTasks: 224 total,   1 running, 223 sleeping,   0 stopped,   0 zombie\n%Cpu(s):  0.0 us,  0.1 sy,  0.0 ni, 99.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  2027680 total,  1168104 free,   478228 used,   381348 buff/cache\nKiB Swap:  2097148 total,  2097148 free,        0 used.  1389524 avail Mem \n\n   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n```\n\n**äº¤äº’æ“ä½œï¼š**\n\n- `P`ä»¥%CPUæ’åºï¼Œé»˜è®¤å°±æ˜¯æ­¤é¡¹\n- `M`ä»¥%MEMæ’åº\n- `N`ä»¥PIDæ’åº\n- `u` æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„è¿›ç¨‹\n- `k` åˆ é™¤æŒ‡å®šPIDçš„è¿›ç¨‹\n- `q` é€€å‡º\n\n### æœåŠ¡ç®¡ç†\n\næœåŠ¡(service)æœ¬è´¨å°±æ˜¯è¿›ç¨‹ï¼Œä½†æ˜¯æ˜¯è¿è¡Œåœ¨åå°çš„ï¼Œé€šå¸¸éƒ½ä¼šç›‘å¬æŸä¸ªç«¯å£ï¼Œç­‰å¾…å…¶å®ƒç¨‹åºçš„è¯·æ±‚ï¼Œæ¯”å¦‚ï¼ˆmysqldï¼Œsshd é˜²ç«å¢™ç­‰ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬åˆç§°ä¸ºå®ˆæŠ¤è¿›ç¨‹ï¼Œæ˜¯Linuxä¸­éå¸¸é‡è¦çš„çŸ¥è¯†ç‚¹ã€‚\n\n#### serviceç®¡ç†æŒ‡ä»¤\n\n- `service <æœåŠ¡å> <start | stop | restart | reload | status>`\n\nserviceæŒ‡ä»¤ç®¡ç†çš„æœåŠ¡åœ¨/etc/init.d/æŸ¥çœ‹ï¼ˆ`ll /etc/init.d/`ï¼‰\n\n**æŸ¥çœ‹ç³»ç»ŸæœåŠ¡**\n\n- `setup`\n\n**å¼€æœºæµç¨‹ï¼š**\n\n{% mermaid %}\n\ngraph LR\n    å¼€æœº ==> BIOS ==> /boot ==> systemdè¿›ç¨‹ ==> è¿è¡Œçº§åˆ« ==> è¿è¡Œçº§åˆ«å¯¹åº”çš„æœåŠ¡\n\n{% endmermaid %}\n\nè·³è½¬æŸ¥çœ‹[è¿è¡Œçº§åˆ«](#runLevel)è§£é‡Š\n\n\n\n#### chkconfigæŒ‡ä»¤  \n\nç®¡ç†æœåŠ¡åœ¨å„ä¸ªè¿è¡Œçº§åˆ«çš„è‡ªå¯åŠ¨\n\nchkconfig æŒ‡ä»¤ç®¡ç†çš„æœåŠ¡åœ¨/etc/init.d/ æŸ¥çœ‹\n\nåŸºæœ¬ç”¨æ³•ï¼š\n\n- `chkconfig --list` æŸ¥çœ‹æœåŠ¡\n- `chkconfig <æœåŠ¡å> --list` æŸ¥çœ‹æŸä¸ªæœåŠ¡\n- `chkconfig --level <è¿è¡Œçº§åˆ«> <æœåŠ¡å> <on | off> ` è®¾ç½®\n\n**é‡å¯ç³»ç»Ÿç”Ÿæ•ˆ**\n\n#### systemctlç®¡ç†æŒ‡ä»¤\n\nsystemctlæŒ‡ä»¤ç®¡ç†çš„æœåŠ¡åœ¨**/usr/lib/systemd/system/**æŸ¥çœ‹(`ll /usr/lib/systemd/system/`)\n\nsystemctlç®€åŒ–äº†è¿è¡Œçº§åˆ«ï¼Œåªæœ‰3å’Œ5\n\n**åŸºæœ¬ç”¨æ³•ï¼š**\n\n- `systemctl <start | stop | restart | status> <æœåŠ¡å>` å¼€å¯/å…³é—­/é‡å¯/æŸ¥è¯¢ æœåŠ¡\n- `systemctl list-unit-files` æŸ¥çœ‹æœåŠ¡å¼€æœºå¯åŠ¨çŠ¶æ€(æ˜¯å¦å¼€æœºè‡ªå¯)\n- `systemctl <enable | disable> <æœåŠ¡å>` å¼€å¯/å…³é—­æœåŠ¡å¼€æœºè‡ªå¯åŠ¨\n- `systemctl is-enabled <æœåŠ¡å>`æŸ¥è¯¢æŸä¸ªæœåŠ¡æ˜¯å¦æ˜¯è‡ªå¯åŠ¨çš„\n\n#### <span id=\"firewall\">é˜²ç«å¢™ç«¯å£æŒ‡ä»¤</span>\n\n`firewall-cmd --permanent --add-port=ç«¯å£å·/åè®®` æ‰“å¼€ç«¯å£\n\n`firewall-cmd --permanent --remove-port=ç«¯å£å·/åè®®` å…³é—­ç«¯å£\n\n`firewall-cmd --reload` é‡æ–°è½½å…¥,æ‰èƒ½ç”Ÿæ•ˆ\n\n`firewall-cmd --query-port=ç«¯å£/åè®® ` æŸ¥è¯¢ç«¯å£æ˜¯å¦å¼€æ”¾\n\n### ç³»ç»Ÿç½‘ç»œæƒ…å†µnetstat\n\n`netstat [é€‰é¡¹]`\n\n- `-an` æŒ‰ä¸€å®šé¡ºåºè¾“å‡ºæ’åˆ—\n- `-p` æ˜¾ç¤ºå“ªä¸ªè¿›ç¨‹åœ¨è°ƒç”¨\n\n## rpmå’ŒyumåŒ…ç®¡ç†\n\n### RPM\n\n`rpm [é€‰é¡¹]` rpmåŒ…ç®¡ç†æŒ‡ä»¤\n\n- `-qa` æŸ¥è¯¢æ‰€æœ‰å·²å®‰è£…çš„rpmè½¯ä»¶åŒ…\n- `-q <name>` æŸ¥è¯¢æŒ‡å®šçš„è½¯ä»¶åŒ…æ˜¯å¦å®‰è£…\n- `-qi <name>` æŸ¥è¯¢æŒ‡å®šè½¯ä»¶åŒ…çš„ä¿¡æ¯\n- `-ql <name>` æŸ¥è¯¢æŒ‡å®šè½¯ä»¶åŒ…çš„æ–‡ä»¶\n- `-qf <æ–‡ä»¶å…¨è·¯å¾„å>` æŸ¥è¯¢æ–‡ä»¶æ‰€å±çš„è½¯ä»¶åŒ…\n- `-e <name>` åˆ é™¤æŒ‡å®šè½¯ä»¶åŒ…ï¼ˆ`--nodeps` å¼ºåˆ¶åˆ é™¤ï¼‰\n- `-ivh <file>` å®‰è£…è½¯ä»¶åŒ…ï¼ˆ-iå®‰è£…ï¼Œ-væç¤ºï¼Œ-hè¿›åº¦æ¡ï¼‰\n\n### YUM\n\nYumæ˜¯ä¸€ä¸ªShellå‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚åŸºäºRPMåŒ…ç®¡ç†,èƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½RPMåŒ…å¹¶ä¸”å®‰è£…ï¼Œ**å¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»**ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä»¶åŒ…ã€‚\n\n`yum [é€‰é¡¹]` yumåŒ…ç®¡ç†æŒ‡ä»¤\n\n- `list` æŸ¥çœ‹æœåŠ¡å™¨æ”¯æŒçš„åŒ…åˆ—è¡¨ï¼ˆå¯ä»¥ä½¿ç”¨grepè¿‡æ»¤ï¼‰\n- `install <name>` ä¸‹è½½å®‰è£…æŒ‡å®šè½¯ä»¶åŒ…\n- `check-update`  æ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨çš„è½¯ä»¶åŒ…æ›´æ–°\n- `update [name]` æ›´æ–°ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªè½¯ä»¶åŒ…\n\n[linux yum å‘½ä»¤ | èœé¸Ÿæ•™ç¨‹ (runoob.com)](https://www.runoob.com/linux/linux-yum.html)\n\n## æ­å»ºJavaEEç¯å¢ƒ\n\n### å®‰è£…JDK\n\n[Java Downloads | Oracle ä¸­å›½](https://www.oracle.com/cn/java/technologies/downloads/)\n\n1. yumå®‰è£…\n   - `yum list java*` æŸ¥çœ‹æœåŠ¡å™¨jdkç‰ˆæœ¬åˆ—è¡¨\n   - `yum install java-x.x.x-openjdk` å®‰è£…æŒ‡å®šç‰ˆæœ¬\n2. rpmå®‰è£…\n   - ä¸‹è½½æŒ‡å®šç‰ˆæœ¬JDKçš„rpmå®‰è£…åŒ…\n   - `rpm -ivh <file>` ç­‰å¾…å®‰è£…å®Œæˆå³å¯\n   - é»˜è®¤å®‰è£…åœ¨/usr/lib/jvm\n3. å‹ç¼©åŒ…å®‰è£…(ä»¥JDK17ä¸ºä¾‹)\n   - ä¸‹è½½å®‰è£…åŒ…åˆ°/opt ï¼ˆå…¶å®ƒç›®å½•ä¹Ÿè¡Œï¼‰ï¼Œå¹¶è¿›å…¥/opt\n   - è§£å‹ `tar -zxvf jdk-17_linux-x64_bin.tar.gz`\n   - åˆ›å»ºæ–‡ä»¶å¤¹`mkdir /usr/local/java`\n   - ç§»åŠ¨jdk `mv jdk-17.0.6/ /usr/local/java/ `\n   - é…ç½®ç¯å¢ƒå˜é‡ `vim /etc/profile`åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n     - `export JAVA_HOME=/usr/local/java/jdk-17.0.6`\n     - `export PATH=$JAVA_HOME/bin:$PATH`\n   - æ‰§è¡Œ`source /etc/profile` ä½¿é…ç½®ç”Ÿæ•ˆï¼Œæˆ–è€…é‡å¯ç³»ç»Ÿ\n\n### å®‰è£…Tomcat\n\n[Apache TomcatÂ® - Apache Tomcat 9 Software Downloads](https://tomcat.apache.org/download-90.cgi)\n\n1. yumå®‰è£…\n   - `yum install tomcat`\n   - `systemctl <start | stop> tomcat.service` å¯åŠ¨/å…³é—­\n2. å‹ç¼©åŒ…å®‰è£…ï¼ˆä»¥Tomcat9ä¸ºä¾‹ï¼‰\n   - ä¸‹è½½Tomcat9è‡³/optç›®å½•ï¼ˆå¯ä»¥æ˜¯å…¶å®ƒç›®å½•ï¼‰\n   - æ‰§è¡Œ`tar -zxvf apache-tomcat-9.0.71.tar.gz `è§£å‹\n   - è¿›å…¥/apache-tomcat-9.0.71/bin `cd apache-tomcat-9.0.71/bin/`\n   - æ‰§è¡Œ`./startup.sh`å¯åŠ¨Tomcat\n   - æ³¨æ„Linuxé˜²ç«å¢™æ˜¯å¦æ‹¦æˆª8080ç«¯å£ï¼ˆ[æŒ‡ä»¤è®¾ç½®](#firewall)ï¼‰\n   - å¦‚éœ€è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ–¹æ³•å¦‚ä¸Š\n   - æ‰§è¡Œ`./shutdown.sh`å…³é—­Tomcat\n\n### å®‰è£…MySql\n\n[MySQL :: Download MySQL Community Server](https://dev.mysql.com/downloads/mysql/)\n\n1. rpmå®‰è£…ï¼ˆä»¥8.0ä¸ºä¾‹ï¼‰\n   - ä¸‹è½½rpmå®‰è£…åŒ…åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ ï¼ˆbundleåç¼€çš„æ–‡ä»¶ï¼‰\n   - æŸ¥è¯¢æ˜¯å¦æœ‰mariadbï¼Œå¦‚æœ‰åˆ™å¸è½½\n     - `rpm -qa | grep mariadb` æŸ¥è¯¢\n     - `rpm -e --nodeps mariadb-libs`å¸è½½\n   - è§£å‹bundle `tar -xvf  mysql-8.0.32-1.el7.x86_64.rpm-bundle.tar`\n   - ä¾æ¬¡å®‰è£…ï¼š\n     - *`rpm -ivh mysql-community-common-8.0.32-1.el7.x86_64.rpm`\n     - `rpm -ivh mysql-community-client-plugins-8.0.32-1.el7.x86_64.rpm`\n     - *`rpm -ivh mysql-community-libs-8.0.32-1.el7.x86_64.rpm`\n     - *`rpm -ivh mysql-community-client-8.0.32-1.el7.x86_64.rpm`\n     - `rpm -ivh mysql-community-icu-data-files-8.0.32-1.el7.x86_64.rpm`\n     - *`rpm -ivh mysql-community-server-8.0.32-1.el7.x86_64.rpm`\n   - åˆå§‹rootå¯†ç æŸ¥çœ‹`grep password /var/log/mysqld.log`\n   - å¯åŠ¨MySqlæœåŠ¡ `systemctl start mysqld.service`\n   - è¿›å…¥MySqlå¹¶ä¿®æ”¹åˆå§‹å¯†ç \n     - `mysql -u root -p`\n     - `ALTER USER root@localhost IDENTIFIED BY 'å¯†ç ';`\n\n### å®‰è£…Redis\n\n> [Zookeeperå­¦ä¹ ç¬”è®° | Wshape1's Blogs](https://wshape1.github.io/2023/02/21/zookeeper-note/)\n\n## Shellå…¥é—¨\n\n","tags":["Linux","ç¬”è®°"],"categories":["Linux"]},{"title":"å¿«é€Ÿå¹‚ç®—æ³•(ä¾‹:a^b mod p)","url":"/2022/07/15/fast_power/","content":"\n# ä»‹ç»\n\n**å¿«é€Ÿå¹‚**ï¼ˆ**Exponentiation by squaring**ï¼Œå¹³æ–¹æ±‚å¹‚ï¼‰æ˜¯ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„å°ç®—æ³•ï¼Œå®ƒå¯ä»¥ä»¥O(log n)çš„æ—¶é—´å¤æ‚åº¦è®¡ç®—ä¹˜æ–¹ã€‚å¿«é€Ÿå¹‚ä¸ä»…æœ¬èº«éå¸¸å¸¸è§ï¼Œè€Œä¸”åç»­å¾ˆå¤šç®—æ³•ä¹Ÿéƒ½ä¼šç”¨åˆ°å¿«é€Ÿå¹‚ã€‚\n\n### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¿«é€Ÿå¹‚ï¼Ÿ\n\næ¯”å¦‚è¦è®¡ç®—ä»¥ä¸‹å¼å­ï¼š\n$$\n9^{10}=?\n$$\nä¼ ç»Ÿç®—æ³•æ˜¯\n$$\n9^{10} = 9*9*9*9*9*9*9*9*9*9\n$$\nè®¡ç®—æœºè¦é€šè¿‡**9æ¬¡**è®¡ç®—æ‰èƒ½å¾—å‡ºç­”æ¡ˆã€‚è€Œå¿«é€Ÿå¹‚çš„æ–¹æ³•å°±æ˜¯é€šè¿‡å¹³æ–¹æ¥å‡å°‘è®¡ç®—æ¬¡æ•°ï¼š\n$$\n9^{10}=(9*9)^{5}=(81*81)^{2}*81\n$$\nè¿™æ ·å­å°±åªéœ€è¦**4æ¬¡**ã€‚\n\nè¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æ˜¯**O(log n)**ï¼Œå½“æ¬¡æ–¹å¾ˆå¤§æ—¶å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚\n\n### ç®—æ³•å®ç°\n\n##### éé€’å½’ç‰ˆ\n\n```pseudocode\nfast_power(a, b)\n\tans = 1\n    while(b)\n        if b % 2 == 1\t//å½“å¹‚ä¸ºå¥‡æ•°æ—¶\n            ans *= a\n            b -= 1\n        else\n            a *= a\n            b /= 2\n    return ans\n```\n\nåœ¨b % 2 == 1è¿è¡Œå®Œæˆåï¼Œbå¿…å®šæ˜¯å¶æ•°ï¼Œæ¥ä¸‹æ¥ä¼šå†æ¬¡è¿›è¡Œwhileå¾ªç¯è¿›å…¥åˆ°elseé‡Œé¢ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥ç®€åŒ–æˆä¸€æ¬¡å¾ªç¯ï¼Œå¦‚ä¸‹ï¼š\n\n```pseudocode\nfast_power(a, b)\n\tans = 1\n    while(b)\n        if b % 2 == 1\n            ans *= a\n        a *= a\n        b /= 2\n    return ans\n```\n\n##### é€’å½’ç‰ˆï¼ˆæ…ç”¨ï¼‰\n\n```pseudocode\nfast_power(a, b)\n\tif b <= 0\n    \treturn 1\n    if b % 2 == 1\t//å½“å¹‚ä¸ºå¥‡æ•°æ—¶\n    \tans = fast_power(a, b - 1) * a\n    else \n    \tans = fast_power(a * a, b / 2)\n    return ans\n```\n\nä»¥ä¸Šéƒ½è¦**æ³¨æ„å˜é‡a, b, ansçš„èŒƒå›´**ã€‚\n\n### ä¾‹é¢˜a^b\n\n\n\né¢˜ç›®ï¼š[ç‰›å®¢ç½‘](https://ac.nowcoder.com/acm/contest/996/A \"a^b\")\n$$\næ±‚ a çš„ b æ¬¡æ–¹å¯¹ p å–æ¨¡çš„å€¼ï¼Œå…¶ä¸­ 0â‰¤a,b,pâ‰¤10^9ï¼Œp>0\n$$\n**è¾“å…¥æè¿°ï¼š**\n\n> ä¸‰ä¸ªç”¨ç©ºæ ¼éš”å¼€çš„æ•´æ•°a,bå’Œpã€‚\n\n**è¾“å‡ºæè¿°ï¼š**\n\n> ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºa^b mod pçš„å€¼ã€‚\n\n##### **æ€è·¯ï¼š**\n\n1. æœ€ç›´æ¥çš„æ€è·¯å°±æ˜¯ç®—å‡ºa^bçš„å€¼ä¹‹åå†æ¨¡pï¼Œä¸ç®¡æ˜¯å¦ä¸Šè¿°å¿«é€Ÿå¹‚çš„æ–¹æ³•ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªå¾ˆæ˜æ˜¾é—®é¢˜æ˜¯ a^b çš„èŒƒå›´å¤§è‡³10çš„9æ¬¡æ–¹çš„10çš„9æ¬¡æ–¹ï¼Œ**è¿œè¶…è¿‡äº†long longçš„èŒƒå›´**ã€‚\n\n2. åˆ©ç”¨**å¿«é€Ÿå¹‚+å–æ¨¡è¿ç®—çš„æ€§è´¨**ï¼Œå¯ä»¥å¿«é€Ÿçš„åŒæ—¶ä¸ä¼šè®©æ•°å€¼è¶…è¿‡èŒƒå›´ï¼Œæ€§è´¨**(a * b) % p = (a % p * b % p) % p** \n\n   äºæ˜¯å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä»£ç ï¼š\n\n   ```c++\n   typedef long long ll;\n   ll fast_power(ll a, ll b, ll p) {\n   \tll ans = 1;\n   \ta %= p;\n   \twhile(b) {\n   \t\tif(b % 2 == 1) \n   \t\t\tans = (ans * a) % p;\n   \t\ta = (a * a) % p;\n   \t\tb /= 2;\n   \t}\n   \treturn ans % p;\n   }\n   ```\n\n3. å…¶å®è¿˜å¯ä»¥ä½¿ç”¨**ä½è¿ç®—**ï¼Œæå‡è¿è¡Œçš„é€Ÿåº¦ï¼Œä»£ç å¦‚ä¸‹ï¼š\n\n   ```c++\n   typedef long long ll;\n   ll fast_power(ll a, ll b, ll p) {\n   \tll ans = 1;\n   \ta %= p;\n   \twhile(b) {\n   \t\tif(b & 1) \t\t// å¦‚7äºŒè¿›åˆ¶ä¸º0000 0111ï¼Œ1äºŒè¿›åˆ¶ä¸º0000 0001ï¼Œåˆ™7&1 = 0000 0001 = 1\n   \t\t\tans = (ans * a) % p;\n   \t\ta = (a * a) % p;\n   \t\tb >>= 1;\t\t// 7äºŒè¿›åˆ¶ä¸º0000 0111ï¼Œå‘å³ä½ç§»ä¸€ä½ä¸º 0000 0011 = 3 ï¼ˆä¸è¶³è¡¥0ï¼‰\n   \t}\n   \treturn ans % p;\n   }\n   ```\n\n   å¸¸è§çš„ä½è¿ç®—ç¬¦æœ‰ ä¸& æˆ–| å³ç§»>> å·¦ç§»<< å¼‚æˆ–^\n\n##### **æœ€ç»ˆä»£ç ï¼š**\n\n```c++\n#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;\n\nll fast_power(ll a, ll b, ll p) {\n    a %= p;\n    ll ans = 1;\n    while(b) {\n        if(b & 1)\n            ans = (ans * a) % p;\n        a = (a * a) % p;\n        b >>= 1;\n    }\n    return ans % p;\n}\n\nint main() {\n    \n    ll a, b, p;\n    \n    cin >> a >> b >> p;\n    \n    cout << fast_power(a, b, p);\n    \n    return 0;\n}\n```\n\n\n\n> å‚è€ƒèµ„æ–™ï¼š\n>\n> [1] [Pecco : ç®—æ³•å­¦ä¹ ç¬”è®°(4)ï¼šå¿«é€Ÿå¹‚](https://zhuanlan.zhihu.com/p/95902286)\n>\n> [2] [èŠ¸å­¦ä¹  : ã€C++/ç®—æ³•ã€‘å¿«é€Ÿå¹‚ç®—æ³•è¯¦è§£](https://www.bilibili.com/video/BV12r4y1w7tx?spm_id_from=333.337.search-card.all.click&vd_source=c155e4a52de51664d15aaf241c4a7656)\n","tags":["åŸºæœ¬ç®—æ³•","å¿«é€Ÿå¹‚","å–æ¨¡è¿ç®—","ä½è¿ç®—"],"categories":["åŸºæœ¬ç®—æ³•"]},{"title":"æœ€å°ç”Ÿæˆæ ‘(Minimum Spanning Tree)","url":"/2022/02/23/minimum_spanning_tree/","content":"\n## å‰è¨€\n\nä¾‹é¢˜ï¼š[AizuOJ ALDS_12A](https://onlinejudge.u-aizu.ac.jp/courses/lesson/1/ALDS1/12/ALDS1_12_A)  &  [AizuOJ GRL_2_A](https://onlinejudge.u-aizu.ac.jp/courses/library/5/GRL/2/GRL_2_A )\n\næœ¬é¢˜å¯ä»¥ä½¿ç”¨**æ™®é‡Œå§†(Prim)ç®—æ³•**æˆ–**å…‹é²æ–¯å¡å°”(Kruskal)ç®—æ³•**è¿›è¡Œå®ç°ã€‚\n\nä¸¤ç§ç®—æ³•çš„ç®€å•æ¯”è¾ƒï¼š\n\n|         |      æ—¶é—´å¤æ‚åº¦       | æœ€é€‚åˆ |\n| :-----: | :-------------------: | :----: |\n|  Prim   |        O(n^2)         | ç¨ å¯†å›¾ |\n| Kruskal | O(E * log E)ï¼ŒEä¸ºè¾¹æ•° | ç¨€ç–å›¾ |\n\nè§†é¢‘ï¼š[æœ€å°ç”Ÿæˆæ ‘(Kruskal(å…‹é²æ–¯å¡å°”)å’ŒPrim(æ™®é‡Œå§†))ç®—æ³•åŠ¨ç”»æ¼”ç¤º](https://www.bilibili.com/video/BV1Eb41177d1 \"WAY_zhong - BiliBili\")\n\nä»¥ä¸‹ä»£ç æ˜¯ [AizuOJ GRL_2_A](https://onlinejudge.u-aizu.ac.jp/courses/library/5/GRL/2/GRL_2_A ) çš„è§£æ³•ã€‚\n\n## æ™®é‡Œå§†ç®—æ³•\n\nä»£ç å¦‚ä¸‹ï¼š\n\n```c++\n#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <limits.h>\n\nusing namespace std;\n\n#define MAX 10000\n\ntypedef pair<int, int> PII;\n\nvector<PII> D[MAX]; \t//PII(id, w)\nint sum = 0, d[MAX];\n//int p[MAX];\nbool seen[MAX] = {false};\n\nint main() {\n\tint V, E, s, t, w;\n\n\tscanf(\"%d %d\", &V, &E);\n\n\tfor (int i = 0; i < V; i++) {\n\t\td[i] = INT_MAX;\n\t}\n\n\tfor (int i = 0; i < E; i++) {\n\t\tscanf(\"%d %d %d\", &s, &t, &w);\n\t\tD[s].push_back(PII(t, w));\n\t\tD[t].push_back(PII(s, w));\n\t}\n\n\tint ct = 0;\n\ts = 0;\n\tseen[0] = true;\n\n\twhile (ct < V - 1) {\n\t\tfor (int i = 0; i < D[s].size(); i++) {\n\t\t\tt = D[s][i].first;\n\t\t\tw = D[s][i].second;\n\t\t\tif (!seen[t] && d[t] > w) {\n\t\t\t\td[t] = w;\n//\t\t\t\tp[t] = u;\n\t\t\t}\n\t\t}\n\n\t\tint min = 0;\n\t\tfor (int i = 0; i < V; i++)\n\t\t\tif (!seen[i] && d[i] < d[min])\n\t\t\t\tmin = i;\n\n\t\tseen[min] = true;\n\t\ts = min;\n\t\tsum += d[min];\n\t\tct++;\n\t}\n\n\tprintf(\"%d\\n\", sum);\n\n\treturn 0;\n}\n```\n\nè¿è¡Œç»“æœï¼š\n\n| Lang | Status | Judge |  Time  | Memory | Code |\n| :--: | :----: | :---: | :----: | :----: | :--: |\n| C++  |   AC   | 20/20 | 00.22s | 6024KB | 861B |\n\n## å…‹é²æ–¯å¡å°”ç®—æ³•\n\nä»£ç å¦‚ä¸‹ï¼š\n\n```c++\n#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <limits.h>\n\nusing namespace std;\n\n#define MAX 10000\n\ntypedef struct {\n\tint v1, v2, w;\n} Info;\n\nvector<Info> D;\nint p[MAX], h[MAX], d[MAX];\n\nbool cmp(const Info a, const Info b) {\n\treturn a.w < b.w;\n}\n\nint find(int a) {\n\tif (p[a] != a) {\n\t\tp[a] = find(p[a]);\n\t}\n\treturn p[a];\n}\n\nvoid unite(int x, int y) {\n\tint rX = find(x);\n\tint rY = find(y);\n\n\tif (rX != rY) {\n\t\tif (h[rX] > h[rY])\n\t\t\tp[rY] = rX;\n\t\telse {\n\t\t\tp[rX] = rY;\n\t\t\tif (h[rX] == h[rY])\n\t\t\t\th[rY]++;\n\t\t}\n\t}\n}\n\n\nint main() {\n\tint V, E, sum = 0;\n\tint s, t, w;\n\n\tscanf(\"%d %d\", &V, &E);\n\n\tfor (int i = 0; i < V; i++) {\n\t\td[i] = INT_MAX;\n\t\tp[i] = i;\n\t\th[i] = 0;\n\t}\n\n\tfor (int i = 0; i < E; i++) {\n\t\tscanf(\"%d %d %d\", &s, &t, &w);\n\t\tInfo tmp = {s, t, w};\n\t\tD.push_back(tmp);\n\t}\n\n\tsort(D.begin(), D.end(), cmp);\n\n\tfor (int i = 0; i < E; i++) {\n\t\tif (find(D[i].v1) != find(D[i].v2)) {\n\t\t\tunite(D[i].v1, D[i].v2);\n\t\t\tsum += D[i].w;\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", sum);\n\n\treturn 0;\n}\n```\n\nè¿è¡Œç»“æœï¼š\n\n| Lang | Status | Judge |  Time  | Memory | Code  |\n| :--: | :----: | :---: | :----: | :----: | :---: |\n| C++  |   AC   | 20/20 | 00.02s | 4696KB | 1013B |\n\n  \n","tags":["å›¾è®º","æ™®é‡Œå§†ç®—æ³•","å…‹é²æ–¯å¡å°”ç®—æ³•","æœ€å°ç”Ÿæˆæ ‘"],"categories":["å›¾è®º"]},{"title":"Hello World","url":"/2022/01/08/hello-world/","content":"emmm...\n"}]